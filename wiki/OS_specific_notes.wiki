#User contributed OS specific notes.

= Introduction =

Any OS specific notes we get are put here.

We don't verify these - we just list them.


= Ubuntu/Debian =

A transcript of .bash_history on a clean debian net install (this is not entirely complete):
{{{
apt-get update

apt-get install dpkg-dev file gcc g++ libc6-dev make patch perl autoconf dh-make devscripts fakeroot gnupg g77 gpc xutils lintian linda pbuilder debian-policy developers-reference sudo wget

cd /home/dotmac
apt-get source apache2
apt-get build-dep apache2
ls -al
cd apache2-2.2.3/
wget http://dotmac.googlecode.com/svn/trunk/Patches/Apache/quota.patch.txt
patch -p1 < quota.patch.txt

nano debian/changelog

debuild -us -uc

cd ..
ls -al

dpkg -i apache2.2-common_2.2.3-4+moddavquota_i386.deb apache2-doc_2.2.3-4+moddavquota_all.deb apache2-prefork-dev_2.2.3-4+moddavquota_i386.deb apache2-utils_2.2.3-4+moddavquota_i386.deb 

apt-get install libapache2-mod-perl2
perl -MCPAN -e 'install HTTPD::UserAdmin'
perl -MCPAN -e 'install MD5'
perl -MCPAN -e 'install XML::DOM'
perl -MCPAN -e 'install HTTP::DAV'
perl -MCPAN -e 'install XML::LibXML'

a2enmod dav
a2enmod ssl
a2enmod auth_digest
a2enmod vhost_alias

nano /etc/apache2/conf.d/dotmac.conf
nano ports.conf
/etc/init.d/apache2 restart
}}}

= Gentoo =

install the perl prerequisites with:
{{{
emerge HTTPD-User-Manage MD5 XML-DOM HTTP-DAV
}}}

Also the .conf went to /etc/apache2/vhosts.d/

= FreeBSD =

{{{
cd /usr/ports/www/apache22
make fetch
make extract
cd work/httpd-2.2.6
patch -p1 < /path/to/Patches/Apache/quota.patch.txt
patch -p1 < /path/to/Patches/Apache/ampquotefix.patch
cd ../..
make
make deinstall
make reinstall
}}}
Edit /usr/local/etc/apache22/httpd.conf and /usr/local/etc/apache22/extra/.conf to fit your needs.

= Ubuntu Gutsy Gibbon Server Installation =

These instructions are Ubuntu Gutsy specific. They may, or may not, work on other versions.

Install Ubuntu Feisty server. Choose ONLY Open-SSH server on services selections during the installation. (I did NOT install LAMP (Linux Apache MySQL PHP).

sudo bash
Edit your apt sources.list, remove the CDROM entry(s) at the top, then update your installation.
{{{
vi /etc/apt/sources.list

apt-get update
apt-get upgrade
}}}
(Optional) I prefer vim. If you prefer nano, just replace "vi" with "nano" for the editing commands below.
{{{
sudo apt-get install vim
}}}
Configure the server with a static IP address:

Follow these instructions: http://www.howtogeek.com/howto/ubuntu/change-ubuntu-server-from-dhcp-to-a-static-ip-address/http://www.howtogeek.com/howto/ubuntu/change-ubuntu-server-from-dhcp-to-a-static-ip-address/

Install the required additional packages:
{{{
apt-get install dpkg-dev file gcc g++ libc6-dev make patch perl autoconf dh-make devscripts fakeroot gnupg g77 gpc xutils lintian linda pbuilder debian-policy developers-reference libxml-dev
}}}
Create a directory where you would like to build apache and the modules. I used ~/tmp.
{{{
mkdir tmp
cd tmp/
}}}
Get the apache2 source and build dependancies:
{{{
apt-get source apache2
apt-get build-dep apache2
}}}
NOTE: As of 1-8.2008, Apache 2-2.2.4 is the current version in Gutsty.

cd apache2-2.2.4/
Get the apache quota patch from the dotmac site and apply it:
{{{
wget http://dotmac.googlecode.com/svn/trunk/Patches/Apache/quota.patch.txt
patch -p1 < quota.patch.txt
}}}
Review the changelog.
{{{
vi debian/changelog 
}}}
Build the apache2 packages from the patched source (this could take awhile, depending on your system):
{{{
debuild -us -uc
}}}
Now install the compiled packages:
{{{
cd ..
ls -al
dpkg -i apache2.2-common_2.2.4-3build1_i386.deb apache2-doc_2.2.4-3build1_all.deb apache2-prefork-dev_2.2.4-3build1_i386.deb apache2-utils_2.2.4-3build1_i386.deb 
}}}
Install the apache perl modules:
{{{
apt-get install libapache2-mod-perl2
perl -MCPAN -e 'install HTTPD::UserAdmin'
perl -MCPAN -e 'install MD5'
perl -MCPAN -e 'install XML::DOM'
perl -MCPAN -e 'install HTTP::DAV'
perl -MCPAN -e 'install XML::LibXML'

a2enmod dav
a2enmod ssl
a2enmod auth_digest
a2enmod vhost_alias
}}}
Enable the dav_fs modules for apache:
{{{
ln -s /etc/apache2/mods-available/dav_fs.load /etc/apache2/mods-enabled/dav_fs.load
ln -s /etc/apache2/mods-available/dav_lock.load /etc/apache2/mods-enabled/dav_lock.load
ln -s /etc/apache2/mods-available/dav_fs.conf /etc/apache2/mods-enabled/dav_fs.conf
}}}
You should have four modules linked (one was already done):
{{{
ls -al /etc/apache2/mods-enabled/dav* 
}}}
Make the directory for the iDisk log default location (as of current svn 1.8.2008)
{{{
mkdir /etc/apache2/logs
}}}
Install an apache control package:
{{{
apt-get install apache2-mpm-itk
}}}
Restart apache2:

/etc/init.d/apache2 force-reload
or

/etc/init.d/apache2 restart
Install subversion (svn):
{{{
apt-get install subversion
}}}
Change dir to the work / build directory created above:
{{{
cd ~/tmp
}}}
Retrieve the latest code from svn:
{{{
svn checkout http://dotmac.googlecode.com/svn/trunk/ dotmac-read-only
}}}
Return to the installation Guide in the wiki for the rest. I will add more as I configure my server.
= Notes =
== Apache 2.0.x ==
With Apache 2.0.x, a change to dotmac.conf is necessary. Replace the following lines:
{{{
 AuthDigestProvider file
 AuthUserFile /var/www/dotmac/private/iDiskUsers
}}}
With
{{{
AuthDigestFile /var/www/dotmac/private/iDiskUsers
}}}

= Additions =

If you find anything incomplete/incorrect - use the comments here; we'll try and edit the page accordingly.