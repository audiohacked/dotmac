// ==================================================================================
// Copyright 2007, Apple, Inc.  All rights reserved.
//
// IMPORTANT NOTE:  This file is licensed only for use in providing the .Mac service,
// or any part thereof, and is subject to the .Mac Terms and Conditions.  You may not
// port this file to another platform without Apple's written consent.
// ==================================================================================
// @static
// ========================================================================
// .Mac Gallery
// Copyright 2007, Apple, Inc.  All rights reserved.
// ========================================================================
// @static
// @static
// ========================================================================
// .Mac Gallery
// Copyright 2007, Apple, Inc.  All rights reserved.
// ========================================================================
// Checkpoint functions are called by the Selenium automated test framework
// detect when various aspects of the application have finished executing.
// ========================================================================
// @static
// @static
// ========================================================================
// .Mac Gallery
// Copyright 2007, Apple, Inc.  All rights reserved.
// ========================================================================
// @static
// @static
// ========================================================================
// .Mac Gallery
// Copyright 2007-2008, Apple, Inc.  All rights reserved.
// ========================================================================
// @static
// @static

// ========================================================================

// .Mac Gallery

// Copyright 2007-2008, Apple, Inc.  All rights reserved.

// ========================================================================

// @static

// @static

// ========================================================================

// .Mac Gallery

// Copyright 2007-2008, Apple, Inc.  All rights reserved.

// ========================================================================

// @static

// @static
// ========================================================================
// .Mac Gallery
// Copyright 2007-2008, Apple, Inc.  All rights reserved.
// ========================================================================
// @static


Gallery={controllers:{},views:{},defaults:Mac.Object.create({title:''}),homepath:function(){if(Gallery.isLocalhost){return'/gallery';}
else{return'/'+Gallery.accountName;}}};if(!SC.isSafari()||SC.isSafari3()){SC.NotificationQueue.maxFlush=100;}
else{SC.NotificationQueue.maxFlush=1000000;}
function getRouteAsPath(){var path=[];path.push(location.pathname.split('/')[1]);var album=SC.Routes.get('location');if(typeof(album)=='undefined'){album=location.hash.substr(1);}
if(album=='gallery'||album==''){}
else{path.push(album.split('&')[0].split('/')[0]);}
return path.join('/');}
var DOMAIN=(window.location.host.match(/yourdomain.com$/)?'yourdomain.com':'mac.com');var HOST='gallery.'+DOMAIN;var PHOTOCAST_HOST='photocast.'+DOMAIN;var HAS_PHOTOCAST_PLUGIN=!!(navigator.plugins['iPhotoPhotocast']!==null&&navigator.plugins['iPhotoPhotocast']!==undefined);var VIEW_IPHOTO_ALBUM=2;var VIEW_APERTURE_ALBUM=6;var VIEW_IPHOTO_PHOTO=3;var VIEW_IPHOTO_VIDEO=4;var VIEW_IMOVIE_MOVIE=5;var VIEW_SLIDESHOW=7;var GROUP_ALBUMS=0;var GROUP_SLIDES=1;var GROUP_MOVIES=2;var SLIDESHOW_DELAY_MS=3000;var SLIDESHOW_VERTICAL_OFFSET_PX=185;var SLIDESHOW_HORIZONTAL_OFFSET_PX=40;var ZIP_REQUEST_HEADER='<?xml version="1.0" encoding="utf-8" ?>\r\n<ziplist xmlns="http://user.mac.com/properties/">';var ZIP_REQUEST_FOOTER='</ziplist>';var INITIAL_UPDATE_INTERVAL=300;var MINIMUM_UPDATE_INTERVAL=300;var MAXIMUM_UPDATE_INTERVAL=3600*24;Ajax.Responders.register({onCreate:function(){Gallery.blockUpdate=true;},onComplete:function(){Gallery.blockUpdate=false;}});Gallery.availableHeight=function(){if(Gallery.fullscreen)return Mac.View.windowHeight();var h=Mac.View.windowHeight()-59;if(Gallery.workspace.get("showToolBar"))h-=52;if(Gallery.workspace.get("showPagination"))h-=24;if(Gallery.workspace.get("nowShowing")!="index")h-=40;return h;};Gallery.headerHeight=function(){if(Gallery.fullscreen)return 0;var h=59;if(Gallery.workspace.get("showToolBar"))h+=52;if(Gallery.workspace.get("showPagination"))h+=24;return h;};var VIDEO_1680_MAX=700;var VIDEO_1920_MAX=1400;Gallery.speedTest=function()
{var end=new Date().getTime()+5;var loops=0;while(new Date().getTime()<end)
{loops++;}
return loops;};Gallery.bgColors={black:"#000000",dkgrey:"#262626",ltgrey:"#d9d9d9",white:"#FFFFFF"};Gallery.avoidCarouseljs=function(){return SC.isIE6();};Gallery.avoidGridfs=function(){return!Gallery.useGridFS||SC.isIE();};Gallery.getDateLabel=function(milliseconds)
{var value="_VisitorExperience.Visited.Today".loc();try
{var today=new Date();var file=new Date(milliseconds||today.getTime());if(file.getMonth()==today.getMonth()&&file.getDate()==today.getDate()&&file.getFullYear()==today.getFullYear())
value="_VisitorExperience.Visited.Today".loc();else
value="_VisitorExperience.Visited.Date".loc(file.getMonth()+1,file.getDate(),file.getFullYear());}
catch(e){};return value;};require('core');Gallery.Checkpoint={checkpoints:[],contentCount:0,reset:function(id)
{SC.Benchmark.start(id);this.checkpoints[id]=false;},mark:function(id)
{SC.Benchmark.end(id);this.checkpoints[id]=true;},startContentLoad:function(imageUrl)
{if(this.contentCount==0)
{this.reset('contentLoadTime');this.mark('contentLoading');}
this.contentCount++;},endContentLoad:function(imageUrl)
{this.contentCount--;if(this.contentCount==0)
{this.mark('contentLoadTime');this.mark('pageRendered');}},isInitialized:function()
{return this.checkpoints['initialized'];},isContentLoading:function()
{return this.checkpoints['contentLoading'];},isPageRendered:function()
{return this.checkpoints['pageRendered'];}};require('core');Gallery.Photo=Mac.Record.extend({isContributionType:Mac.Record.Flag,userHiddenType:Mac.Record.Flag,showCaptionsType:Mac.Record.Number,addCommentType:Mac.Record.Flag,downloadType:Mac.Record.Flag,userOrderIndexType:Mac.Record.Number,webImageWidthType:Mac.Record.Number,webImageHeightType:Mac.Record.Number,videoDurationType:Mac.Record.Number,videoWidthType:Mac.Record.Number,videoHeightType:Mac.Record.Number,videoHeightMobileType:Mac.Record.Number,videoWidthMobileType:Mac.Record.Number,videoHeightSmallType:Mac.Record.Number,videoWidthSmallType:Mac.Record.Number,videoHeightMediumType:Mac.Record.Number,videoWidthMediumType:Mac.Record.Number,videoHeightLargeType:Mac.Record.Number,videoWidthLargeType:Mac.Record.Number,viewIdentifierType:Mac.Record.Number,posterImageHeightType:Mac.Record.Number,posterImageWidthType:Mac.Record.Number,updatedType:Mac.Record.Date,mimeType:function(){if(this.get("mimetype")!==null&&this.get("mimetype")!==undefined&&this.get("mimetype")!="")
{return this.get("mimetype");}
else
{return"video/quicktime";}}.property(),isProtected:function(){if(this.get('isLocked')){this._isLocked=true;return true;}
else if(this._isLocked){return true;}
else if(this.get('accessLogin')!==undefined&&this.get('accessLogin')!==''){return true;}
else{return false;}}.property('isLocked','accessLogin'),isVideo:function(){return[VIEW_IPHOTO_VIDEO,VIEW_IMOVIE_MOVIE,VIEW_SLIDESHOW].include(this.get('viewIdentifier'));}.property(),isSlideshow:function(){return[VIEW_SLIDESHOW].include(this.get('viewIdentifier'));}.property(),groupType:function(){var type;var id=this.get('viewIdentifier');if(id==VIEW_SLIDESHOW)
type=GROUP_SLIDES;else
if(id==VIEW_IMOVIE_MOVIE)
type=GROUP_MOVIES;else
type=GROUP_ALBUMS;return type;}.property(),isVisited:function()
{if(!Gallery.enableBadging||this.get('isProtected')||!Gallery.badging.isInitialized)
return true;var albumDateString=null;if(this.get('isVideo')&&this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE)
{albumDateString=this.get('visitDate')||new Date(new Date().getTime()-Gallery.badgingGracePeriod).getTime();}
else
{var guid=this.get('album').get('guid');var visitInfo=Gallery.badging.albumVisitInfo[guid];if(visitInfo)
{albumDateString=visitInfo.previousVisitDate||visitInfo.visitDate;}}
if(this.get('visitDate'))
return true;var photoDateString=this.get('updated');if(albumDateString&&photoDateString)
{var albumMilliseconds=this.getTime(albumDateString);var photoMilliseconds=this.getTime(photoDateString);if(albumMilliseconds<=photoMilliseconds)
return false;}
return true;}.property('updated'),getTime:function(dateString){var milliseconds=0;if(dateString)
{try
{milliseconds=new Date(dateString).getTime();}
catch(e)
{var i=parseInt(dateString,0);if(!isNaN(i))
milliseconds=new Date(i).getTime();}}
return milliseconds;},showOnIndex:function(){return[VIEW_IPHOTO_ALBUM,VIEW_APERTURE_ALBUM,VIEW_IMOVIE_MOVIE,VIEW_SLIDESHOW].include(this.get('viewIdentifier'));}.property(),showTitle:function(){switch(this.get('viewIdentifier')){case VIEW_IPHOTO_VIDEO:case VIEW_IPHOTO_PHOTO:if(this.get("album"))return(this.get('album').get('showCaptions')==1||this.get('album').get('showCaptions')==2);else return false;case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:return(typeof(this.get('showCaptions')=='undefined')||this.get('showCaptions')==1||this.get('showCaptions')==2);}}.property(),scrubImageObserver:function()
{if(Gallery.fullscreen||!Gallery.enableImagePreload)return;if(!this.get('album'))return;var isProtected=!!(this.get('album')?this.get('album').get('isProtected'):this.get('isProtected'));var isUsedByView=(Gallery.workspace.get('nowShowing')=='index'||Gallery.workspace.get('nowShowing')=='mosaic');var hasScrubSprite=this.get('album').get('hasScrubSprite')&&Gallery.workspace.get('nowShowing')=='index';if(isUsedByView&&!isProtected&&!hasScrubSprite)
{setTimeout(function()
{var src=this.get('square');var done=function(){Gallery.Checkpoint.endContentLoad(arguments.callee.src);};done.src=src;Gallery.Checkpoint.startContentLoad(src);this._squareIndexLoadee=ImageLoadee.create({importance:Math.random()-200,url:src,onerror:done,onload:done,forPrecache:true}).enter(Gallery.indexLoadees);}.bind(this),Gallery.imagePreloadDelay);}}.observes('square'),showDescription:function(){switch(this.get('viewIdentifier')){case VIEW_IPHOTO_VIDEO:case VIEW_IPHOTO_PHOTO:if(this.get("album")&&this.get('content'))return(this.get('album').get('showCaptions')==1||this.get('album').get('showCaptions')==3);else return false;case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:return(typeof(this.get('showCaptions')=='undefined')||this.get('showCaptions')==1||this.get('showCaptions')==3);}}.property(),photoDescription:function(){switch(this.get('viewIdentifier')){case VIEW_IPHOTO_VIDEO:case VIEW_IPHOTO_PHOTO:return this.get('content')?this.get('content'):'';case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:return this.get('description')?this.get('description'):'';}}.property(),canComment:function(){switch(this.get('viewIdentifier')){case VIEW_IPHOTO_VIDEO:case VIEW_IPHOTO_PHOTO:if(this.get("album"))return this.get('album').get('addComment');else return false;case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:return this.get('addComment');}}.property(),canDownload:function(){switch(this.get('viewIdentifier')){case VIEW_IPHOTO_VIDEO:case VIEW_IPHOTO_PHOTO:if(this.get("album"))return this.get('album').get('download');else return false;case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:return this.get('download');}}.property(),filename:function(){var path=this.get('url').split('/');if(path.length>0){return path[path.length-1]+'.'+this.get('fileExtension');}
else{return null;}}.property(),href:function(){return this.get('url')+'.'+this.get('fileExtension');}.property(),web:function(){if(this.get('webImagePath')!==undefined)
return this.get('url')+'/'+this.get('webImagePath');else
return null;}.property(),poster:function(){if(this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE||this.get('viewIdentifier')==VIEW_SLIDESHOW){return this.get('url')+'/'+this.get('posterPath');}
else{return this.get('url')+'/'+this.get('webImagePath');}}.property(),large:function(){var path=this.get('largeImagePath');if(path!==undefined)
return this.get('url')+'/'+path;else
return this.web();}.property(),original:function(){var path=this.get('originalImagePath');if(path!==undefined)
return this.get('url')+'/'+path;else
return null;}.property(),video:function(){if(this.get('viewIdentifier')==VIEW_IPHOTO_VIDEO){return this.get('url')+'/'+this.get('videoPath');}
else{return undefined;}}.property(),videoMobile:function(){if(this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE||this.get('viewIdentifier')==VIEW_SLIDESHOW){var videoPathMobile=this.get('videoPathMobile');if(videoPathMobile!==undefined){return this.get('url')+'/'+encodeURIComponent(decodeURIComponent(videoPathMobile));}
else{return undefined;}}
else{return undefined;}}.property(),videoSmall:function(){if(this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE||this.get('viewIdentifier')==VIEW_SLIDESHOW){var videoPathSmall=this.get('videoPathSmall');if(videoPathSmall!==undefined){return this.get('url')+'/'+encodeURIComponent(decodeURIComponent(videoPathSmall));}
else{return undefined;}}
else{return undefined;}}.property(),videoMedium:function(){if(this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE||this.get('viewIdentifier')==VIEW_SLIDESHOW){var videoPathMedium=this.get('videoPathMedium');if(videoPathMedium!==undefined){return this.get('url')+'/'+encodeURIComponent(decodeURIComponent(videoPathMedium));}
else{return undefined;}}
else{return undefined;}}.property(),videoLarge:function(){if(this.get('viewIdentifier')==VIEW_IMOVIE_MOVIE||this.get('viewIdentifier')==VIEW_SLIDESHOW){var videoPathLarge=this.get('videoPathLarge');if(videoPathLarge!==undefined){return this.get('url')+'/'+encodeURIComponent(decodeURIComponent(videoPathLarge));}
else{return undefined;}}
else{return undefined;}}.property(),thumbImageWidth:function(){var w=this.get('webImageWidth');var h=this.get('webImageHeight');if(w>h){return 320;}
else{return Math.floor((w/h)*320);}}.property(),thumbImageHeight:function(){var w=this.get('webImageWidth');var h=this.get('webImageHeight');if(w>h){return Math.floor((h/w)*320);}
else{return 320;}}.property(),fileExtension:function(){var matches,path=this.get('webImagePath');if(path){matches=path.match(/\.(\w+)$/);if(matches&&matches.length>0){return matches[1];}
else{return'jpg';}}
else return'jpg';}.property(),videoId:function(){var url=this.get('url');if(url){var path=this.get('url').split('/');if(path.length>0){return(0-parseInt(path[path.length-1],10));}
else{return'';}}
else{return'';}}.property(),photoContributor:function(){if(this.get('isContribution')){var contributor;var contributorName;var date=new Date(this.get('archiveDate'));var contributorUrl=this.get('contributorUrl');if(this.get('contributor')=="Anonymous")
{contributorName="_VisitorExperience.DetailPage.Anonymous".loc();}
else
{contributorName=decodeURIComponent(this.get('contributor'));}
if(contributorUrl){contributor='<a href="'+contributorUrl.toHref()+'" target="_blank">'+contributorName+'</a>';}
else{contributor=contributorName;}
if(String.currentLanguage()=="English")
{return"_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText".loc(contributor,(date.getMonth()+1)+'/'+date.getDate()+'/'+date.getFullYear());}
else if(String.currentLanguage()!="Japanese")
{return"_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText".loc(contributor,date.toLocaleDateString());}
else
{return"_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText".loc(date.toLocaleDateString(),contributor);}}}.property(),imageVersion:function(){var result='ver=';var dateString=this.get('updated');if(dateString)
result+=this.getTime(dateString);var vi=this.get('versionInfo');if(vi)
result+=vi.content;return result;}.property(),spriteUrl:function(){return this.get('url')+'/'+this.get('scrubSpritePath')+'?'+this.get('imageVersion');}.property(),small:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=small&source=web.'+extension+'&type=small'+'&'+this.get('imageVersion');}.property(),medium:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=medium&source=web.'+extension+'&type=medium'+'&'+this.get('imageVersion');}.property(),square:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=square&source=web.'+extension+'&type=square'+'&'+this.get('imageVersion');}.property(),reflection:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=reflect&source=web.'+extension+'&type=reflect'+'&'+this.get('imageVersion');}.property(),smallReflection:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=reflect-small&source=web.'+extension+'&type=reflect-small'+'&'+this.get('imageVersion');}.property(),mediumReflection:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=reflect-medium&source=web.'+extension+'&type=reflect-medium'+'&'+this.get('imageVersion');}.property(),squareReflection:function(){var extension=this.get('fileExtension');return this.get('url')+'.'+extension+'?derivative=reflect-square&source=web.'+extension+'&type=reflect-square'+'&'+this.get('imageVersion');}.property(),downloadPath:function(){var extension;switch(this.get('viewIdentifier')){case VIEW_IPHOTO_PHOTO:var href=this.get('originalImagePath');if(href){var extension=href.substr(href.lastIndexOf('.')+1);var size='original';}
else{var extension=this.get('fileExtension');var size='large';}
return this.get('url')+'.'+extension+'?derivative='+size+'&type='+size+'&disposition=download&alternate=web&source='+size+'.'+extension;case VIEW_IPHOTO_VIDEO:var ret=null;try{ret=this.get('url')+'.'+this.get('videoPath').split('.')[1]+'?derivative=video&disposition=download';}
catch(e){ret=this.get('web');}
return ret;}}.property(),hasScrubSprite:function(){return(Gallery.enableScrubSprites&&this.get('scrubSpritePath')!==undefined&&!(SC.isFireFox()&&SC.isWindows()));}.property(),exifModDate:function(){return(this.get('modDate')?this.get('modDate'):"--");}.property(),exifArchiveDate:function(){return(this.get('archiveDate')?this.get('archiveDate'):"--");}.property(),hasExifData:false,isAlbum:false,route:function(){var path=this.get('url')||this.get('path');if(!path)return'';return path.replace(/http:\/\/.+?\.com\/.+?\//,'');}.property(),init:function(){arguments.callee.base.call(this);this.registerDependentKey('isVideo','viewIdentifier');this.registerDependentKey('showOnIndex','viewIdentifier');this.registerDependentKey('showTitle','viewIdentifier','album','showCaptions');this.registerDependentKey('showDescription','viewIdentifier','album','content','showCaptions');this.registerDependentKey('photoDescription','viewIdentifier','content','description');this.registerDependentKey('canComment','viewIdentifier','album','addComment');this.registerDependentKey('canDownload','viewIdentifier','album','download');this.registerDependentKey('thumbImageWidth','webImageWidth','webImageHeight');this.registerDependentKey('filename','url');this.registerDependentKey('href','url');this.registerDependentKey('web','webImagePath','url');this.registerDependentKey('poster','viewIdentifier','posterPath','webImagePath','url');this.registerDependentKey('large','largeImagePath','url');this.registerDependentKey('video','url','videoPath');this.registerDependentKey('videoMobile','viewIdentifier','url','videoPathMobile');this.registerDependentKey('videoSmall','viewIdentifier','url','videoPathSmall');this.registerDependentKey('videoMedium','viewIdentifier','url','videoPathMedium');this.registerDependentKey('videoLarge','viewIdentifier','url','videoPathLarge');this.registerDependentKey('fileExtension','webImagePath');this.registerDependentKey('small','web');this.registerDependentKey('medium','web');this.registerDependentKey('square','web');this.registerDependentKey('reflection','url');this.registerDependentKey('smallReflection','url');this.registerDependentKey('mediumReflection','url');this.registerDependentKey('squareReflection','url');this.registerDependentKey('downloadPath','url','viewIdentifier','videoPath','fileExtension');this.registerDependentKey('route','url','path');this.registerDependentKey('videoId','url');this.registerDependentKey('photoContributor','isContribution','contributor','archiveDate','contributorUrl');this.registerDependentKey('exifModDate','modDate');this.registerDependentKey('exifArchiveDate','archiveDate');}});Gallery.PhotoCollection=Mac.Collection.extend({scale:125,orderBy:['userOrderIndex'],recordType:Gallery.Photo,conditions:{isAlbum:false}});require('model/photo');Gallery.Album=Gallery.Photo.extend({properties:['isLocked','accessLogin','path','userOrderIndex','mobileEmail','showMobile','albumWidget','addPhoto','download','addComment','showCaptions','allowMobile','keyImagePath','numMovies','numPhotos'],isAlbum:true,isLockedType:Mac.Record.Flag,addPhotoType:Mac.Record.Flag,addCommentType:Mac.Record.Flag,showMobileType:Mac.Record.Flag,albumWidgetType:Mac.Record.Flag,allowMobileType:Mac.Record.Flag,downloadType:Mac.Record.Flag,showCaptionsType:Mac.Record.Number,userOrderIndexType:Mac.Record.Number,numPhotosType:Mac.Record.Number,numMoviesType:Mac.Record.Number,updatedType:Mac.Record.Date,visitDateType:Mac.Record.Number,fullyLoaded:false,square:function(tries){tries=(tries)?tries:10;var keyImage=Gallery.Photo.findAll({url:this.get('keyImagePath')});if(keyImage.length>0){return keyImage[0].get('square');}
if(!SC.Store.get('updateRecordsInProgress')){var photos=this.get('photos');if(photos.get("records").length>0){return photos.get("records")[0].get('square');}}
else if(tries>0){var that=this;setTimeout(function(){that.square(tries-1);},100);}
return'/g/images/gallery/protected_bg.jpg';}.property('keyImagePath','numPhotos','numMovies'),keyimage:function(){var photos=Gallery.Photo.findAll({url:this.get('keyImagePath')});if(photos.length>0){return photos[0];}else{photos=this.get('photos');return photos.get("records")[0];}}.property('keyImagePath'),isPrivate:function(){if(this.get('accessLogin')==Gallery.accountName){return true;}
else{return false;}}.property(),isVisited:function()
{if(!Gallery.enableBadging||this.get('isProtected')||!Gallery.badging.isInitialized)
return true;var albumMilliseconds=new Date(this.get('updated')).getTime();var visitDateString=this.get('visitDate');if(visitDateString)
{var visitMilliseconds=new Date(parseInt(visitDateString,0)).getTime();if(albumMilliseconds>=visitMilliseconds)
{var info=Gallery.badging.albumVisitInfo[this.get('guid')];if(info)
{var oldVersion=info.contentVersion;var oldNumAssets=info.numAssets;if(!oldVersion||!oldNumAssets)
return false;var numPhotos=parseInt(this.get('numPhotos'));if(isNaN(numPhotos))numPhotos=0;var numMovies=parseInt(this.get('numMovies'));if(isNaN(numMovies))numMovies=0;var numAssets=numPhotos+numMovies;if(oldVersion!=this.get('versionInfo').content&&oldNumAssets<numAssets)
return false;}
else
{return false;}}}
else
{var visitMilliseconds=Gallery.siteVisitDate||new Date().getTime();visitMilliseconds-=Gallery.badgingGracePeriod;if(albumMilliseconds>=visitMilliseconds)
return false;}
return true;}.property('visitDate'),photos:function(){if(!this._photos){this._photos=Gallery.PhotoCollection.create({conditions:{album:this,isAlbum:false},recordType:Gallery.Photo,orderBy:['userOrderIndex','updated DESC','guid']});this._photos.refresh();}
return this._photos;}.property(),allPhotos:function(){if(!this._allPhotos){this._allPhotos=Gallery.PhotoCollection.create({conditions:{album:this,isAlbum:false},recordType:Gallery.Photo,orderBy:['userOrderIndex','updated DESC','guid']});this._allPhotos.refresh();}
return this._allPhotos;}.property()});Gallery.Photo.prototype.albumType=Gallery.Album;Gallery.ImageView=Mac.View.extend({content:null,contentBindingDefault:Mac.Binding.SingleNotEmpty,imageWidth:'600',imageHeight:'400',guid:null,pubDate:null,link:null,description:null,webImageHeight:null,webImageWidth:null,thumbImageHeight:null,thumbImageWidth:null,observesEvents:false,render:function(){var content=this.get('content');var emptyValues=[null,Mac.Binding.MULTIPLE_PLACEHOLDER,Mac.Binding.EMPTY_PLACEHOLDER];if(emptyValues.include(content)){this.innerHTML='';}else{var styles=[];if(this.content.get("imageWidth"))styles.push('width:'+this.content.get("imageWidth"));if(this.content.get("imageHeight"))styles.push('height:'+this.content.get("imageHeight"));var html='<img src="'+this.content.get("web")+'" style="'+styles.join('; ')+'" >';this.innerHTML=html;}},propertyObserver:function(observing,target,key,newValue){if(target==this){switch(key){case"content":if(newValue!=this._content)this.render();this._content=newValue;break;case"isSelected":case"isActive":if(newValue){this.addClassName('selected');}else{this.removeClassName('selected');}
break;}}},init:function(){arguments.callee.base.call(this);this._content=this.content;if(this.content)this.render();}});Gallery.VideoView=Mac.View.extend({content:null,contentBindingDefault:Mac.Binding.SingleNotEmpty,imageWidth:'600',imageHeight:'400',guid:null,pubDate:null,link:null,description:null,webImageHeight:null,webImageWidth:null,thumbImageHeight:null,thumbImageWidth:null,timeOut:null,videoHeight:0,videoWidth:0,QTErr:false,_movie:null,_controller:null,volume:255,requiredQTVersion:"7.2",showStandardController:function(){return(!(SC.isSafari()||SC.isIE()));},ie6FixerObserver:function(){if(SC.isIE6()&&Gallery.workspace.get('nowShowing')=='imovie'){window.resizeBy(-1,-1);setTimeout("window.resizeBy(1,1);",1);}}.observes('Gallery.workspace.nowShowing'),runMovie:function(kioskMode)
{this.hasQTError=false;if(SC.isIE6())
{setTimeout(this.appendNewMovie.bind(this,kioskMode),1);}
else
{this.appendNewMovie(kioskMode);}},makePanelSafe:function()
{if(this.owner.get("atiMovieMovieView"))
{if(this._controller){try{this._controller.Stop();}catch(e){};}
this.style.visibility="hidden";}},doneMakePanelSafe:function()
{this.style.visibility="";if(this._controller){try{this._controller.Play();}catch(e){};}},destroyMovie:function()
{if(!this._controller&&!this._movie)return;if(this._controller)
{try{this._controller.Stop();}catch(e)
{}
this._controller.detachFromMovie();if(!this.showStandardController())
{if($('detailMovieControls'))
Element.remove('detailMovieControls');}}
var isIE=AC.Detector.isIEStrict();if(isIE&&this._movie){this._movie.style.display='none';}
this.removeChild($('GalleryMovie'));if(this.showStandardController())
{$('controller').innerHTML='';}
this._movie=null;this._controller=null;},appendNewMovie:function(useKioskMode)
{this.destroyMovie();var movie=AC.Quicktime.packageMovie('GalleryMovie',this._videoSource,{width:this._videoWidth,height:this._videoHeight,autoplay:false,controller:this.showStandardController(),cache:true,kioskmode:useKioskMode,showlogo:false,scale:"aspect"});this.insertBefore(movie,$('fullscreenMovieButton'));this._movie=movie;if(!(SC.isFireFox()&&SC.isWindows()))
{Element.addClassName($('GalleryMovie'),'loadingMovie');Element.addClassName($('GalleryMovieInner'),'loadingMovie');}
var movieController=new AC.QuicktimeController(movie,{onMoviePlayable:function(){if(!(SC.isFireFox()&&SC.isWindows()))
{if($('placeholderDiv'))
{Element.remove('placeholderDiv');$('iMovieLinks').style.marginTop="10px";}
Element.removeClassName($('GalleryMovie'),'loadingMovie');Element.removeClassName($('GalleryMovieInner'),'loadingMovie');}
if(Gallery.workspace.detailView.movieView.showStandardController())
{if(Gallery.workspace.detailView.atiMovieMovieView())
{var fullscreenButton=document.createElement('button');fullscreenButton.id="fullscreenMovieButton";fullscreenButton.onclick=Gallery.workspace.detailView.movieView.toggleFullscreen;if(Gallery.fullscreen)
{Element.addClassName(fullscreenButton,"closeFullscreen");fullscreenButton.title="_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip".loc();}
else
{Element.addClassName(fullscreenButton,"openFullscreen");fullscreenButton.style.top="19px";fullscreenButton.title="_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip".loc();}
$('controller').style.width=Gallery.workspace.detailView.movieView._videoWidth+"px";$('controller').style.marginLeft="auto";$('controller').style.marginRight="auto";if(Gallery.workspace.detailView.movieView.iMovieLinks.mobileMovieButton.get('isSelected'))
{fullscreenButton.style.left="55px";fullscreenButton.style.top="19px";}
$('controller').appendChild(fullscreenButton);}
movieController.SetAutoPlay(true);}
else
{movieController.render('controller');movieController.setControllerWidth(Gallery.workspace.detailView.movieView._videoWidth);movieController.SetVolume(Gallery.workspace.detailView.movieView.volume);movieController.Rewind();movieController.Play();movieController.SetAutoPlay(true);}},onMovieError:function(){Gallery.workspace.detailView.movieView.createQTErrorOverlay();}});this._controller=movieController;},setControllerWidth:function()
{if(this._controller)
{this._controller.setControllerWidth(this._videoWidth);}},setMovieDimesions:function()
{if(this._movie)
{this.style.width=this._videoWidth+"px";this.style.height=this._videoHeight+"px";if($('GalleryMovie'))
{$('GalleryMovie').width=this._videoWidth;$('GalleryMovie').height=this._videoHeight;}
if($('GalleryMovieInner'))
{$('GalleryMovieInner').width=this._videoWidth;$('GalleryMovieInner').height=this._videoHeight;}}},render:function(){},toggleFullscreen:function()
{if(Gallery.fullscreen)
{try
{window.opener.Gallery.workspace.detailView.movieView._controller.SetTime(Gallery.workspace.detailView.movieView._controller.GetTime());if(Gallery.workspace.detailView.movieView._controller.isPlaying())
{Gallery.workspace.detailView.movieView._controller.Stop();window.opener.Gallery.workspace.detailView.movieView._controller.Play();}}catch(e){}
window.close();}
else
{Gallery.workspace.detailView.movieView._controller.Stop();Gallery.goFullscreen({},"movie");}},loadGenericPoster:function()
{if(this.posterLoadError)
{this.calculateDimensions(480,640);var posterImg=document.createElement("img");posterImg.src='/g/images/gallery/video_view/placeholder_movie.jpg';posterImg.width=this._videoWidth;posterImg.height=this._videoHeight;posterImg.id="posterImg";$('posterContainer').appendChild(posterImg);}
this.posterLoadError=false;},posterLoadError:false,posterImgError:function()
{this.posterLoadError=true;if($('posterImg'))Element.remove('posterImg');},createPosterImage:function(posterSrc)
{if(SC.isFireFox()&&SC.isWindows()&&AC.Detector.isValidQTAvailable(this.requiredQTVersion))
{return;}
var hasQT=AC.Detector.isValidQTAvailable(this.requiredQTVersion);if($('placeholderDiv'))Element.remove("placeholderDiv");var height=(this.showStandardController())?this._videoHeight-16:this._videoHeight;var placeHolderDiv=document.createElement("div");placeHolderDiv.id="placeholderDiv";placeHolderDiv.height=height;placeHolderDiv.width=this._videoWidth;if(!this.showStandardController())
{$('iMovieLinks').style.marginTop="40px";}
var div=document.createElement("div");div.id="posterContainer";if(hasQT)
{var spinnerDiv=document.createElement("div");spinnerDiv.id="overlay_spinner";var spinnerImg=document.createElement("img");spinnerImg.src="/g/images/gallery/video_view/overlay_spinner_sm.gif";spinnerImg.width="18";spinnerImg.height="18";spinnerDiv.appendChild(spinnerImg);}
if(Gallery.workspace.detailView.atiMovieMovieView()&&hasQT)
{posterSrc='/g/images/gallery/spacer.gif';placeHolderDiv.style.border="1px solid #111111";}
var posterImg=document.createElement("img");posterImg.src=posterSrc;posterImg.onError=function(){this.posterImgError();}.bind(this);posterImg.width=this._videoWidth;posterImg.height=height;posterImg.id="posterImg";div.appendChild(posterImg);placeHolderDiv.appendChild(div);if(hasQT)
{placeHolderDiv.appendChild(spinnerDiv);}
this.appendChild(placeHolderDiv);if(!hasQT)
{this.createQTErrorOverlay();}},hasQTError:false,createQTErrorOverlay:function()
{this.hasQTError=true;this.loadGenericPoster();var height=this._videoHeight;var width=this._videoWidth;if(width<640)
{height=640/width*height;width=640;this._videoHeight=height;this._videoWidth=width;this.style.height=height+"px";this.style.width=width+"px";$('posterImg').height=height;$('posterImg').width=width;$('placeholderDiv').style.height=height+"px";$('placeholderDiv').style.width=width+"px";$('posterContainer').style.height=height+"px";}
if(Gallery.workspace.detailView.atiMovieMovieView())
{$('posterImg').src=this._content.get("poster");}
if($('iMovieLinks'))$('iMovieLinks').style.display="none";if($('videoTitleLabel'))Element.addClassName($('videoTitleLabel'),'clearBoth');var noQTDiv=document.createElement("div");noQTDiv.id="noQT";noQTDiv.style.width=width+"px";var QTLogo=document.createElement("div");QTLogo.id="QTLogo";var QTErrorTextLeft=document.createElement("div");QTErrorTextLeft.id="QTErrorTextLeft";var QTErrorTextRight=document.createElement("div");QTErrorTextRight.id="QTErrorTextRight";if(!AC.Detector.isValidQTAvailable(this.requiredQTVersion))
{QTErrorTextLeft.innerHTML="_VisitorExperience.QTError.QuickTimeRequired".loc();QTErrorTextRight.innerHTML='<a href="'+"_VisitorExperience.QTError.Href".loc()+'">'+"_VisitorExperience.QTError.GetQuickTime".loc()+"</a>";}
else
{QTErrorTextLeft.innerHTML="_VisitorExperience.QTError.UnableToPlay".loc();QTErrorTextRight.innerHTML='';}
if($("overlay_spinner"))$("overlay_spinner").style.display='none';noQTDiv.appendChild(QTLogo);noQTDiv.appendChild(QTErrorTextLeft);noQTDiv.appendChild(QTErrorTextRight);$("placeholderDiv").appendChild(noQTDiv);},propertyObserver:function(observing,target,key,newValue){if(target==this){switch(key){case"content":if(newValue!=this._content)this.render();this._content=newValue;break;case"isSelected":case"isActive":if(newValue){this.addClassName('selected');}else{this.removeClassName('selected');}
break;}}},init:function(){arguments.callee.base.call(this);this._content=this.content;if(this.content)this.render();this.registerDependentKey('_canDownload','content');}});require('views/image_view');require('views/video_view');Gallery.DetailView=Mac.View.extend({outlets:['imageView','movieView','infoView','hoverView','contentDiv','backToAlbumLink'],contentDiv:'.content?',listphoto:null,prevphoto:null,nextphoto:null,isNextPrev:false,_w:0,_h:0,nowShowing:null,isHoverViewOn:false,viewstate:null,scaling:false,isVideo:false,rendering:false,backToAlbumLink:Mac.View.extend({outlets:['backToAlbumButton'],backToAlbumButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPageVideo.BackToAlbum.Button",outlets:["backToAlbumButtonLabel"],backToAlbumButtonLabel:Mac.LabelView.extend({localize:true}).outletFor("#backToAlbumButtonLabel"),action:function(ev){var path=Gallery.albumController.get('route')||'';SC.Routes.set('location',{route:path,view:Gallery.workspace.get('nowShowing'),bgcolor:Gallery.workspace.colorPicker.get('selectedColor'),sel:Gallery.currentPhotoSel()});}}).outletFor('#backToAlbumButton'),isVisibleBinding:'*owner.atHoverView'}).outletFor('#backToAlbumLink'),imageView:Gallery.ImageView.extend({isNextPrev:false,cHeight:0,cWidth:0,oTop:0,oLeft:0,outlets:["img_detail","imageTitleLabel"],img_detail:"#img_detail",imageTitleLabel:Mac.LabelView.extend({isVisibleBinding:'*owner.owner.atImageView'}).outletFor('#imageTitleLabel'),didClick:function(){if(!this.owner.get("scaling")){if(!SC.isIE())this.img_detail.src="/g/images/gallery/spacer.gif";else setTimeout(function(){this.img_detail.src="";},1);var path=Gallery.albumController.get('route')||'';SC.Routes.set('location',{route:path,view:Gallery.workspace.get('nowShowing'),bgcolor:Gallery.workspace.colorPicker.get('selectedColor'),sel:Gallery.currentPhotoSel()});Gallery.workspace._lastExitedDetailViewViaClickOnPhotoDate=Math.floor(new Date());}},render:function()
{if(!this.get("content"))return;var content=this.get("content");if(SC.isIE())
{$('detailImageView').style.border='none';}
else
{this.removeClassName('missing');}
this.imageTitleLabel.set("content",content.get('showTitle')?content.get("title"):'');if(!this.get("isNextPrev")&&!Gallery.workspace.detailView.get("rendering"))
{if($('scaleImg')!=null)Element.remove($('scaleImg'));var scaleImg=document.createElement("img");scaleImg.style.position="absolute";scaleImg.style.height=this.get("cHeight")+"px";scaleImg.style.width=this.get("cWidth")+"px";scaleImg.style.top=this.get("oTop")+60+"px";scaleImg.style.left=this.get("oLeft")+"px";var url=this.content.get("web");if(Gallery.workspace.get("nowShowing")=="grid"||Gallery.workspace.get("nowShowing")=="gridfs")
url=this.content.get(Gallery.gridImageSize);scaleImg.onload=scaleImg.onerror=function()
{Gallery.Checkpoint.endContentLoad(this.src);};Gallery.Checkpoint.startContentLoad(url);scaleImg.src=url;scaleImg.id="scaleImg";this.appendChild(scaleImg);}
this.owner.contentDiv.style.height=Mac.View.windowHeight()+"px";Gallery.workspace.detailView._w=parseInt(content.get("webImageWidth"),0);Gallery.workspace.detailView._h=parseInt(content.get("webImageHeight"),0);Gallery.workspace.detailView.scalePhotos();if((!this.get("isNextPrev"))&&(!SC.isIE()))
{this.img_detail.style.visibility="hidden";new Effect.MoveAndResizeTo('scaleImg',Gallery.workspace.detailView.imageView.offsetTop,Gallery.workspace.detailView.imageView.offsetLeft,Gallery.workspace.detailView.imageView.clientWidth,Gallery.workspace.detailView.imageView.clientHeight,{duration:0.2,fps:100,afterFinish:this.removescaleImg.bind(this)});}
else if((!this.get("isNextPrev"))&&(SC.isIE()))
{if($('scaleImg')){$('scaleImg').style.visibility="hidden";}
this.img_detail.src='/g/images/gallery/spacer.gif';this.img_detail.style.visibility="hidden";this.img_detail.onload=function()
{Gallery.Checkpoint.endContentLoad(this.src);if(Gallery.workspace.detailView.atMovieView())return;Gallery.workspace.detailView.set('rendering',false);$('detailImageView').style.border='none';$('detailImageView').img_detail.width+=1;$('detailImageView').img_detail.width-=1;this.style.visibility="visible";};this.img_detail.onerror=function()
{Gallery.Checkpoint.endContentLoad(this.src);if(Gallery.workspace.detailView.atMovieView())return;this.src='/g/images/gallery/spacer.gif';this.owner.addClassName('missing');if(SC.isIE())$('detailImageView').style.border='4px dashed #444';Gallery.workspace.detailView.set('rendering',false);this.style.visibility="visible";};var url=this.content.get("web");Gallery.Checkpoint.startContentLoad(url);this.img_detail.src=url;this.owner.set('scaling',false);}
else
{if($('scaleImg')){$('scaleImg').style.visibility="hidden";}
this.img_detail.src='/g/images/gallery/spacer.gif';this.style.visibility="hidden";this.img_detail.style.visibility="hidden";this.img_detail.onload=function()
{Gallery.Checkpoint.endContentLoad(this.src);if(Gallery.workspace.detailView.atMovieView())return;Gallery.workspace.detailView.set('rendering',false);if(SC.isIE())
{$('detailImageView').img_detail.width+=1;$('detailImageView').img_detail.width-=1;}
this.style.visibility="visible";this.owner.style.visibility="visible";};this.img_detail.onerror=function()
{Gallery.Checkpoint.endContentLoad(this.src);if(Gallery.workspace.detailView.atMovieView())return;this.src='/g/images/gallery/spacer.gif';this.owner.addClassName('missing');if(SC.isIE())$('detailImageView').style.border='4px dashed #444';Gallery.workspace.detailView.set('rendering',false);this.style.visibility="visible";this.owner.style.visibility="visible";};var url=this.content.get("web");Gallery.Checkpoint.startContentLoad(url);this.img_detail.src=url;}
this.owner.hoverView.downloadButton.className=(content.get('canDownload')&&(content.get('largeImagePath')||content.get('webImagePath')||content.get('isContribution')))?'download_detail':'download_detail_disabled';},removescaleImg:function(){this.owner.set("scaling",false);if(!this.get("content"))return;var image=this.$tag('img');image.style.visibility="visible";image.src=SC.isIE()?'/g/images/gallery/spacer.gif':'';image.onload=function(){if($('scaleImg')){Effect.Fade('scaleImg',{duration:.3,afterFinish:function(){var it=$('scaleImg');if(it)Element.remove(it);}});}};image.src=this.content.get("web");},isNextPrevBinding:"Gallery.workspace.detailView.isNextPrev",isVisibleBinding:'*owner.atImageView',observesEvents:true}).outletFor('#detailImageView'),movieView:Gallery.VideoView.extend({isNextPrev:false,cHeight:0,cWidth:0,oTop:0,oLeft:0,_currentiMovieSize:null,_hasMobile:false,_hasSmall:false,_hasMedium:false,_hasLarge:false,_videoSource:'',_videoHeight:0,_videoWidth:0,_content:null,comingFromInfoView:false,outlets:["videoTitleLabel","iMovieLinks","movieDescription","movieDescriptionLabel","iMovieGalleryFooter"],videoTitleLabel:"#videoTitleLabel",_canDownload:function(){return this._content&&this._content.get('canDownload');}.property(),movieDescription:Mac.LabelView.extend({escapeHTML:false}).outletFor("#movieDescription"),movieDescriptionLabel:Mac.LabelView.extend({localize:true}).outletFor("#movieDescriptionLabel"),videoTitleLabel:Mac.LabelView.extend({isVisibleBinding:'*owner.owner.atiPhotoMovieView'}).outletFor('#videoTitleLabel'),iMovieLinks:Mac.View.extend({outlets:["mobileMovieButton","smallMovieButton","mediumMovieButton","largeMovieButton","leftseperator","middleseperator","rightseperator"],mobileMovieButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link.Tooltip",action:function(){this.owner.owner.replaceiMovie("Mobile");}}).outletFor('#mobileMovieButton'),smallMovieButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link.Tooltip",action:function(){this.owner.owner.replaceiMovie("Small");}}).outletFor('#smallMovieButton'),mediumMovieButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link.Tooltip",action:function(){this.owner.owner.replaceiMovie("Medium");}}).outletFor('#mediumMovieButton'),largeMovieButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link.Tooltip",action:function(){this.owner.owner.replaceiMovie("Large");}}).outletFor('#largeMovieButton'),leftseperator:Mac.ButtonView.extend({}).outletFor('#leftseperator'),middleseperator:Mac.ButtonView.extend({}).outletFor('#middleseperator'),rightseperator:Mac.ButtonView.extend({}).outletFor('#rightseperator'),isVisibleBinding:'*owner.owner.atiMovieMovieView'}).outletFor("#iMovieLinks"),iMovieGalleryFooter:Mac.View.extend({outlets:['dotmacGalleryButton','ownerLabel','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],ownerLabel:Mac.LabelView.extend({localize:true,contentBinding:'Gallery.adaptor.ownerLabel',ownerObserver:function(){this.set('isVisible',true);}.observes('Gallery.adaptor.owner')}).outletFor(".ownerLabel?"),dotmacGalleryButton:Mac.ButtonView.extend({action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor("#iMovieHelpLinkBtn"),isVisibleBinding:'*owner.owner.atiMovieMovieView'}).outletFor("#iMovieGalleryFooter"),render:function()
{if(!this.get("content")||this.owner.atInfoView()){Gallery.workspace.detailView.set("rendering",false);return;}
Element.removeClassName($('iMovieLinks'),'clearBoth');Element.removeClassName($('videoTitleLabel'),'clearBoth');this.destroyMovie();this._content=this.get("content");if(Gallery.workspace.detailView.showOnIndex)
{if(SC.isIE6())
{setTimeout(this.sourceRenderiMovie.bind(this),1);}
else
{this.sourceRenderiMovie();}}
else
{if(SC.isIE6())
{setTimeout(this.sourceRenderiPhoto.bind(this),1);}
else
{this.sourceRenderiPhoto();}
this.owner.contentDiv.style.height=Mac.View.windowHeight()+"px";}},sourceRenderiMovie:function()
{this.setDefaultiMovieLinksUI();this.prepareiMovie();this.setiMovieDescription();if(AC.Detector.isValidQTAvailable(this.requiredQTVersion))
{this.runMovie(!this.get("_canDownload"));}
this.calculateLogoOffset();},setiMovieDescription:function(content)
{if(Gallery.fullscreen)return;this.movieDescription.set("isVisible",false);this.movieDescriptionLabel.set("isVisible",false);this.movieDescription.set("content",null);if(this._content.get("showDescription")&&this._content.get("photoDescription")!==null&&this._content.get("photoDescription")!==undefined&&this._content.get("photoDescription")!="")
{var splitOnNewlineArray=this._content.get("photoDescription").split('\n');var safeDescriptionString='';for(var i=0;i<splitOnNewlineArray.length;i++)
{safeDescriptionString+="<p>"+splitOnNewlineArray[i].escapeHTML()+"</p>";}
this.movieDescriptionLabel.set("isVisible",true);this.movieDescription.set("isVisible",true);this.movieDescription.set("content",safeDescriptionString);}},replaceiMovie:function(size)
{if(size==this._currentiMovieSize)return;this.destroyMovie();Element.removeClassName($('iMovieLinks'),'clearBoth');this._currentiMovieSize=size;this.prepareiMovie();if(AC.Detector.isValidQTAvailable(this.requiredQTVersion))
{this.runMovie(!this.get("_canDownload"));}
this.calculateLogoOffset();},prepareiMovie:function(content)
{if(this._content.get("video"+this._currentiMovieSize))
{this._videoSource=this._content.get("video"+this._currentiMovieSize);this.iMovieLinks.mobileMovieButton.set("isSelected",false);this.iMovieLinks.smallMovieButton.set("isSelected",false);this.iMovieLinks.mediumMovieButton.set("isSelected",false);this.iMovieLinks.largeMovieButton.set("isSelected",false);switch(this._currentiMovieSize)
{case'Mobile':this.iMovieLinks.mobileMovieButton.set("isSelected",true);break;case'Small':this.iMovieLinks.smallMovieButton.set("isSelected",true);break;case'Medium':this.iMovieLinks.mediumMovieButton.set("isSelected",true);break;case'Large':this.iMovieLinks.largeMovieButton.set("isSelected",true);break;}}
else
{if(Gallery.fullscreen)
{if(this._hasLarge)
{this._currentiMovieSize='Large';this._videoSource=this._content.get("videoLarge");this.iMovieLinks.largeMovieButton.set("isSelected",true);}
else if(this._hasMedium)
{this._currentiMovieSize='Medium';this._videoSource=this._content.get("videoMedium");this.iMovieLinks.mediumMovieButton.set("isSelected",true);}
else if(this._hasSmall)
{this._currentiMovieSize='Small';this._videoSource=this._content.get("videoSmall");this.iMovieLinks.smallMovieButton.set("isSelected",true);}
else if(this._hasMobile)
{this._currentiMovieSize='Mobile';this._videoSource=this._content.get("videoMobile");this.iMovieLinks.mobileMovieButton.set("isSelected",true);}}
else
{if(this._hasMedium)
{this._currentiMovieSize='Medium';this._videoSource=this._content.get("videoMedium");this.iMovieLinks.mediumMovieButton.set("isSelected",true);}
else if(this._hasLarge)
{this._currentiMovieSize='Large';this._videoSource=this._content.get("videoLarge");this.iMovieLinks.largeMovieButton.set("isSelected",true);}
else if(this._hasSmall)
{this._currentiMovieSize='Small';this._videoSource=this._content.get("videoSmall");this.iMovieLinks.smallMovieButton.set("isSelected",true);}
else if(this._hasMobile)
{this._currentiMovieSize='Mobile';this._videoSource=this._content.get("videoMobile");this.iMovieLinks.mobileMovieButton.set("isSelected",true);}}}
this.calculateDimensions(this._content.get("videoHeight"+this._currentiMovieSize),this._content.get("videoWidth"+this._currentiMovieSize));this.createPosterImage(this._content.get("poster"));},topSpacing:69,bottomSpacing:150,sideSpacing:69,calculateDimensions:function(height,width)
{if(Gallery.fullscreen)
{var allowedHeight=(window.innerHeight||document.documentElement.clientHeight)-50;var allowedWidth=(window.innerWidth||document.documentElement.clientWidth);if(Gallery.speed<=VIDEO_1680_MAX)
{allowedWidth=Math.min(allowedWidth,1680);}
else if(Gallery.speed<=VIDEO_1920_MAX)
{allowedWidth=Math.min(allowedWidth,1920);}
var newHeight=0;var newWidth=0;if(width>height)
{if(allowedWidth>allowedHeight)
{newHeight=allowedHeight;newWidth=allowedHeight*(width/height);}
else
{newWidth=allowedWidth;newHeight=allowedWidth*(height/width);}}
height=newHeight;width=newWidth;this.fsLetterBoxHeight=-70+((window.innerHeight||document.documentElement.clientHeight)-50-(height-26))/2+"px";if(this.showStandardController())
{$('controller').style.position="relative";$('controller').style.top=this.fsLetterBoxHeight;}
this.style.position="relative";this.style.top=this.fsLetterBoxHeight;}
else
{var allowedHeight=(window.innerHeight||document.documentElement.clientHeight)-this.topSpacing-this.bottomSpacing;var allowedWidth=(window.innerWidth||document.documentElement.clientWidth)-this.sideSpacing*2;}
if(allowedHeight<50||allowedWidth<50)return;if(height>allowedHeight||width>allowedWidth)
{if(height>width)
{if(Math.floor((width/height)*(allowedHeight))>allowedWidth)
{this._videoWidth=allowedWidth;this._videoHeight=Math.floor((height/width)*(allowedWidth));}
else
{this._videoHeight=allowedHeight;this._videoWidth=Math.floor((width/height)*(allowedHeight));}}
else
{if(Math.floor((height/width)*(allowedWidth))>allowedHeight)
{this._videoHeight=allowedHeight;this._videoWidth=Math.floor((width/height)*(allowedHeight));}
else
{this._videoWidth=allowedWidth;this._videoHeight=Math.floor((height/width)*(allowedWidth));}}}
else
{this._videoHeight=height;this._videoWidth=width;}
if(this.showStandardController())
{this._videoHeight+=16;}
this.style.height=this._videoHeight+"px";this.style.width=this._videoWidth+"px";var goFullWidth=((allowedWidth/allowedHeight)<(this._w/this._h))?true:false;var computedHeight=(this._w>0)?Math.floor((this._h/this._w)*allowedWidth):1;var movieCommentHeight=(goFullWidth?computedHeight:allowedHeight)-4;var movieViewHeight=((movieCommentHeight>465)?movieCommentHeight:465)+"px";var movieContentHeight=((movieCommentHeight>465)?movieCommentHeight:465)-193+"px";Gallery.workspace.detailView.infoView.style.height=movieViewHeight;Gallery.workspace.detailView.infoView.infoContent.style.height=movieContentHeight;},calculateLogoOffset:function()
{if(Gallery.fullscreen)
{$('iMovieGalleryFooter').style.display='none';$('iMovieGalleryButtonloginHelpLinks').style.display='none';return;}
else
{$('iMovieGalleryFooter').style.display='';$('iMovieGalleryButtonloginHelpLinks').style.display='';}
var height=0;var topBarheight=59;var drawerHeight=52;var detailMovieControlsHeight=20;var iMovieLinksHeight=20;var windowHeight=(window.innerHeight||document.documentElement.clientHeight);var footerExtraTopComp=SC.isFireFox()?-11:-31;var desiredExtraScrollRoomAtBottomOfPage=SC.isFireFox()?30:10;if(this.movieDescription.get("isVisible"))
{height+=this.movieDescription.offsetHeight;}
if($('detailMovieControls'))
{height+=detailMovieControlsHeight;}
if(this.iMovieLinks.get("isVisible"))
{height+=iMovieLinksHeight;}
if($('detailMovieView'))
{height+=$('detailMovieView').offsetHeight+$('detailMovieView').offsetTop;}
var comp=0;if(!Gallery.workspace.get("showToolBar"))
{comp=drawerHeight;}
if(SC.isFireFox())
{$('iMovieGalleryFooter').style.top=Math.max(windowHeight+footerExtraTopComp-(210-comp),height+50)+"px";$('iMovieGalleryButtonloginHelpLinks').style.top=50+"px";this.owner.contentDiv.style.height=Mac.View.windowHeight()-(((Gallery.workspace.get("showToolBar"))?drawerHeight:0)+topBarheight)+comp+"px";}
else if(SC.isIE())
{$('iMovieGalleryFooter').style.top=Math.max(windowHeight+footerExtraTopComp-(210-comp),height+50)+"px";$('iMovieGalleryButtonloginHelpLinks').style.top=50+"px";this.owner.contentDiv.style.height=Mac.View.windowHeight()-(((Gallery.workspace.get("showToolBar"))?drawerHeight:0)+topBarheight)+comp+"px";}
else
{$('iMovieGalleryFooter').style.top=Math.max(windowHeight+footerExtraTopComp-(170-comp),height+50)+"px";$('iMovieGalleryButtonloginHelpLinks').style.top=55+"px";this.owner.contentDiv.style.height=Mac.View.windowHeight()-(((Gallery.workspace.get("showToolBar"))?drawerHeight:0)+topBarheight)+"px";}
if(SC.isSafari()&&!SC.isSafari3()){this.owner.contentDiv.style.overflow="auto";this.owner.contentDiv.style.overflowX=null;this.owner.contentDiv.style.overflowY=null;}
$('iMovieGalleryFooter').style.paddingBottom=desiredExtraScrollRoomAtBottomOfPage+"px";},calculateLogoOffsetObserver:function()
{if(this.owner.atiMovieMovieView())
{this.calculateLogoOffset();}}.observes('Gallery.workspace.showToolBar'),recalculateDimensions:function(reInit)
{if(this.hasQTError)
{this.calculateLogoOffset();return;}
if(!this._movie)return;var oldVideoHeight=this._videoHeight;var oldVideoWidth=this._videoWidtht;if(Gallery.workspace.detailView.showOnIndex)
{this.calculateDimensions(this._content.get("videoHeight"+this._currentiMovieSize),this._content.get("videoWidth"+this._currentiMovieSize));if(this.showStandardController())
{$('controller').style.width=this._videoWidth+"px";}
this.calculateLogoOffset();}
else
{this.calculateDimensions(this._content.get("videoHeight"),this._content.get("videoWidth"));}
if(oldVideoHeight!=this._videoHeight||oldVideoWidth!=this._videoWidth)
{this.setMovieDimesions();}
if(oldVideoWidth!=this._videoWidth&&!this.showStandardController())
{this.setControllerWidth();}},setDefaultiMovieLinksUI:function(size)
{this._hasMobile=this._content.get("videoMobile")?true:false;this._hasSmall=this._content.get("videoSmall")?true:false;this._hasMedium=this._content.get("videoMedium")?true:false;this._hasLarge=this._content.get("videoLarge")?true:false;if(Gallery.fullscreen)
{this.iMovieLinks.mobileMovieButton.set("isVisible",false);this.iMovieLinks.smallMovieButton.set("isVisible",false);this.iMovieLinks.mediumMovieButton.set("isVisible",false);this.iMovieLinks.largeMovieButton.set("isVisible",false);this.iMovieLinks.leftseperator.set("isVisible",false);this.iMovieLinks.middleseperator.set("isVisible",false);this.iMovieLinks.rightseperator.set("isVisible",false);if(this._hasLarge)
{this._currentiMovieSize="Large";}
else if(this._hasMedium)
{this._currentiMovieSize="Medium";}
else if(this._hasSmall)
{this._currentiMovieSize="Small";}
else
{this._currentiMovieSize="Mobile";}}
else
{this.iMovieLinks.mobileMovieButton.set("isVisible",(this._hasMobile&&(this._hasSmall||this._hasMedium||this._hasLarge))?true:false);this.iMovieLinks.smallMovieButton.set("isVisible",(this._hasSmall&&(this._hasMobile||this._hasMedium||this._hasLarge))?true:false);this.iMovieLinks.mediumMovieButton.set("isVisible",(this._hasMedium&&(this._hasSmall||this._hasMobile||this._hasLarge))?true:false);this.iMovieLinks.largeMovieButton.set("isVisible",(this._hasLarge&&(this._hasSmall||this._hasMedium||this._hasMobile))?true:false);this.iMovieLinks.leftseperator.set("isVisible",this.get('_hasSmall')&&this.get('_hasMobile')?true:false);this.iMovieLinks.middleseperator.set("isVisible",(this.get('_hasMobile')||this.get('_hasSmall'))&&(this.get('_hasMedium')||this.get('_hasLarge'))?true:false);this.iMovieLinks.rightseperator.set("isVisible",this.get('_hasLarge')&&this.get('_hasMedium')?true:false);if(this._hasMedium)
{this._currentiMovieSize="Medium";}
else if(this._hasLarge)
{this._currentiMovieSize="Large";}
else if(this._hasSmall)
{this._currentiMovieSize="Small";}
else
{this._currentiMovieSize="Mobile";}}},sourceRenderiPhoto:function()
{this.videoTitleLabel.set("content",null);this.calculateDimensions(this._content.get("videoHeight"),this._content.get("videoWidth"));this._videoSource=this._content.get("video");if(!this.get("comingFromInfoView")&&!this.get("isNextPrev")&&!Gallery.workspace.detailView.get("rendering")&&!SC.isIE()&&!Gallery.workspace.detailView.get("isFirstLoad"))
{this.createScaleImg();this.set("comingFromInfoView",false);if(this.offsetTop!=0&&this.offsetLeft!=0&&this.clientWidth!=0)
{new Effect.MoveAndResizeTo('scaleImg',this.offsetTop,this.offsetLeft,this.clientWidth,this._videoHeight,{duration:0.2,fps:100,afterFinish:this.removeScaleImg.bind(this)});}
else
{this.removeScaleImg();}}
else
{setTimeout(this.removeScaleImg.bind(this),1);}
Gallery.workspace.detailView.set('rendering',false);},removeScaleImg:function(){this.owner.set("scaling",false);try
{if($('scaleImg')!==null)
{this.removeChild($('scaleImg'));}}catch(e){}
this.createPosterImage(this._content.get("poster"));this.showTitle();this.owner.hoverView.downloadButton.className=this._content.get('canDownload')?'download_detail':'download_detail_disabled';if(AC.Detector.isValidQTAvailable(this.requiredQTVersion))
{this.finishiPhotoSetup();}},finishiPhotoSetup:function()
{this.runMovie(this.get("_canDownload"));},createScaleImg:function()
{if($('scaleImg')!=null)Element.remove($('scaleImg'));var scaleImg=document.createElement("img");scaleImg.style.position="absolute";scaleImg.style.height=this.get("cHeight")+"px";scaleImg.style.width=this.get("cWidth")+"px";scaleImg.style.top=this.get("oTop")+60+"px";scaleImg.style.left=this.get("oLeft")+"px";if(Gallery.workspace.get("nowShowing")=="grid")scaleImg.src=this._content.get("medium");else scaleImg.src=this._content.get("web");scaleImg.id="scaleImg";this.appendChild(scaleImg);},showTitle:function()
{this.videoTitleLabel.set("content",this._content.get('showTitle')?this._content.get("title"):'');},isNextPrevBinding:"Gallery.workspace.detailView.isNextPrev",isVisibleBinding:'*owner.atMovieView',observesEvents:true}).outletFor('#detailMovieView'),infoView:Mac.View.extend({outlets:["infosmallImgView","infometadataView","infoListView","infoContent"],infoContent:"#infoContent",infosmallImgView:Gallery.ImageView.extend({nowShowingBinding:"Gallery.workspace.detailView.nowShowing",outlets:["infosmallImg"],emptyElement:"",imgWidth:0,observesEvents:true,infosmallImg:".smallImg?",render:function(){if(!this.content)return;var content=this.get("content");if(!content.get('hasExifData')){var source=(content.get('viewIdentifier')==VIEW_IPHOTO_VIDEO)?content.get('videoPath'):content.get('webImagePath');Gallery.adaptor.request('exif',{'derivative':'exif','source':source,'type':'exif'});}
this.infosmallImg.onerror=function(){this.src='/g/images/gallery/spacer.gif';};this.infosmallImg.src=content.get("medium");if(content.get("webImageWidth")>content.get("webImageHeight")){this.infosmallImg.style.width=158+"px";var height=Math.floor((content.get("webImageHeight"))/(content.get("webImageWidth"))*158);var width=158;this.infosmallImg.style.height=height+"px";this.infosmallImg.makePositioned();this.infosmallImg.setStyle({top:(160-height)/2+"px",left:(160-width)/2+"px"});}else{var height=158;var width=Math.floor((content.get("webImageWidth"))/(content.get("webImageHeight"))*158);this.infosmallImg.style.height=158+"px";this.infosmallImg.style.width=width+"px";this.infosmallImg.makePositioned();this.infosmallImg.setStyle({top:(160-height)/2+"px",left:(160-width)/2+"px"});}},didClick:function(){this.imgWidth=parseInt(Gallery.workspace.detailView.imageView.img_detail.style.width,0);Gallery.workspace.detailView.imageView.img_detail.style.width="0px";Gallery.workspace.detailView.toggleView((Gallery.workspace.detailView.isVideo?(Gallery.workspace.detailView.showOnIndex?VIEW_IMOVIE_MOVIE:VIEW_IPHOTO_VIDEO):VIEW_IPHOTO_PHOTO)+'');if(this.owner.owner.atMovieView()){this.owner.owner.hoverView.infoButton.set('toolTip',"_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip".loc());this.owner.owner.movieView.set("comingFromInfoView",true);this.owner.owner.movieView.render();}
else
{this.owner.owner.hoverView.infoButton.set('toolTip',"_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip".loc());}
if(Gallery.workspace.detailView.atImageView())
{new Effect.Scale(Gallery.workspace.detailView.imageView.img_detail,100,{duration:.3,scaleFromCenter:true,scaleFrom:0,scaleMode:{originalWidth:this.imgWidth},scaleY:false,scaleX:true,queue:'front',afterFinish:this.hideViews.bind(this)});}},hideViews:function(){if(Gallery.workspace.detailView.atImageView())
{Gallery.workspace.detailView.imageView.img_detail.style.width=this.imgWidth+'px';}}}).outletFor("#infosmallImgView"),infometadataView:Mac.View.extend({outlets:["infocommentCount","infotitleLabel","infodescriptionLabel","infocontributor","infoflipBackButtonPhoto","infoflipBackButtonMovie"],infocommentCount:Mac.LabelView.extend({isVisibleBinding:'Gallery.detailPhotoController.canComment'}).outletFor('.commentCount?'),infotitleLabel:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.title',isVisibleBinding:'Gallery.detailPhotoController.showTitle'}).outletFor('.title?'),infodescriptionLabel:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.photoDescription',isVisibleBinding:'Gallery.detailPhotoController.showDescription'}).outletFor('.description?'),infocontributor:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.photoContributor',isVisibleBinding:'Gallery.detailPhotoController.isContribution',escapeHTML:false}).outletFor('.contributor?'),infoflipBackButtonPhoto:Mac.ButtonView.extend({imgWidth:0,localize:true,toolTip:"_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button.Tooltip",stopsEvent:true,action:function(){this.imgWidth=parseInt(Gallery.workspace.detailView.imageView.img_detail.style.width,0);Gallery.workspace.detailView.imageView.img_detail.style.width="0px";Gallery.workspace.detailView.toggleView(VIEW_IPHOTO_PHOTO+'');this.owner.owner.owner.hoverView.infoButton.set('toolTip',"_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip".loc());new Effect.Scale(Gallery.workspace.detailView.imageView.img_detail,100,{duration:.3,scaleFromCenter:true,scaleFrom:0,scaleMode:{originalWidth:this.imgWidth},scaleY:false,scaleX:true,queue:'front',afterFinish:this.hideViews.bind(this)});},hideViews:function(){Gallery.workspace.detailView.imageView.img_detail.style.width=this.imgWidth+'px';},isVisibleBinding:Mac.Binding.Not("Gallery.workspace.detailView.isVideo")}).outletFor('.flipBackButtonPhoto?'),infoflipBackButtonMovie:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button.Tooltip",stopsEvent:true,action:function(){this.owner.owner.owner.hoverView.infoButton.set('toolTip',"_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip".loc());Gallery.workspace.detailView.toggleView(VIEW_IPHOTO_VIDEO+'');if(this.owner.owner.owner.atMovieView()){this.owner.owner.owner.movieView.set("comingFromInfoView",true);this.owner.owner.owner.movieView.render();}},isVisibleBinding:"Gallery.workspace.detailView.isVideo"}).outletFor('.flipBackButtonMovie?')}).outletFor("#infometadataView"),infoListView:Mac.View.extend({nowShowingBinding:"Gallery.workspace.detailView.nowShowing",outlets:["infoTableImageTitle","infoTableFileTitle","infoTableCameraTitle","infoTableExposureTitle","infoWidthLabel","infoHeightLabel","infoOriginalDateLabel","infoDigitizedDateLabel","infoNameLabel","infoSizeLabel","infoModifiedLabel","infoImportedLabel","infoCameraMakeLabel","infoCameraModelLabel","infoSoftwareLabel","infoShutterLabel","infoApertureLabel","infoMaxApertureLabel","infoExposureBiasLabel","infoExposureLabel","infoExposureIndexLabel","infoFocalLengthLabel","infoDistanceLabel","infoSensingLabel","infoLightSourceLabel","infoFlashLabel","infoMeteringLabel","infoBrightnessLabel","infoISOSpeedLabel","infoGPSLatitudeLabel","infoGPSLongitudeLabel","infoGPSAltitudeLabel","infoWidth","infoHeight","infoOriginalDate","infoDigitizedDate","infoName","infoSize","infoModified","infoImported","infoCameraMake","infoCameraModel","infoSoftware","infoShutter","infoAperture","infoMaxAperture","infoExposureBias","infoExposure","infoExposureIndex","infoFocalLength","infoDistance","infoSensing","infoLightSource","infoFlash","infoMetering","infoBrightness","infoISOSpeed","infoGPSLatitude","infoGPSLongitude","infoGPSAltitude"],infoTableImageTitle:Mac.LabelView.extend({localize:true}).outletFor("#infoTableImageTitle"),infoTableFileTitle:Mac.LabelView.extend({localize:true}).outletFor("#infoTableFileTitle"),infoTableCameraTitle:Mac.LabelView.extend({localize:true}).outletFor("#infoTableCameraTitle"),infoTableExposureTitle:Mac.LabelView.extend({localize:true}).outletFor("#infoTableExposureTitle"),infoWidthLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoWidthLabel'),infoHeightLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoHeightLabel'),infoOriginalDateLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoOriginalDateLabel'),infoDigitizedDateLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoDigitizedDateLabel'),infoNameLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoNameLabel'),infoSizeLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoSizeLabel'),infoModifiedLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoModifiedLabel'),infoImportedLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoImportedLabel'),infoCameraMakeLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoCameraMakeLabel'),infoCameraModelLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoCameraModelLabel'),infoSoftwareLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoSoftwareLabel'),infoShutterLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoShutterLabel'),infoApertureLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoApertureLabel'),infoMaxApertureLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoMaxApertureLabel'),infoExposureBiasLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoExposureBiasLabel'),infoExposureLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoExposureLabel'),infoExposureIndexLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoExposureIndexLabel'),infoFocalLengthLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoFocalLengthLabel'),infoDistanceLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoDistanceLabel'),infoSensingLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoSensingLabel'),infoLightSourceLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoLightSourceLabel'),infoFlashLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoFlashLabel'),infoMeteringLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoMeteringLabel'),infoBrightnessLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoBrightnessLabel'),infoISOSpeedLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoISOSpeedLabel'),infoGPSLatitudeLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoGPSLatitudeLabel'),infoGPSLongitudeLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoGPSLongitudeLabel'),infoGPSAltitudeLabel:Mac.LabelView.extend({localize:true}).outletFor('#infoGPSAltitudeLabel'),infoWidth:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoWidth'}).outletFor('#infoWidth'),infoHeight:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoHeight'}).outletFor('#infoHeight'),infoOriginalDate:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoOriginalDate'}).outletFor('#infoOriginalDate'),infoDigitizedDate:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoDigitizedDate'}).outletFor('#infoDigitizedDate'),infoName:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoName'}).outletFor('#infoName'),infoSize:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoSize'}).outletFor('#infoSize'),infoModified:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.exifModDate'}).outletFor('#infoModified'),infoImported:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.exifArchiveDate'}).outletFor('#infoImported'),infoCameraMake:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoCameraMake'}).outletFor('#infoCameraMake'),infoCameraModel:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoCameraModel'}).outletFor('#infoCameraModel'),infoSoftware:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoSoftware'}).outletFor('#infoSoftware'),infoShutter:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoShutter'}).outletFor('#infoShutter'),infoAperture:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoAperture'}).outletFor('#infoAperture'),infoMaxAperture:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoMaxAperture'}).outletFor('#infoMaxAperture'),infoExposureBias:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoExposureBias'}).outletFor('#infoExposureBias'),infoExposure:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoExposure'}).outletFor('#infoExposure'),infoExposureIndex:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoExposureIndex'}).outletFor('#infoExposureIndex'),infoFocalLength:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoFocalLength'}).outletFor('#infoFocalLength'),infoDistance:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoDistance'}).outletFor('#infoDistance'),infoSensing:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoSensing'}).outletFor('#infoSensing'),infoLightSource:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoLightSource'}).outletFor('#infoLightSource'),infoFlash:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoFlash'}).outletFor('#infoFlash'),infoMetering:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoMetering'}).outletFor('#infoMetering'),infoBrightness:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoBrightness'}).outletFor('#infoBrightness'),infoISOSpeed:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoISOSpeed'}).outletFor('#infoISOSpeed'),infoGPSLatitude:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoGPSLatitude',escapeHTML:false}).outletFor('#infoGPSLatitude'),infoGPSLongitude:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoGPSLongitude',escapeHTML:false}).outletFor('#infoGPSLongitude'),infoGPSAltitude:Mac.LabelView.extend({contentBinding:'Gallery.detailPhotoController.infoGPSAltitude',escapeHTML:false}).outletFor('#infoGPSAltitude')}).outletFor("#infoListView"),isVisibleBinding:'*owner.atInfoView'}).outletFor('#infoView'),hoverView:Mac.View.extend({outlets:['downloadButton','prevButton','nextButton','infoButton'],didMouseOver:function(evt){this.owner.isHoverViewOn=true;},didMouseOut:function(evt){this.owner.isHoverViewOn=false;},downloadButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Download.Button.Tooltip",action:function(ev)
{var dv=Gallery.workspace.detailView;if((dv.isVideo&&!dv.movieView.get('_canDownload'))||(!dv.isVideo&&!dv.imageView.content.get('canDownload')))
return false;if(dv.isVideo)
{SC.download(dv.movieView.content.get('downloadPath'));}
else if(dv.imageView.content.get('originalImagePath')&&dv.imageView.content.get('largeImagePath'))
{Gallery.downloadPanel().downloadFrom('detail');Gallery.downloadPanel().set("isVisible",true);}
else if(dv.imageView.content.get('originalImagePath')||dv.imageView.content.get('largeImagePath')||dv.imageView.content.get('webImagePath')||dv.imageView.content.get('isContribution'))
{SC.download(dv.imageView.content.get('downloadPath'));}}}).outletFor('#download_detail'),prevButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Previous.Button.Tooltip",actionSafari:function(ev){var that=this;var rendering=Gallery.workspace.detailView.get('rendering');setTimeout(function(rendering){if(!rendering){that.owner.owner.set('rendering',true);that.owner.owner.movieView.destroyMovie();that.set("nextPrevAction",true);Gallery.workspace.detailView.showPhotos(Gallery.workspace.detailView.prevphoto,Gallery.workspace.detailView.listphoto,null,true,false);}},100);},actionOther:function(ev){if(!Gallery.workspace.detailView.get('rendering')){this.owner.owner.set('rendering',true);this.owner.owner.movieView.destroyMovie();this.set("nextPrevAction",true);Gallery.workspace.detailView.showPhotos(Gallery.workspace.detailView.prevphoto,Gallery.workspace.detailView.listphoto,null,true,false);}},init:function(){arguments.callee.base.call(this);Object.extend(this,{'action':this.actionOther});}}).outletFor('#prev_detail'),nextButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Next.Button.Tooltip",actionSafari:function(ev){var that=this;var rendering=Gallery.workspace.detailView.get('rendering');setTimeout(function(rendering){if(!rendering){that.owner.owner.set('rendering',true);that.owner.owner.movieView.destroyMovie();that.set("nextPrevAction",true);Gallery.workspace.detailView.showPhotos(Gallery.workspace.detailView.nextphoto,Gallery.workspace.detailView.listphoto,null,true,false);}},100);},actionOther:function(ev){if(!Gallery.workspace.detailView.get('rendering')){this.owner.owner.set('rendering',true);this.owner.owner.movieView.destroyMovie();this.set("nextPrevAction",true);Gallery.workspace.detailView.showPhotos(Gallery.workspace.detailView.nextphoto,Gallery.workspace.detailView.listphoto,null,true,false);}},init:function(){arguments.callee.base.call(this);Object.extend(this,{'action':this.actionOther});}}).outletFor('#next_detail'),infoButton:Mac.ButtonView.extend({imgHeight:0,imgWidth:0,clicked:false,localize:true,toolTip:"_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip",action:function(ev){if(!this.clicked){this.clicked=true;if(this.className.indexOf('info_detail_selected')>=0){this.imgWidth=parseInt(Gallery.workspace.detailView.imageView.img_detail.style.width,0);Gallery.workspace.detailView.imageView.img_detail.style.width="0px";Gallery.workspace.detailView.toggleView((Gallery.workspace.detailView.isVideo?(Gallery.workspace.detailView.showOnIndex?VIEW_IMOVIE_MOVIE:VIEW_IPHOTO_VIDEO):VIEW_IPHOTO_PHOTO)+'');if(this.owner.owner.atMovieView()){this.owner.owner.movieView.set("comingFromInfoView",true);this.owner.owner.movieView.render();this.set('toolTip',"_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip".loc());this.clicked=false;}
else
{this.set('toolTip',"_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip".loc());}
if(Gallery.workspace.detailView.atImageView())
{new Effect.Scale(Gallery.workspace.detailView.imageView.img_detail,100,{duration:.3,scaleFromCenter:true,scaleFrom:0,scaleMode:{originalWidth:this.imgWidth},scaleY:false,scaleX:true,queue:'front',afterFinish:this.hideViewsBack.bind(this)});}}else{Gallery.workspace.detailView.movieView.destroyMovie();if(!Gallery.workspace.detailView.isVideo){this.imgHeight=Gallery.workspace.detailView.imageView.img_detail.style.height;this.imgWidth=Gallery.workspace.detailView.imageView.img_detail.style.width;new Effect.BlindUp(Gallery.workspace.detailView.imageView.img_detail,{duration:.3,scaleFromCenter:true,scaleFrom:100,scaleTo:0,scaleMode:'box',scaleY:false,scaleX:true,queue:'front',afterFinish:this.hideViews.bind(this)});}else{this.hideViews();}}}},hideViews:function(){if(!Gallery.workspace.detailView.isVideo){Gallery.workspace.detailView.imageView.img_detail.style.height=this.imgHeight;Gallery.workspace.detailView.imageView.img_detail.style.width=this.imgWidth;}
Gallery.workspace.detailView.toggleView((Gallery.workspace.detailView.isVideo?VIEW_IPHOTO_VIDEO:VIEW_IPHOTO_PHOTO)+'Info');var infoView=Gallery.workspace.detailView.infoView;if(infoView)infoView.infosmallImgView.set('content',Gallery.detailPhotoController.get("content"));new Effect.BlindDown('hoverView',{duration:0});this.set('toolTip',Gallery.workspace.detailView.isVideo?"_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button".loc():"_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button".loc());this.clicked=false;},hideViewsBack:function(){Gallery.workspace.detailView.imageView.img_detail.style.width=this.imgWidth+'px';this.clicked=false;}}).outletFor('#info_detail'),isVisibleBinding:'*owner.atHoverView'}).outletFor('#hoverView'),showView:function(){if(this.get("isNextPrev")==true){if(!this.get("isVideo")){Element.setOpacity(this.imageView,1.0);Element.show(this);}else{this.movieView.style.opacity="1.0";}}else{if(Gallery.workspace)Mac.NodeCache.appendChild(Gallery.workspace);Element.show(this);}},hideView:function(){if(this.get("isNextPrev")){this.set("isNextPrev",false);}else{var desktop=$('desktop');if(Gallery.workspace&&(Gallery.workspace.parentNode!=desktop)){desktop.appendChild(Gallery.workspace);}}
Element.hide(this);},init:function(){arguments.callee.base.call(this);this.set('isVisible',false);$('desktop').appendChild(this);Event.observe(window,'resize',this.detailResize.bind(this));this.registerDependentKey('atImageView','viewstate');this.registerDependentKey('atiPhotoMovieView','viewstate');this.registerDependentKey('atiMovieMovieView','viewstate');this.registerDependentKey('atMovieView','viewstate');this.registerDependentKey('atMovieControlView','viewstate');this.registerDependentKey('atCommentView','viewstate');this.registerDependentKey('atInfoView','viewstate');this.registerDependentKey('atHoverView','viewstate');},detailResize:function(){if(this.get("isVideo")){this.movieView.recalculateDimensions(true);if(this.atInfoView()){this.scalePhotos();}}else if(!this.get("showOnIndex")){this.scalePhotos();}
if(!this.get("atiMovieMovieView"))
{this.contentDiv.style.height=Mac.View.windowHeight()+"px";}},scalePhotos:function(){var fullWidth=(window.innerWidth||document.documentElement.clientWidth)-69*2;var fullHeight=(window.innerHeight||document.documentElement.clientHeight)-69-143;fullWidth=fullWidth>0?fullWidth:1;fullHeight=fullHeight>0?fullHeight:1;var goFullWidth=((fullWidth/fullHeight)<(this._w/this._h))?true:false;var computedHeight=(this._w>0)?Math.floor((this._h/this._w)*fullWidth):1;var computedWidth=(this._h>0)?Math.floor((this._w/this._h)*fullHeight):1;Gallery.workspace.detailView.imageView.style.height=(goFullWidth?computedHeight:fullHeight)+"px";Gallery.workspace.detailView.imageView.style.width=(goFullWidth?fullWidth:computedWidth)+"px";Gallery.workspace.detailView.imageView.img_detail.style.height=Gallery.workspace.detailView.imageView.style.height;Gallery.workspace.detailView.imageView.img_detail.style.width=Gallery.workspace.detailView.imageView.style.width;Gallery.workspace.detailView.imageView.imageTitleLabel.style.width=Gallery.workspace.detailView.imageView.style.width;var commentHeight=(goFullWidth?computedHeight:fullHeight)-4;var viewHeight=((commentHeight>465)?commentHeight:465)+"px";var contentHeight=((commentHeight>465)?commentHeight:465)-193+"px";Gallery.workspace.detailView.infoView.style.height=viewHeight;Gallery.workspace.detailView.infoView.infoContent.style.height=contentHeight;},showPhotos:function(photo,photos,target,isNextPrev,isFromRoute){this.contentDiv.style.height='';this.set("isFirstLoad",(isFromRoute==null||isFromRoute==undefined)?false:true);this.set("isNextPrev",isNextPrev);this.listphoto=(photos)?[photos].flatten():[];Gallery.detailPhotoController.set("content",photo);if(photo!=null){Gallery.photosController.set('selection',photo);}
if(isFromRoute==null||isFromRoute==undefined)isFromRoute=false;if(!isFromRoute&&photo)SC.Routes.set('location',{route:photo.get('route'),bgcolor:Gallery.workspace.colorPicker.get('selectedColor')});if(photos){this.prevphoto=(photos.indexOf(photo)>0)?photos[photos.indexOf(photo)-1]:null;this.hoverView.prevButton.set('isEnabled',(photos.indexOf(photo)>0)?true:false);this.hoverView.prevButton.className=(photos.indexOf(photo)>0)?'prev_detail':'prev_detail_disabled';this.nextphoto=(photos.length-photos.indexOf(photo)>1)?photos[photos.indexOf(photo)+1]:null;this.hoverView.nextButton.set('isEnabled',(photos.length-photos.indexOf(photo)>1)?true:false);this.hoverView.nextButton.className=(photos.length-photos.indexOf(photo)>1)?'next_detail':'next_detail_disabled';}
this.contentDiv.removeClassName("iMovieVideo");if(photo&&photos&&photo.get('isVideo')){this.set("isVideo",true);this.hoverView.infoButton.set("toolTip","_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip");this.hoverView.downloadButton.set("toolTip","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip");if(target!=null){this.movieView.set("cHeight",target.clientHeight);this.movieView.set("cWidth",target.clientWidth);this.movieView.set("oTop",target.offsetTop);this.movieView.set("oLeft",target.offsetLeft);}
if(photo.get('showOnIndex')){if(!Gallery.fullscreen)
{this.contentDiv.addClassName("iMovieVideo");}
this.set("showOnIndex",true);this.toggleView(this.viewstate?this.viewstate:VIEW_IMOVIE_MOVIE+'');if($('imovieWorkspaceContent')){$('imovieWorkspaceContent').appendChild(this);};$('detailView').style.display="";}else{this.set("showOnIndex",false);this.toggleView(this.viewstate?VIEW_IPHOTO_VIDEO+this.viewstate.substring(1,this.viewstate.length):VIEW_IPHOTO_VIDEO+'');if(!isNextPrev){$('desktop').appendChild(this);}
this.set('isVisible',true);}
this.set("isVideo",true);this.movieView.set("content",null);this.movieView.set('content',(photo&&photos)?photo:null);$sel('#detailView .videoContainer').show();}else if(photo&&photos){this.set("isVideo",false);this.hoverView.infoButton.set("toolTip","_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip");this.hoverView.downloadButton.set("toolTip","_VisitorExperience.DetailPage.Download.Button.Tooltip");$sel('#detailView .videoContainer').hide();if(target!=null){this.imageView.set("cHeight",target.clientHeight);this.imageView.set("cWidth",target.clientWidth);this.imageView.set("oTop",target.offsetTop);this.imageView.set("oLeft",target.offsetLeft);}
this.set("isVideo",false);this.set("showOnIndex",false);this.toggleView(this.viewstate?VIEW_IPHOTO_PHOTO+this.viewstate.substring(1,this.viewstate.length):VIEW_IPHOTO_PHOTO+'');if(!isNextPrev){$('desktop').appendChild(this);}
this.set('isVisible',true);this.imageView.set('content',null);this.imageView.set('content',(photo&&photos)?photo:null);}else{this.imageView.set('content',null);this.movieView.set('content',null);this.set('isVisible',false);this.viewstate=null;}
this.mouseDidMove();},mouseDidMove:function(evt){if(this._fadeTimeout){clearTimeout(this._fadeTimeout);this._fadeTimeout=null;}
if(this._fadingEffect){this._fadingEffect.cancel();this._fadingEffect=null;}
if(this.viewstate&&this.viewstate.indexOf(VIEW_IMOVIE_MOVIE)<0){if(!this._boundFadeHoverView){this._boundFadeHoverView=this._fadeHoverView.bind(this);}
this._fadeTimeout=setTimeout(this._boundFadeHoverView,2000);if(this._hoverFader)this._hoverFader.cancel();if((SC.isIE6())||(SC.isFireFox()&&this.get("isVideo"))){this.hoverView.style.display="block";}else if(SC.isIE()){new Effect.Opacity(this.hoverView,{duration:0.0,to:1.0,from:1.0,afterFinish:this.fixOpacity.bind(this,true)});}
else{this.hoverView.style.opacity="1.0";}}},fixOpacity:function(one){if(one){this.hoverView.style.opacity="1.0";}else{this.hoverView.style.opacity="0.0";}},hideHoverView:function(){if((SC.isIE6())||(SC.isFireFox()&&this.get("isVideo"))){this.hoverView.style.display="none";}else{this._hoverFader=(new Effect.Opacity(this.hoverView,{duration:1.0,to:0.0,from:1.0,afterFinish:this.fixOpacity.bind(this,false)}));}},_fadeHoverView:function(){if(!this.isHoverViewOn&&this.viewstate&&this.viewstate.indexOf('Info')<0){Gallery.workspace.detailView.hideHoverView();}},atImageView:function(){var viewstate=this.get('viewstate');return viewstate&&viewstate==VIEW_IPHOTO_PHOTO;}.property(),atiPhotoMovieView:function(){return this.get('viewstate')&&this.get('viewstate')==VIEW_IPHOTO_VIDEO;}.property(),atiMovieMovieView:function(){return this.get('viewstate')&&this.get('viewstate')==VIEW_IMOVIE_MOVIE;}.property(),atMovieView:function(){return this.get('viewstate')&&(this.get('viewstate')==VIEW_IPHOTO_VIDEO||this.get('viewstate')==VIEW_IMOVIE_MOVIE);}.property(),atMovieControlView:function(){return this.get('viewstate')&&(this.get('viewstate')==VIEW_IPHOTO_VIDEO||this.get('viewstate')==VIEW_IMOVIE_MOVIE);}.property(),atCommentView:function(){return this.get('viewstate')&&this.get('viewstate').indexOf('Comment')>=0;}.property(),atInfoView:function(){return this.get('viewstate')&&this.get('viewstate').indexOf('Info')>=0;}.property(),atHoverView:function(){return this.get('viewstate')&&this.get('viewstate').indexOf(VIEW_IMOVIE_MOVIE)<0;}.property(),toggleView:function(state){if(!this.viewstate||this.viewstate!=state){Gallery.workspace.detailView.set("viewstate",state);if(state==VIEW_IPHOTO_PHOTO){Gallery.workspace.detailView.imageView.img_detail.style.display="";}}
if(state.indexOf('Info')>=0){Gallery.workspace.detailView.infoView.infosmallImgView.set('content',Gallery.detailPhotoController.get("content"));}
this.hoverView.infoButton.className=state.indexOf('Info')<0?'info_detail':'info_detail_selected';}});Effect.MoveAndResizeTo=Class.create();Object.extend(Object.extend(Effect.MoveAndResizeTo.prototype,Effect.Base.prototype),{initialize:function(element,toTop,toLeft,toWidth,toHeight){this.element=$(element);this.toTop=toTop;this.toLeft=toLeft;this.toWidth=toWidth;this.toHeight=toHeight;this.originalTop=parseFloat(Element.getStyle(this.element,'top')||0);this.originalLeft=parseFloat(Element.getStyle(this.element,'left')||0);this.originalWidth=parseFloat(Element.getStyle(this.element,'width')||0);this.originalHeight=parseFloat(Element.getStyle(this.element,'height')||0);this.effectiveTop=this.toTop;this.effectiveLeft=this.toLeft;this.effectiveWidth=this.toWidth
-parseFloat(Element.getStyle(this.element,'margin-left')||0)
-parseFloat(Element.getStyle(this.element,'margin-right')||0)
-(document.compatMode=='BackCompat'?0:parseFloat(Element.getStyle(this.element,'padding-left')||0)
+parseFloat(Element.getStyle(this.element,'padding-right')||0)
+parseFloat(Element.getStyle(this.element,'border-left-width')||0)
+parseFloat(Element.getStyle(this.element,'border-right-width')||0));this.effectiveHeight=this.toHeight
-parseFloat(Element.getStyle(this.element,'margin-top')||0)
-parseFloat(Element.getStyle(this.element,'margin-bottom')||0)
-(document.compatMode=='BackCompat'?0:parseFloat(Element.getStyle(this.element,'padding-top')||0)
+parseFloat(Element.getStyle(this.element,'padding-bottom')||0)
+parseFloat(Element.getStyle(this.element,'border-top-width')||0)
+parseFloat(Element.getStyle(this.element,'border-bottom-width')||0));this.options=arguments[5]||{};if(this.effectiveWidth<0)this.effectiveWidth=0;if(this.effectiveHeight<0)this.effectiveHeight=0;if(this.originalTop==this.effectiveTop&&this.originalLeft==this.effectiveLeft&&this.originalWidth==this.effectiveWidth&&this.originalHeight==this.effectiveHeight){return;}
this.start(this.options);},update:function(position){topd=this.effectiveTop*(position)+this.originalTop*(1-position);leftd=this.effectiveLeft*(position)+this.originalLeft*(1-position);widthd=this.effectiveWidth*(position)+this.originalWidth*(1-position);heightd=this.effectiveHeight*(position)+this.originalHeight*(1-position);this.setPosition(topd,leftd,widthd,heightd);},setPosition:function(topd,leftd,widthd,heightd){this.element.style.top=topd+'px';this.element.style.left=leftd+'px';this.element.style.width=widthd+'px';this.element.style.height=heightd+'px';}});require('core');Gallery.uploaderURL='/g/uploader.html';Gallery.carouseljsURL="/g/gallerycarousel.html";Gallery.gridfsURL="/g/gallerygrid.html";Gallery.fullscreen=false;Gallery.fullscreenOpen=false;Gallery.firstRun=true;Gallery.albumName=null;Gallery.windowBlurred=false;Gallery.ignoreFocus=false;Gallery.speed=0;Gallery.enableScrubSprites=true;Gallery.enableImagePreload=true;Gallery.imagePreloadDelay=1000;Gallery.showCarouselProgress=false;Gallery.useGridFS=false;Gallery.useGridFSCanvases=true;Gallery.useGridFSTracking=false;Gallery.gridFSThreadCount=4;Gallery.gridFSThreadDelay=0;Gallery.gridFSFPS=SC.isFireFox()?30:60;Gallery.gridScale=200;Gallery.enableGridCanvases=true;Gallery.canvasGridResizeResolution=80;Gallery.enableGridReflections=true;Gallery.gridImageSize='medium';Gallery.useDowner=true;Gallery.imageThreadCount=5;Gallery.imageThreadDelay=0;Gallery.cacheWebsInMosaic=false;Gallery.enableBadging=true;Gallery.badgingGracePeriod=14*(1000*60*60*24);Gallery.localStorageType='flash';Gallery.localStorageInitDelay=(Gallery.localStorageType=='flash'?500:0);Gallery.localStorageExpiration=365*(1000*60*60*24);Gallery.isLocalhost=(window.location.hostname.indexOf("gallery.yourdomain.com")!=0&&window.location.hostname.indexOf("gallery.mac.com")!=0);Gallery.defaultUser='emily_parker';Gallery.prettyJSON=false;Gallery.enableBenchmarks=false;Gallery.benchmarkType='time';Gallery.enableFixtures=false;Gallery.fixtureFile='emily_parker-prod.json';var shouldSynchronize=false;function processRuntimeOptions(optionString)
{if(!optionString||optionString==''||!optionString.startsWith('?'))
return;var optionList=optionString.substring(1).split('&');optionList.each(function(optionItem)
{var isValid=true;var nvp=optionItem.split('=');var name=nvp[0];var value=nvp[1];if(!name||!value)
return;if(value.toString().toLowerCase()=='true')value=1;if(value.toString().toLowerCase()=='false')value=0;if(value.toString().toLowerCase()=='yes')value=1;if(value.toString().toLowerCase()=='no')value=0;switch(name)
{case'isLocalhost':Gallery.isLocalhost=parseInt(value,0);break;case'defaultUser':Gallery.defaultUser=value;break;case'user':Gallery.defaultUser=value;break;case'enableScrubSprites':Gallery.enableScrubSprites=parseInt(value,0);break;case'enableImagePreload':Gallery.enableImagePreload=parseInt(value,0);break;case'imagePreloadDelay':Gallery.imagePreloadDelay=parseInt(value,0);break;case'showCarouselProgress':Gallery.showCarouselProgress=parseInt(value,0);break;case'enableGridCanvases':Gallery.enableGridCanvases=parseInt(value,0);break;case'canvasGridResizeResolution':Gallery.canvasGridResizeResolution=parseInt(value,10);break;case'enableGridReflections':Gallery.enableGridReflections=parseInt(value,0);break;case'useGridFS':Gallery.useGridFS=parseInt(value,0);break;case'useGridFSCanvases':Gallery.useGridFSCanvases=parseInt(value,0);break;case'useGridFSTracking':Gallery.useGridFSTracking=parseInt(value,0);break;case'gridFSFPS':Gallery.gridFSFPS=parseInt(value,10);break;case'gridFSThreadCount':Gallery.gridFSThreadCount=parseInt(value,10);break;case'gridFSThreadDelay':Gallery.gridFSThreadDelay=parseInt(value,10);break;case'gridImageSize':Gallery.gridImageSize=value;break;case'enableBenchmarks':Gallery.enableBenchmarks=parseInt(value,0);break;case'benchmarkType':Gallery.benchmarkType=value;break;case'pretty':Gallery.prettyJSON=parseInt(value,0);break;case'localStorageType':Gallery.localStorageType=value;break;case'localStorageInitDelay':Gallery.localStorageInitDelay=parseInt(value,0);break;case'enableFixtures':Gallery.enableFixtures=parseInt(value,0);break;case'fixtureFile':Gallery.fixtureFile=value;break;case'useDowner':Gallery.useDowner=parseInt(value,0);break;case'imageThreadCount':Gallery.imageThreadCount=parseInt(value,10);break;case'imageThreadDelay':Gallery.imageThreadDelay=parseInt(value,10);break;case'badgingGracePeriod':Gallery.badgingGracePeriod=parseInt(value,10);break;default:isValid=false;break;}});}
processRuntimeOptions(window.location.search);require('config');require('views/image_view');Gallery.useCanvas=function(){return Gallery.enableGridCanvases&&((SC.isFireFox()&&navigator.userAgent.indexOf("Firefox/2.0.0.10")==-1)||SC.isSafari3());};Gallery.gridReflectionHeight=1.2;Gallery.GridImageView=Gallery.ImageView.extend({scale:125,_defaultDim:160,_maxDim:320,emptyElement:Gallery.useCanvas()?'<div style="visibility: hidden"><canvas></canvas><div class="unseenIcon"></div><div class="title"></div><div class="movieBadge hit" style="visibility: hidden"><div class="badge"></div><div class="duration hit"></div></div></div>':'<div class="item photo" style="visibility: hidden"><div class="imgContainer"><img src="" class="primaryImage hit"></div><div class="metadata hit"><div class="unseenIcon"></div><div class="title"></div><div class="movieBadge hit" style="visibility: hidden"><div class="badge"></div><div class="duration hit"></div></div><div class="reflectionContainer"><img class="reflection" src=""><div class="reflectionMask"></div></div></div></div>',outlets:Gallery.useCanvas()?['can','unseenIcon','movieBadge','duration']:['primaryImage','metadataContainer','imageReflection','reflectionContainer','unseenIcon'],can:Gallery.useCanvas()?"[0]":null,primaryImage:Gallery.useCanvas()?null:"[0][0]",metadataContainer:Gallery.useCanvas()?null:"[1]",imageReflection:Gallery.useCanvas()?null:"[1][3][0]",reflectionContainer:Gallery.useCanvas()?null:".reflectionContainer?",unseenIcon:Gallery.useCanvas()?".unseenIcon":".unseenIcon",titleLabel:Gallery.useCanvas()?Mac.View.outletFor('.title?'):Mac.View.outletFor('.title?'),movieBadge:Gallery.useCanvas()?"[3]":"[1][2]",duration:Gallery.useCanvas()?"[3][1]":"[1][2][1]",reflectionMask:Gallery.useCanvas()?null:"[1][3][1]",outlet:function(key,configure){var ret=this[key];if(configure!==false)configure=true;if(typeof ret=="string"){if(!configure)return null;ret=this.$$sel(ret);if(ret){ret=(ret.length==0)?null:((ret.length==1)?ret[0]:ret);}
this[key]=ret;}else if(ret&&ret.isOutlet){if(!configure)return null;this[key]=ret=ret.call(this);}
return ret;},hitTest:function(evt)
{var target=Event.element(evt);if(Gallery.useCanvas()==true&&target==this||target==this.can)return true;while(target&&target!=this){if(target.hasClassName('hit')&&!target.hasClassName('missing'))return true;target=target.parentNode;}
return false;},init:function(){arguments.callee.base.call(this);try{if(Gallery.useCanvas()==true){this.con=this.can.getContext('2d');this.can.style.cursor="pointer";}}catch(e){};},requestMe:function(importance){var content=this.get("content");if(!content)return;if(importance===undefined)importance=0;var imgSrc=content.get(Gallery.gridImageSize);Gallery.Checkpoint.startContentLoad(imgSrc);this.loadee=ImageLoadee.create({url:imgSrc,importance:importance,onload:function(){this._isLoaded=true;if(Gallery.useCanvas()){Gallery.Checkpoint.endContentLoad(this.loadee.url);this.paintCanvas(this.___defaultDim);return;}
this.primaryImage.src=this.loadee.url;}.bind(this)}).enter(Gallery.gridLoadees);if(Gallery.useCanvas()||!Gallery.enableGridReflections)return;var refSrc=content.get(Gallery.gridImageSize+"Reflection");this.reflectionLoadee=ImageLoadee.create({url:refSrc,importance:importance,proximityAdjust:0.5*100000,onload:function(){this.imageReflection.src=this.reflectionLoadee.url;}.bind(this)}).enter(Gallery.gridLoadees);},_mouseIsDown:false,onmousedown:function(){if(Gallery.useCanvas()==false)return;this._mouseIsDown=true;},paintCanvas:function(dimension,hideTitle){this._lastPaintedDimension=dimension;if(Gallery.useCanvas()!=true)return;var content=this.get('content');if(!content)return;var maxDim=this.scaleMe(this._maxDim);var imgHeight=Math.round(this.scaleMe(content.get("thumbImageHeight")));var imgWidth=Math.round(this.scaleMe(content.get("thumbImageWidth")));this.can.realWidth=imgWidth;this.can.realHeight=Math.round(imgHeight*Gallery.gridReflectionHeight);this.can.realInHeight=imgHeight;if(!dimension){this.can.width=this.can.realWidth;this.can.height=this.can.realHeight;this.can.inHeight=this.can.realInHeight;}else{var w=ww=this.can.realWidth;var h=hh=this.can.realInHeight;if(w>h){ww=dimension;hh=dimension*h/w;}else{ww=dimension*w/h;hh=dimension;}
this.can.width=ww;this.can.inHeight=hh;this.can.height=hh*Gallery.gridReflectionHeight;}
if(this._isLoaded==true)
this.con.drawImage(this.loadee.image,0,0,this.can.width,this.can.inHeight);else{var xs=this.can.width/2;var ys=1.25*this.can.inHeight;var radius=Math.sqrt(xs*xs+ys*ys);var gradient=this.con.createRadialGradient(this.can.width/2,-1*this.can.inHeight/8,0,this.can.width/2,this.can.inHeight/4,radius);var selectedColorStr=Gallery.workspace.colorPicker.get('selectedColor')||"black";var selectedColor=Gallery.bgColors[selectedColorStr];var gray=Math.round((parseInt(selectedColor.substring(1,3),16)+parseInt(selectedColor.substring(3,5),16)+parseInt(selectedColor.substring(5,7),16))/3);var start,stop=gray;if(selectedColorStr=="black")start=75;if(selectedColorStr=="dkgrey")start=100;if(selectedColorStr=="ltgrey")start=255-100;if(selectedColorStr=="white")start=255-75;if(selectedColorStr=="white"||selectedColorStr=="ltgrey"){var temp=start;start=stop;stop=temp;}
if(selectedColorStr=="black")stop+=10;if(selectedColorStr=="dkgrey"){start-=12;stop-=12;}
gradient.addColorStop(0,"rgba("+(start+1)+","+(start-1)+","+(start)+", 1)");gradient.addColorStop(1,"rgba("+stop+", "+stop+", "+stop+", 1)");this.con.fillStyle=gradient;this.con.fillRect(0,0,this.can.width,this.can.height);}
this.con.save();this.con.scale(1,-1);this.con.translate(0,-1*this.can.inHeight+1);if(this._isLoaded==true)
this.con.drawImage(this.loadee.image,0,-1*this.can.inHeight,this.can.width,this.can.inHeight);else{}
var selectedColor=Gallery.bgColors[Gallery.workspace.colorPicker.get('selectedColor')||"black"];var gradient=this.con.createLinearGradient(0,this.can.inHeight,0,this.can.height);var red=parseInt(selectedColor.substring(1,3),16);var green=parseInt(selectedColor.substring(3,5),16);var blue=parseInt(selectedColor.substring(5,7),16);var startO=0.7;if(!this._isLoaded)startO=0.4;gradient.addColorStop(0,"rgba("+red+", "+green+", "+blue+", "+startO+")");gradient.addColorStop(1,"rgba("+red+", "+green+", "+blue+", 1)");this.con.restore();this.con.fillStyle=gradient;this.con.fillRect(0,this.can.inHeight,this.can.width,this.can.height);this.fixTitleStyle();},render:function()
{var content=this.get("content");if(!content)return;var scale=this.get('scale');var title=content.get("showTitle")?content.get("title").escapeHTML():'';if(title.length==0&&!content.get('isVisited'))
{title=Gallery.getDateLabel(new Date(content.get('updated')||''));this.outlet('titleLabel').addClassName("date");this.set('isShowingDate',true);}
var titleLabel=this.outlet('titleLabel',title.length>0);if(titleLabel){titleLabel.set('asHTML',title);titleLabel.set('toolTip',title);}
this.fixTitleStyle(scale);this.renderVisitedState();if(content.get("isVideo"))
{var movieBadge=this.outlet('movieBadge');movieBadge.style.visibility="visible";var dur=content.get("videoDuration");if(dur!==undefined&&dur!==null){var min=Math.floor(dur/60);var hrs=Math.floor(min/60);min=min-hrs*60;var sec=dur%60;var time=(hrs>0)?hrs+":":"";time+=min+":"+((sec>9)?"":"0")+sec;this.outlet('duration').innerHTML=time;}}else{var movieBadge=this.outlet('movieBadge',false);if(movieBadge)movieBadge.style.visibility='hidden';}
if(!content.get("showTitle")){var movieBadge=this.outlet('movieBadge',false);if(movieBadge)movieBadge.addClassName("noTitle");}
if(Gallery.useCanvas()){var defaultDim=this.scaleMe(this._defaultDim);var maxDim=this.scaleMe(this._maxDim);var imgHeight=Math.round(this.scaleMe(content.get("thumbImageHeight"))/maxDim*defaultDim);var imgWidth=Math.round(this.scaleMe(content.get("thumbImageWidth"))/maxDim*defaultDim);this.style.width=imgWidth+"px";this.style.height=Math.round(imgHeight*Gallery.gridReflectionHeight)+"px";this.can.style.width=imgWidth+"px";this.can.style.height=Math.round(imgHeight*Gallery.gridReflectionHeight)+"px";this.paintCanvas(scale*1.6);this.unseenIcon.style.top=(imgHeight+6)+'px';if(titleLabel){titleLabel.style.position="absolute";titleLabel.style.top=(imgHeight)+"px";}
if(content.get('isVideo')){this.movieBadge.style.width=imgWidth+"px";this.movieBadge.style.position="absolute";this.movieBadge.style.left="0px";this.movieBadge.style.top=imgHeight-11+'px';}
return;}
this._oldScale=this.get('scale');var defaultDim=this.scaleMe(this._defaultDim);var maxDim=this.scaleMe(this._maxDim);var imgHeight=this.scaleMe(content.get("thumbImageHeight"))/maxDim*100;var imgWidth=this.scaleMe(content.get("thumbImageWidth"))/maxDim*100;this.metadataContainer.setStyle({width:(''+Math.min(100,imgWidth||0)+"%")});if(Gallery.enableGridReflections){}
else
this.reflectionContainer.style.display='none';if(SC.isFireFox()&&SC.isWindows()){}else{this.primaryImage.observe('error',this.missing.bind(this));this.primaryImage.observe('load',this.loaded.bind(this));}
var imgSrc=content.get(Gallery.gridImageSize);var color=Gallery.workspace.colorPicker.get('selectedColor')||"black";this.primaryImage.src="/g/images/gallery/carouseljs/"+color+"loading.jpg";this.imageReflection.src="/g/images/footer/spacer.gif";this.imageReflection.style.background="#888888";var thisStyles={height:defaultDim+"px",width:defaultDim+"px"};var imgStyles={height:imgHeight+"%",width:imgWidth+"%",marginTop:100-imgHeight+"%"};var reflectionHeight=Math.ceil(defaultDim/5);if(reflectionHeight<=10)reflectionHeight+=10;var reflectionStyle={height:reflectionHeight+"px"};this.reflectionContainer.setStyle(reflectionStyle);this.metadataContainer.setStyle(reflectionStyle);thisStyles.marginBottom=reflectionHeight+12+"px";Element.setStyle(this.primaryImage,imgStyles);Element.setStyle(this,thisStyles);if(Gallery.enableGridReflections&&SC.isIE6()){this.outlet('reflectionMask');this.reflectionMask.style.overflow="hidden";this.reflectionMask.style.position="absolute";this.reflectionMask.style.top=(-5)+"px";this.reflectionMask.style.left="0px";this.reflectionMask.style.width="100%";this.reflectionMask.style.height="100%";this.imageReflection.style.position="absolute";this.imageReflection.style.top=(-5)+"px";this.imageReflection.style.left="0px";this.imageReflection.style.width="99.8%";this.imageReflection.style.height="95%";if(content.get('isVideo')){var movieBadgeBorder=document.createElement("div");movieBadgeBorder.className="ie6movieBadgeTopBorder";movieBadgeBorder.style.cssText="width:100%; height:1px; position:absolute; left:0px; top:"+(Math.floor(defaultDim)-14)+"px; border-top:1px solid black; border-bottom:0px; border-left:0px; border-right:0px;";this.appendChild(movieBadgeBorder);movieBadgeBorder=document.createElement("div");movieBadgeBorder.className="ie6movieBadgeBottomBorder";movieBadgeBorder.style.cssText="width:100%; height:1px; position:absolute; left:0px; top:"+(Math.floor(defaultDim)-3)+"px; border-top:1px solid black; border-bottom:0px; border-left:0px; border-right:0px;";this.appendChild(movieBadgeBorder);}
this.reflectionMask.innerHTML="<div style=\"position:absolute; left:0px; bottom:0px; width:"+(Math.ceil(imgWidth/100*defaultDim))+"px; height:"+Math.ceil(imgWidth/500*defaultDim)+"px; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/g/images/gallery/reflections/grid_"+Gallery.workspace.colorPicker.get('selectedColor')+".png' sizingMethod='scale');\"></div>";}},selectedColorObserver:function(){var color=Gallery.workspace.colorPicker.get('selectedColor');if(SC.isIE6())
this.reflectionMask.firstChild.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/g/images/gallery/reflections/grid_"+color+".png' sizingMethod='scale')";if(Gallery.useCanvas()==false&&this._isLoaded!=true)
this.primaryImage.src="/g/images/gallery/carouseljs/"+color+"loading.jpg";}.observes('Gallery.workspace.colorPicker.selectedColor'),renderVisitedState:function()
{var titleLabel=this.outlet('titleLabel');var content=this.get("content");if(content.get('isVisited'))
{this.unseenIcon.style.display='none';if(titleLabel)titleLabel.style.left='0px';if(this.get('isShowingDate'))
{if(titleLabel)titleLabel.set('asHTML','');this.set('isShowingDate',false);}}
else
{this.unseenIcon.style.display='block';if(titleLabel)titleLabel.style.left='10px';}},visitedObserver:function()
{this.renderVisitedState();}.observes('*content.visitDate'),missing:function(){if(this._ignoreNextLoad==true||this.primaryImage.src.indexOf('images/gallery/carouseljs')!=-1){this._ignoreNextLoad=false;return;}
Gallery.Checkpoint.endContentLoad(this.primaryImage.src);this.primaryImage.src='/g/images/gallery/spacer.gif';this.imageReflection.src='/g/images/gallery/spacer.gif';this.addClassName('missing');this.primaryImage.stopObserving('error',this.missing.bind(this));this.primaryImage.stopObserving('load',this.loaded.bind(this));},loaded:function(){if(this._ignoreNextLoad==true||this.primaryImage.src.indexOf('images/gallery/carouseljs')!=-1){this._ignoreNextLoad=false;return;}
Gallery.Checkpoint.endContentLoad(this.primaryImage.src);this.primaryImage.stopObserving('error',this.missing.bind(this));this.primaryImage.stopObserving('load',this.loaded.bind(this));},scaleMe:function(value)
{return(value*this.scale)/100;},didMouseOver:function(evt)
{var titleLabel=this.outlet('titleLabel');if([this.primaryImage,titleLabel].include(Event.element(evt)))
{this.addClassName("hover");}},didMouseOut:function()
{this.removeClassName("hover");},scaleObserver:function(){var scale=this.get('scale');if(this._oldScale!=scale)this.resizeMe(scale);this._oldScale=scale;}.observes("scale"),___defaultDim:null,_lastPaintDate:null,resizeMe:function(scale)
{var content=this.get("content");if(!scale)scale=this.get('scale');this.fixTitleStyle(scale);if(Gallery.useCanvas()){var defaultDim=Math.floor(this.scaleMe(this._defaultDim));this.___defaultDim=defaultDim;var w=ww=this.can.width;var h=hh=this.can.inHeight;if(w>h){ww=defaultDim;hh=defaultDim*h/w;}else{ww=defaultDim*w/h;hh=defaultDim;}
if(Math.floor(new Date())-this._lastPaintDate>500){this._lastPaintDate=Math.floor(new Date());}
this.style.width=Math.round(ww)+"px";this.style.height=Math.round(hh*Gallery.gridReflectionHeight)+"px";this.can.style.width=Math.round(ww)+"px";this.can.style.height=Math.round(hh*Gallery.gridReflectionHeight)+"px";this.unseenIcon.style.top=(hh+6)+'px';var titleLabel=this.outlet('titleLabel',true);if(titleLabel){titleLabel.style.top=(hh)+"px";}
if(content.get('isVideo')){this.movieBadge.style.width=ww+"px";this.movieBadge.style.left="0px";this.movieBadge.style.top=hh-11+'px';}
return;}
var defaultDim=Math.floor(this.scaleMe(this._defaultDim));var reflectionHeight=defaultDim/5;if(reflectionHeight<=10)reflectionHeight+=10;var thisStyles={height:defaultDim+"px",width:defaultDim+"px"};Element.setStyle(this,thisStyles);this.reflectionContainer.setStyle({height:reflectionHeight+"px"});this.metadataContainer.setStyle({height:reflectionHeight+"px"});this.setStyle({marginBottom:reflectionHeight+12+"px"});if(SC.isIE6()){if(content.get('isVideo')){var movieBadgeBorder=this.getElementsByClassName("ie6movieBadgeTopBorder")[0];movieBadgeBorder.style.top=(Math.floor(defaultDim)-14)+"px";movieBadgeBorder=this.getElementsByClassName("ie6movieBadgeBottomBorder")[0];movieBadgeBorder.style.top=(Math.floor(defaultDim)-3)+"px";}}},fixTitleStyle:function(scale){if(!scale)scale=this.get('scale');var titleLabel=this.outlet('titleLabel',false);if(titleLabel){if(scale<=200&&scale>=149){titleLabel.style.fontSize="13px";}else if(scale<=150&&scale>=99){titleLabel.style.fontSize="12px";}else if(scale<=100&&scale>=49){titleLabel.style.fontSize="11px";}else{titleLabel.style.marginTop="0px";}}}});Gallery.GridView=Mac.CollectionView.extend({exampleView:Gallery.GridImageView,actOnSelect:true,scroll:0,scrollingObserver:function()
{if(Gallery.workspace.get('nowShowing')=="grid")
{setTimeout(this.scrollMe.bind(this),1);}}.observes("Gallery.workspace.nowShowing","Gallery.photosController.currentPage"),scrollMe:function()
{Gallery.workspace.gridTab.gridView.parentNode.parentNode.onscroll=this.runEveryScroll.bind(this);Gallery.workspace.gridTab.gridView.parentNode.parentNode.scrollTop=this.get("scroll");},runEveryScroll:function(){if(!Gallery.workspace||!Gallery.workspace.gridTab||!Gallery.workspace.gridTab.layoutInfo||!Gallery.useDowner)return;var l=Gallery.workspace.gridTab.layoutInfo;var scroll=Gallery.workspace.gridTab.gridView.parentNode.parentNode.scrollTop;var target=((scroll/l.boxH*l.cols)+(scroll+Gallery.availableHeight())/l.boxH*l.cols)/2;Gallery.gridLoadees.target=(scroll==0)?0:target;},action:function(evt,el)
{if(Gallery.workspace.goingToAlbumFromGallery)
{return;}
if(evt==null||el==null)
return;var sel=this.get('selection');var target=Event.element(evt);var target=Event.element(el);if(sel&&sel.length>0&&el.hitTest&&el.hitTest(evt)){if(Gallery.useCanvas()&&el._mouseIsDown==false)return;if(Gallery.useCanvas())el._mouseIsDown=false;var scroll=Gallery.workspace.gridTab.gridView.parentNode.parentNode.scrollTop;this.set("scroll",scroll);var elementInfo=null;if(el){var toolHeight=0;if(Gallery.workspace.get("showToolBarBool"))toolHeight=Gallery.workspace.toolBar.getHeight();if(Gallery.useCanvas()==false)elementInfo={clientHeight:el.childNodes[0].childNodes[0].clientHeight,clientWidth:el.childNodes[0].childNodes[0].clientWidth,offsetTop:Position.cumulativeOffset(el.firstChild.firstChild)[1]-$("gridView").parentNode.parentNode.scrollTop-60,offsetLeft:Position.cumulativeOffset(el.firstChild.firstChild)[0]};else elementInfo={clientHeight:Math.round(parseInt(el.style.height,10)*el.can.inHeight/el.can.height),clientWidth:parseInt(el.style.width,10),offsetTop:Position.cumulativeOffset(el)[1]-$("gridView").parentNode.parentNode.scrollTop-60,offsetLeft:Position.cumulativeOffset(el)[0]};}
Gallery.detailView().set("scaling",true);Gallery.detailView().showPhotos(sel[0],(sel.length>1)?sel:Gallery.allPhotosController.get('records'),elementInfo,false);}},scale:125,scaleObserver:function(){var child=this.firstChild;var scale=this.get('scale');while(child){if(child.set)child.set('scale',scale);child=child.nextSibling;}}.observes('scale'),updateChildren:function(){arguments.callee.base.call(this);this.scaleObserver();}});Gallery.GridWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['gridView','authRequiredView','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],init:function(){arguments.callee.base.call(this);if(Gallery.useCanvas())setTimeout(function(){this._sliderHandlePointer=Gallery.workspace.sliderView.getElementsByClassName('handle')[0];this.setUpSliderHandleTriggers();}.bind(this),1);Event.observe(window,'resize',this.gridViewBodyResize.bind(this));this.gridView.style.top="0px";if(!SC.isSafari3()){setInterval(function(){if(Gallery.workspace.get('nowShowing')!='grid')return;Gallery.workspace.gridTab.doGridViewLayout("random");},1000);}},setUpSliderHandleTriggers:function(){if(!Gallery.useCanvas())return;this._sliderHandlePointer.onmousedown=function(){this.resCanvasesTo(Gallery.canvasGridResizeResolution,false);this._sliderHandlePointer.onmouseup=null;Event.observe(document,'mouseup',this.stoppedDraggingSlider);}.bind(this);this.stoppedDraggingSlider=function(){if(Gallery.workspace.get('nowShowing')!='grid')return;this.resCanvasesTo();this._sliderHandlePointer.onmouseup=this.stoppedDraggingSlider;Event.stopObserving(document,'mouseup',this.stoppedDraggingSlider);}.bind(this);this.stoppedDraggingSliderDelay=function(){setTimeout(this.stoppedDraggingSlider.bind(this),20);}.bind(this);this._sliderHandlePointer.onmouseup=this.stoppedDraggingSlider;var s=$("resizerSliderSmallerButton"),l=$("resizerSliderLargerButton");if(!s||!l){return;}
s.onmouseup=this.stoppedDraggingSliderDelay;l.onmouseup=this.stoppedDraggingSliderDelay;},resCanvasesTo:function(d,hideTitle){if(Gallery.useCanvas()!=true||!this._realImages)return;for(var i=0;i<this._realImages.length;i++)
this._realImages[i].paintCanvas(d?d:this._realImages[i].___defaultDim,hideTitle);},selectedColorRepainterObserver:function(){if(Gallery.useCanvas()!=true)return;this.resCanvasesTo(this._lastPaintedDimension);}.observes("Gallery.workspace.colorPicker.selectedColor"),gridViewBodyResize:function(){this.doGridViewLayout("window resized");},toolbarToggledObserver:function(){setTimeout((function(){this.doGridViewLayout("toolbar toggled");}).bind(this),Gallery.workspace.get('showToolBar')?1:200);}.observes("Gallery.workspace.showToolBar"),lastNowShowing:"",enteringAndExitingGridViewObserver:function()
{var nowShowing=Gallery.workspace.get('nowShowing');if(nowShowing==this.lastNowShowing||nowShowing=="imovie")return;if(nowShowing=="grid")
{setTimeout((function(){this.doGridViewLayout("enter/exit");}).bind(this),1);}
else{if(this.lastNowShowing=="grid"&&SC.isSafari()&&!SC.isSafari3()){Gallery.workspace.contentElement.set('isVisible',false);setTimeout("Gallery.workspace.contentElement.set('isVisible',true);",1);}}
this.lastNowShowing=nowShowing;}.observes("Gallery.workspace.nowShowing"),layoutInfo:{rows:0,cols:0,height:200,iterations:0},layoutRuns:0,doGridViewLayout:function(reason,scale){this.layoutInfo.iterations++;scale=this.get('scale');if($("gridView")==null||$("gridView").style.display=="none"&&$("gridView").style.visibility=="hidden"||$("headerBar")==null||Gallery.workspace==null||Gallery.workspace.get('nowShowing')!='grid')return;var images;try{images=$("gridView").childNodes;}catch(e){return;}
var realImages=new Array();for(var i=0;i<images.length;i++)
if(images[i].style.display!="none")realImages[realImages.length]=images[i];if(realImages.length==0)return;this.layoutRuns++;var imageScale=Math.floor(scale*1.6);var totalWidth=Mac.View.windowWidth();var totalHeight=Mac.View.windowHeight();var boxWidth=Math.floor(imageScale)+20;var bodyMarginCompensation=Math.floor(imageScale*.2)+20;var imageBoxHeight=Math.floor(imageScale*1.25);var visualImageBoxWidth=Math.floor(imageScale);var imageExtraTopComp=30;var extraLeftComp=-1*Math.floor(imageScale*.02);var footerExtraTopComp=0;var desiredExtraScrollRoomAtBottomOfPage=SC.isFireFox()?30:10;var extraScrollBarComp=-7;var scrollBarActivationHeightComp=(function(){if(SC.isSafari())return-2;if(SC.isFireFox())return-2;if(SC.isIE())return-13;return 0;})();if(totalWidth-bodyMarginCompensation<boxWidth)totalWidth=boxWidth+bodyMarginCompensation;if(!SC.isIE()&&totalWidth<800)extraScrollBarComp=0;var numberPerLine=(totalWidth<boxWidth+bodyMarginCompensation)?1.01:Math.floor((totalWidth-bodyMarginCompensation)/boxWidth);var increment=(totalWidth-bodyMarginCompensation)/(numberPerLine);this._realImages=realImages;this.layoutInfo.cols=numberPerLine;this.layoutInfo.rows=Math.ceil(realImages.length/numberPerLine);this.layoutInfo.boxH=imageBoxHeight;var row;for(var i=0;i<realImages.length;i++){var column=i%numberPerLine;row=Math.ceil((i+1)/numberPerLine);if((!realImages[i].style.width)||(!realImages[i].style.height)){realImages[i].style.width="0px";realImages[i].style.height="0px";}
var canvasLComp=0;var canvasTComp=0;if(Gallery.useCanvas()){var aspect=realImages[i].can.realWidth/realImages[i].can.realInHeight;if(!aspect){var c=realImages[i].get('content');aspect=c.get("thumbImageWidth")/c.get('thumbImageHeight');}
var ww,hh;if(aspect>1){ww=imageScale;hh=imageScale/aspect;}else{hh=imageScale;ww=imageScale*aspect;}
canvasLComp=Math.abs(ww-boxWidth)/2-5;canvasTComp=Math.abs((hh)-boxWidth)-15;}
var titleLabel=realImages[i].outlet('titleLabel',false);if(titleLabel)titleLabel.style.visibility=(scale<=50)?"hidden":'visible';realImages[i].style.position="absolute";realImages[i].style.left=Math.round(extraLeftComp+bodyMarginCompensation/2+column*increment+.5*increment-visualImageBoxWidth/2+canvasLComp)+"px";realImages[i].style.top=Math.round(imageBoxHeight*(row-1)+imageExtraTopComp+canvasTComp)+"px";realImages[i].setStyle({visibility:"visible"});if(realImages[i].requestMe&&!realImages[i].loadee)realImages[i].requestMe(i);if(realImages[i].loadee)realImages[i].loadee.importance=i;if(realImages[i].reflectionLoadee)realImages[i].reflectionLoadee.importance=i;}
var heightAfterImages=imageExtraTopComp+row*imageBoxHeight;var footerTop=heightAfterImages+footerExtraTopComp;var childrenToSearch=$("gridView").parentNode.childNodes;var theLinks=new Array();var headerHeight=Gallery.workspace.get('showToolBar')?117:59;headerHeight+=Gallery.workspace.get('showPagination')?24:0;var footerTopSoFooterSticksAtBottom=totalHeight-headerHeight-desiredExtraScrollRoomAtBottomOfPage-54;if(footerTop+scrollBarActivationHeightComp<footerTopSoFooterSticksAtBottom){extraScrollBarComp=0;}
if(footerTop<footerTopSoFooterSticksAtBottom){footerTop=footerTopSoFooterSticksAtBottom;}
for(var i=0;i<childrenToSearch.length;i++)
if(childrenToSearch[i].hasClassName&&childrenToSearch[i].hasClassName("loginHelpLinks"))
theLinks[theLinks.length]=childrenToSearch[i];theLinks[0].style.position="absolute";theLinks[0].style.top=(footerTop)+"px";theLinks[0].style.left=null;theLinks[0].style.right="18px";theLinks[0].style.paddingBottom=desiredExtraScrollRoomAtBottomOfPage+"px";$("gridView").style.position="absolute";$("gridView").style.left=(extraScrollBarComp)+"px";},arrangedObjects:[],arrangedObjectsBinding:'Gallery.photosController.arrangedObjects',content:[],contentObserver:function(){if(this.gridView)this.gridView._lastObservedScale=null;var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),gridView:Gallery.GridView.extend({contentBinding:"*owner.content",selectionBinding:"Gallery.photosController.selection",scaleBinding:"Gallery.workspace.gridTab.scale",isVisibleBinding:Mac.Binding.Not("Gallery.adaptor.isLoading"),scaleTimeoutObject:null,lastScaleTime:0,scrollRunnerObserver:function(){this.runEveryScroll();}.observes('content'),_lastObservedScale:null,scaleObserver:function(){var scale=this.get('scale');if(scale==this._lastObservedScale)return;this._lastObservedScale=scale;var now=Math.floor(new Date());var time=now-this.lastScaleTime;var child=this.firstChild;var i=0;while(child){child=child.nextSibling;i++;}
var setTheTimeout=false;if(SC.isFireFox()&&SC.isMacOSX()){setTheTimeout=true;}
if(SC.isFireFox()&&SC.isWindows()){setTheTimeout=i>40;}
if(SC.isSafari3()&&SC.isMacOSX()){setTheTimeout=i>100;}
if(SC.isSafari()&&SC.isWindows()){setTheTimeout=i>40;}
if(SC.isSafari()&&!SC.isSafari3()){setTheTimeout=i>10;}
if(SC.isIE()){setTheTimeout=i>10;}
if(SC.isIE6()){setTheTimeout=true;}
if(time>0&&!SC.isIE6()){if(!setTheTimeout)this.scaleContents(scale);else setTimeout(this.scaleContents.bind(this),0);}
if(this.scaleTimeoutObject)clearTimeout(this.scaleTimeoutObject);this.scaleTimeoutObject=setTimeout(this.scaleContents.bind(this),500);}.observes('scale'),scaleContents:function(s){var child=this.firstChild;var scale=this.get('scale');while(child){if(child.set)child.set('scale',scale);child=child.nextSibling;}
try{this.owner.doGridViewLayout("contents scaled tight");}catch(e){setTimeout((function(){this.doGridViewLayout("contents scaled loose");}).bind(this.owner),0);}
setTimeout((function(){this.lastScaleTime=Math.floor(new Date());}).bind(this),0);}}).outletFor('#gridView'),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".helpLinkBtn?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),authRequiredView:Mac.View.extend({outlets:['authRequiredText','authRequiredLearnMoreBtn','dotmacGalleryButton','loginLinkBtn','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],authRequiredText:Mac.LabelView.extend({localize:true}).outletFor("#authRequiredText"),authRequiredLearnMoreBtn:Mac.ButtonView.extend({outlets:["authRequiredLearnMoreText"],authRequiredLearnMoreText:Mac.LabelView.extend({localize:true}).outletFor("#authRequiredLearnMoreText"),action:function(){var currentLoc=window.location;window.location=location.protocol+"//"+location.host+Gallery.homepath();if(currentLoc=window.location)
{setTimeout(this.relocate.bind(this),100);}},relocate:function()
{window.location=location.protocol+"//"+location.host+Gallery.homepath();}}).outletFor("#authRequiredLearnMoreBtn"),dotmacGalleryButton:Mac.ButtonView.extend({action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".helpLinkBtn?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),noSuchAlbumObserver:function(){if(Gallery.workspace.get("authRequired"))
{if(String.currentLanguage()=='German')
{this.addClassName("german");}
else
{this.removeClassName("german");}
this.removeClassName("hidden");$('workspace').set('isVisible',false);}}.observes('Gallery.workspace.authRequired')}).outletFor("#authRequiredView"),scale:125,minScale:50,maxScale:200});require('views/grid_view');Gallery.IndexImageView=Gallery.ImageView.extend({_defaultDim:160,_defaultDimMovie:180,_defaultHtMovie:100,_maxDim:360,__defaultindex:null,_defaultindex:function()
{if(this.__defaultindex==null)
{var content=this.get('content');if(!content.get('allPhotos'))
return;this.__defaultindex=(content)?content.get('allPhotos').get('records').indexOf(content.get("keyimage")):null;}
return this.__defaultindex||0;},_index:0,scale:70,emptyElement:'<div class="item" style="visibility:hidden;"><div class="imgMask"></div><div class="imgContainer"><img src="" class="primaryImage"><img src="" class="secondaryImage"></div><div class="metadata"><div class="title"></div><div class="unseenIcon"></div><div class="desc"></div></div></div>',outlets:['imgContainer','mask','metadata','mask','primaryImage','secondaryImage','scrubController','unseenIcon','descriptionDiv'],mask:'[0]',imgContainer:"[1]",primaryImage:"[1][0]",secondaryImage:"[1][1]",metadata:"[2]",titleLabel:Mac.View.outletFor('[2][0]'),unseenIcon:"[2][1]",descriptionDiv:"[2][2]",descriptionLabel:Mac.View.outletFor('[2][2]'),render:function()
{var content=this.get("content");if(!content)
return;$(this.mask);var authenticated=false;var numMovies=content.get('numMovies');var numPhotos=content.get('numPhotos');var isProtected=content.get('isProtected');var isPrivate=content.get('isPrivate');if(content.get("isVideo"))
{this.addClassName("movieItem");this.primaryImage.style.position="relative";if(!isProtected)
{var aspect=content.get("posterImageWidth")/content.get("posterImageHeight");var newHt=180/aspect;this.primaryImage.style.marginTop=-(newHt-100)/2+"px";}
this.setMovie(content);}
else
{if((numMovies+numPhotos)>0||isProtected)
{this.setImage(content,false);this.__defaultindex=null;}
else
this.set('isVisible',false);}
if(content.get("userHidden"))
this.set('isVisible',false);if(isProtected)
this.mask.addClassName('locked');if(isPrivate)
this.mask.addClassName('private');var title=(content.get("isVideo")&&!content.get("showTitle"))?'':(content.get("title")||'').escapeHTML();var titleLabel=this.outlet('titleLabel',title.length>0);if(titleLabel)
{titleLabel.set('asHTML',title);titleLabel.set('toolTip',title);}
this.renderDescription();this.fixMaskForIE6(content,authenticated,isProtected);},renderDescription:function()
{var content=this.get('content');this.renderBadging(content);var desc=this.getCountLabelText(content).escapeHTML();var descriptionLabel=this.outlet('descriptionLabel',desc.length>0);if(descriptionLabel)
descriptionLabel.set('asHTML',desc);},renderBadging:function()
{var content=this.get('content');if(content.get('isVisited')||content.get('isProtected'))
this.removeClassName("unseen");else
this.addClassName("unseen");},badgingObserver:function()
{this.renderBadging();}.observes('*content.visitDate','*content.redraw'),fixMaskForIE6:function(content,authenticated,locked)
{if(!SC.isIE6())return;var imgMaskReplacement=document.createElement("DIV");var movie=content.get('isVideo');var width=movie?182:162;var height=movie?102:162;var filename=movie?"movie_mask":"album_mask";if(authenticated)filename="album_mask_authenticated";if(locked)filename=movie?"movie_mask_locked":"album_mask_locked";imgMaskReplacement.style.cssText="position:absolute; left:-2px; top:0px; width:"+width+"px; height:"+height+"px; z-index:100; filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/g/images/gallery/"+filename+".png' sizingMethod='image'));";this.appendChild(imgMaskReplacement);this.mask.style.background="blue";this.mask.style.filter="alpha(opacity=0)";},getCountLabelText:function(content){if(!content)content=this.get('content');var countLabelText,videoCountText,photoCountText,photoCount,videoCount;if(content.get('isProtected')){countLabelText=' ';}else if(content.get('isVideo')&&content.get('showOnIndex')){var dur=content.get('videoDurationMedium')||content.get('videoDurationLarge')||content.get('videoDurationSmall')||content.get('videoDurationMobile')||0;dur=Math.round(dur);var min=Math.floor(dur/60);var hrs=Math.floor(min/60);min=min-hrs*60;var sec=dur%60;if(hrs>9){var hrsStr=hrs.toString()+':';}else if(hrs>0){hrsStr='0'+hrs.toString()+':';}else{hrsStr='';}
if(min>9){var minStr=min.toString()+':';}else if(min>0){minStr='0'+min.toString()+':';}else{minStr='00:';}
if(sec>9){var secStr=sec.toString();}else if(sec>0){secStr='0'+sec.toString();}else{secStr='00';}
countLabelText=hrsStr+minStr+secStr;if(countLabelText=='00:00'){countLabelText='';}}else{videoCount=content.get('numMovies');photoCount=content.get('numPhotos');if(videoCount==null)videoCount=0;if(photoCount==null)photoCount=0;if(videoCount!=0)
{if(videoCount==1)
{if(photoCount==0)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMovieText".loc();}
else if(photoCount==1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMovieText".loc();}
else if(photoCount>1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMovieText".loc(photoCount);}}
else
{if(photoCount==0)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMoviesText".loc(videoCount);}
else if(photoCount==1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMoviesText".loc(videoCount);}
else if(photoCount>1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMoviesText".loc(photoCount,videoCount);}}}
else if(videoCount==0)
{if(photoCount==0)
{countLabelText=" ";}
else if(photoCount==1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoNoMovieText".loc();}
else if(photoCount>1)
{countLabelText="_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosNoMovieText".loc(photoCount);}}}
return countLabelText;},_firstRender:true,albumObserver:function()
{var content=this.get('content');if(content&&content.didChangeFor('indexView','title','numPhotos','numMovies','accessLogin','keyImagePath','square'))
{if(this._firstRender)
{this._firstRender=false;return;}
this.render();if(content.didChangeFor('indexViewLayout','accessLogin'))
{Gallery.workspace.indexTab.doIndexLayout();}}}.observes('*content.title','*content.numPhotos','*content.numMovies','*content.accessLogin','*content.keyImagePath','*content.square'),renderScrubImage:function()
{var parent=this.get("content");if(!parent.get('allPhotos'))
return;var records=parent.get('allPhotos').get('records');var content=records[this._index];if(content&&!content.get('userHidden'))
this.setImage(content,true);},scrubVertRatio:function()
{var content=this.get("content");return(content.get("isVideo")?this._defaultHtMovie:this._defaultDim)/content.get("scrubSpriteFrameHeight");}.property(),scrubDisplayFrameWidth:function()
{var content=this.get("content");return(content.get("isVideo")?this._defaultDimMovie:this._defaultDim);}.property(),scrubDisplayFrameHeight:function()
{var content=this.get("content");return content.get("scrubSpriteFrameHeight")*this.scrubVertRatio();}.property("content"),renderScrubSprite:function(event)
{if(SC.isFireFox()&&SC.isWindows())return;var content=this.get("content");var frameIndex=0;var frameCount=content.get("scrubSpriteFrameCount");if(event)
{var offsetX=Event.pointerX(event)-Position.cumulativeOffset(this.primaryImage)[0]+1;var percent=Math.max(0,Math.min(1,(offsetX/this.get("scrubDisplayFrameWidth"))));frameIndex=Math.floor(frameCount*percent);}
else
{frameIndex=Math.max(0,Math.min(frameCount,content.get("scrubSpriteKeyFrameIndex")||0));}
if(frameIndex>=frameCount)frameIndex=frameCount-1;var scrubDisplayFrameHeight=this.get("scrubDisplayFrameHeight");var offsetY=frameIndex*this.get("scrubDisplayFrameHeight");var scrollElement=Gallery.workspace.indexTab.gridView.parentNode.parentNode;var before=scrollElement.scrollTop;if(this._isAlbumScrubSprite&&this._albumScrubSpriteLoaded==false)offsetY=0;this.primaryImage.style.top=0-(offsetY)+"px";var after=scrollElement.scrollTop;if(before!=after)
scrollElement.scrollTop=before;},setMovie:function(content)
{if(content)
{if(content.get("isProtected"))
{this.primaryImage.src='/g/images/gallery/movie_protected_bg.jpg';this.primaryImage.style.width=this._defaultDimMovie+"px";this.primaryImage.style.height=this._defaultHtMovie+"px";}
else if(content.get("hasScrubSprite"))
{if(!Gallery.enableImagePreload)
{this.primaryImage.onerror=function()
{Gallery.Checkpoint.endContentLoad(this.src);this.src='/g/images/gallery/spacer.gif';};this.primaryImage.onload=function()
{Gallery.Checkpoint.endContentLoad(this.src);this.owner.renderScrubSprite();};var spriteUrl=content.get('spriteUrl');Gallery.Checkpoint.startContentLoad(spriteUrl);this.primaryImage.src=spriteUrl;}
this.primaryImage.style.width=this.get("scrubDisplayFrameWidth")+"px";this.primaryImage.style.height=(content.get("scrubSpriteFrameCount")*content.get("scrubSpriteFrameHeight")*this.get("scrubVertRatio"))+"px";this.primaryImage.style.marginTop="0px";this.renderScrubSprite();}
else
{this.primaryImage.style.width=this._defaultDimMovie+"px";this.primaryImage.src=content.get("medium");}}},setImage:function(content,isScrubImage)
{if(content)
{if(content.get('isProtected'))
{this.primaryImage.src='/g/images/gallery/protected_bg.jpg';this.primaryImage.style.width=this._defaultDim+"px";this.primaryImage.style.height=this._defaultDim+"px";}
else if(content.get("hasScrubSprite"))
{this.primaryImage.src="/g/images/footer/spacer.gif";if(this._albumScrubSpriteLoaded)
this.primaryImage.src=content.get("spriteUrl");this.primaryImage.style.width=this.get("scrubDisplayFrameWidth")+"px";this._albumScrubSpriteDesiredHeight=(content.get("scrubSpriteFrameCount")*content.get("scrubSpriteFrameHeight")*this.get("scrubVertRatio"));this.primaryImage.style.height=this._albumScrubSpriteDesiredHeight+"px";this.primaryImage.style.marginTop="0px";this.renderScrubSprite();}
else if(!Gallery.enableImagePreload||isScrubImage)
{var src=content.get("square");if(src)
{this.primaryImage.onerror=function()
{Gallery.Checkpoint.endContentLoad(this.src);this.src='/g/images/gallery/spacer.gif';};this.primaryImage.onload=function()
{Gallery.Checkpoint.endContentLoad(this.src);};Gallery.Checkpoint.startContentLoad(src);this.primaryImage.src=src;}
var size=Gallery.IndexImageView._defaultDim;if(typeof(size)!=='undefined')
{this.primaryImage.style.width=size+'px';this.primaryImage.style.height=size+'px';}}}},lazyLoadImage:function(imgSrc,importance,isMovie,isAlbumWithScrubSprite)
{if(importance===undefined)importance=0;Gallery.Checkpoint.startContentLoad(imgSrc);this._isMovie=isMovie;this._isAlbumWithScrubSprite=isAlbumWithScrubSprite;this._albumScrubSpriteLoaded=false;this.loadee=ImageLoadee.create({url:imgSrc,forPrecache:true,importance:importance,overwritable:false,onerror:function()
{Gallery.Checkpoint.endContentLoad(this.loadee.url);this.primaryImage.src='/g/images/gallery/spacer.gif';}.bind(this),onload:function()
{Gallery.Checkpoint.endContentLoad(this.loadee.url);if(this._isMovie){this.primaryImage.src=this.loadee.url;this.renderScrubSprite();return;}
else if(this._isAlbumWithScrubSprite){this.keyImageCoverUpper=document.createElement('img');this.keyImageCoverUpper.style.cssText="width:160px; height:160px; position:absolute; left:-2px; top:0px; z-index:99;";this.keyImageCoverUpper.src=this.loadee.url;this.appendChild(this.keyImageCoverUpper);var content=this.get('content');var spriteUrl=content?(content.get('spriteUrl')):null;if(content){this.albumScrubSpriteLoadee=ImageLoadee.create({importance:this.loadee.importance-1000,url:spriteUrl,forPrecache:true,onerror:function(){return;}.bind(this),onload:function(){this._albumScrubSpriteLoaded=true;this.primaryImage.src=this.albumScrubSpriteLoadee.url;var done=function(){if(this.keyImageCoverUpper.parentNode)this.removeChild(this.keyImageCoverUpper);this.renderScrubSprite();}.bind(this);if(!SC.isIE())this.primaryImage.onload=done;else done();}.bind(this)}).enter(Gallery.indexLoadees);}}
else{this.primaryImage.src=this.loadee.url;}}.bind(this)}).enter(Gallery.indexLoadees);},didMouseOver:function(evt)
{var scroll=Gallery.workspace.indexTab.gridView.parentNode.parentNode.scrollTop;Gallery.workspace.indexTab.gridView.set("scroll",scroll);var titleLabel=this.outlet('titleLabel');var descriptionLabel=this.outlet('descriptionLabel');if([this.metadata,titleLabel,descriptionLabel,this.imgContainer,this.mask,this.unseenIcon].include(Event.element(evt)))
{titleLabel.addClassName("hover");descriptionLabel.addClassName("hover");}
if(this.content.get('isProtected')||!this.content.get('showOnIndex'))
return;if(this.content.get('hasScrubSprite'))
{if(Position.within(this.imgContainer,Event.pointerX(evt),Event.pointerY(evt)+scroll))
this.renderScrubSprite(evt);}
else if(this.content.get('allPhotos'))
{var offsetXY=Position.cumulativeOffset(this);var offsetX=offsetXY[0];var offsetY=offsetXY[1];if((Event.pointerX(evt)-offsetX+1)>0&&(Event.pointerX(evt)-offsetX+1)<=(this._defaultDim-3)&&(Event.pointerY(evt)-offsetY-1+scroll)>0&&(Event.pointerY(evt)-offsetY-1+scroll)<=(this._defaultDim-3))
{var indexX=Math.floor(((Event.pointerX(evt)-offsetX)/(this._defaultDim-2))*this.content.get('allPhotos').get('records').length);var renderThisIndex=true;try
{renderThisIndex=!this.content.get('allPhotos').get('records')[indexX].get('userHidden');}
catch(e)
{renderThisIndex=false;}
if((!(SC.isFireFox()&&SC.isMacOSX())||this._index!=indexX)&&renderThisIndex)
{this._index=indexX;this.renderScrubImage();}}
else
{if(!(SC.isFireFox()&&SC.isMacOSX())||this._index!=this._defaultindex())
{this._index=this._defaultindex();this.renderScrubImage();}}}},didMouseOut:function(){this.titleLabel.removeClassName("hover");this.descriptionLabel.removeClassName("hover");if(this.content.get('isProtected')||!this.content.get('showOnIndex'))
return;if(this.content.get('hasScrubSprite'))
this.renderScrubSprite();else
if(!(SC.isFireFox()&&SC.isMacOSX())||this._index!=this._defaultindex())
{this._index=this._defaultindex();this.renderScrubImage();}}});Gallery.IndexGridView=Gallery.GridView.extend({exampleView:Gallery.IndexImageView,exampleGroupView:Mac.View.extend({emptyElement:'<div class="divider"><div class="label albumsHeadline">LABEL</div><div class="items"></div><div class="clear"></div></div>',outlets:['labelView','itemView','divider'],divider:'.divider?',labelView:Mac.LabelView.extend({localize:true,formatter:function(groupType)
{var label;if(groupType==GROUP_SLIDES)
label='_VisitorExperience.IndexPage.Slides.Title';else
if(groupType==GROUP_MOVIES)
label='_VisitorExperience.IndexPage.Movies.Title';else
label='_VisitorExperience.IndexPage.Albums.Title';return label;}}).outletFor('div.label'),itemView:Mac.View.outletFor('div.items')}),groupBy:'groupType',actOnSelect:true,scroll:0,isVisibleObserver:function()
{setTimeout(this.scrollMe.bind(this),1);}.observes("isVisible"),scrollMe:function()
{var gv=Gallery.workspace.indexTab.gridView;if(gv.parentNode&&gv.parentNode.parentNode){gv.parentNode.parentNode.scrollTop=this.get('scroll');}},action:function(evt,el){var sel=this.get('selection');var target=Event.element(evt);if(el&&![el.titleLabel,el.descriptionLabel,el.imgContainer,el.mask].include(target))
{return;}
if(sel&&sel.length>0){var item=(sel.length==1)?sel[0]:null;if(el&&item&&!item.get('isVideo')&&!item.isProtected)
{try{el._index=el._defaultindex();el.renderScrubImage();}
catch(e){}}
var route=(item)?item.get('route'):null;var bgcolor=Gallery.workspace.colorPicker.get("selectedColor")||'black';if(route&&item.get('isVideo')){SC.Routes.set('location',{route:route});}else if(route){SC.Routes.set('location',{route:route,bgcolor:bgcolor,view:(Gallery.avoidGridfs()?'grid':'gridfs')});}else{if(item&&item.get('isVideo')){Gallery.detailView().showPhotos(sel[0],sel,null,false);}else{Gallery.workspace.set('nowShowing',(Gallery.avoidGridfs()?'grid':'gridfs'));}}}}});Gallery.IndexWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['indexLabel','gridView','sliderView','loadingView','dotmacGalleryButton','ownerLabel','loginLinkBtn','helpLinkBtn','privacyLinkBtn','tosLinkBtn'],init:function(){arguments.callee.base.call(this);Event.observe(window,'resize',this.indexResize.bind(this));},indexResize:function(){this.doIndexLayout();},doIndexLayout:function(){var indexView=$('indexView');var headerBar=$('headerBar');if(indexView==null||!indexView.get('isVisible')||headerBar==null){return;}
var gridLockMoviesWithAlbums=true;var totalWidth=Mac.View.windowWidth();var totalHeight=Mac.View.windowHeight();var boxWidth=197;var albumBoxHeight=221;var movieBoxHeight=160;var visualAlbumBoxWidth=160;var visualMovieBoxWidth=180;var albumExtraTopComp=0;var movieExtraTopComp=0;var slideExtraTopComp=0;var footerExtraTopComp=SC.isFireFox()?-10:-30;var dotMacGalleryButtonHeight=54;var dotMacGalleryButtonWidth=64;var dotMacGalleryButtonOffsetForIE=(SC.isIE())?-45:0;var desiredExtraScrollRoomAtBottomOfPage=SC.isFireFox()?30:10;var extraScrollBarComp=-15;var leftFromEdge=26;var rightFromEdge=46;var scrollBarActivationHeightComp=(function(){if(SC.isSafari())return-1;if(SC.isFireFox())return-2;if(SC.isIE())return-13;return 0;})();var alb=[];var sld=[];var mov=[];var albumGroup=null;var slideGroup=null;var movieGroup=null;for(var i=0,l=indexView.childNodes.length;i<l;i++)
{var nodes=indexView.childNodes[i].childNodes[1].childNodes;var content=nodes[0].get('content');var type=content.get('groupType');if(type==GROUP_ALBUMS)
{alb=nodes;albumGroup=indexView.childNodes[i];albumExtraTopComp=55;}
else
if(type==GROUP_SLIDES)
{sld=nodes;slideGroup=indexView.childNodes[i];slideExtraTopComp=55;}
else
if(type==GROUP_MOVIES)
{mov=nodes;movieGroup=indexView.childNodes[i];movieExtraTopComp=55;}}
var realAlb=[];var realSld=[];var realMov=[];for(var i=0,l=alb.length;i<l;i++){if(alb[i].style.display!="none")realAlb[realAlb.length]=alb[i];if(Gallery.enableImagePreload&&!alb[i].loadee)
{var content=alb[i].get('content');if((true||!content.get('hasScrubSprite'))&&!content.get('isProtected'))
{var src=content.get("square");if(alb[i].lazyLoadImage&&!alb[i].loadee)
alb[i].lazyLoadImage(src,alb.length-1-i,false,content.get('hasScrubSprite'));}}}
for(var i=0,l=sld.length;i<l;i++){if(sld[i].style.display!="none")realSld[realSld.length]=sld[i];if(Gallery.enableImagePreload&&!sld[i].loadee)
{var content=sld[i].get('content');if(content.get('hasScrubSprite')&&!content.get('isProtected'))
{var src=content.get('spriteUrl');if(sld[i].lazyLoadImage&&!sld[i].loadee)
sld[i].lazyLoadImage(src,(0-i),true,false);}}}
for(var i=0,l=mov.length;i<l;i++){if(mov[i].style.display!="none")realMov[realMov.length]=mov[i];if(Gallery.enableImagePreload&&!mov[i].loadee)
{var content=mov[i].get('content');if(content.get('hasScrubSprite')&&!content.get('isProtected'))
{var src=content.get('spriteUrl');if(mov[i].lazyLoadImage&&!mov[i].loadee)
mov[i].lazyLoadImage(src,(0-i),true,false);}}}
var numberAlbums=realAlb.length;var numberSlides=realSld.length;var numberMovies=realMov.length;var bodyMarginCompensation=leftFromEdge+rightFromEdge;var isSafari2=(SC.isSafari()&&!SC.isSafari3());if(totalWidth<820)totalWidth=820;if(totalWidth-bodyMarginCompensation<boxWidth){totalWidth=boxWidth+bodyMarginCompensation;}
var numberPerLine=Math.floor((totalWidth-bodyMarginCompensation)/boxWidth);if(numberPerLine<4)numberPerLine=4;var albumIncrement=(totalWidth-bodyMarginCompensation-numberPerLine*visualAlbumBoxWidth)/(numberPerLine-1)+visualAlbumBoxWidth;var slideIncrement=(totalWidth-bodyMarginCompensation-numberPerLine*visualMovieBoxWidth)/(numberPerLine-1)+visualMovieBoxWidth;var movieIncrement=(totalWidth-bodyMarginCompensation-numberPerLine*visualMovieBoxWidth)/(numberPerLine-1)+visualMovieBoxWidth;var albumGroupHeight=Math.ceil(numberAlbums/numberPerLine)*albumBoxHeight+albumExtraTopComp;var slideGroupHeight=Math.ceil(numberSlides/numberPerLine)*movieBoxHeight+slideExtraTopComp;var movieGroupHeight=Math.ceil(numberMovies/numberPerLine)*movieBoxHeight+movieExtraTopComp;var footerTop=albumGroupHeight+((numberMovies>0)?(movieExtraTopComp+Math.ceil(numberMovies/numberPerLine)*movieBoxHeight):0)+footerExtraTopComp;var footerTopSoFooterSticksAtBottom=totalHeight-headerBar.offsetHeight-dotMacGalleryButtonHeight-desiredExtraScrollRoomAtBottomOfPage-19;if(footerTop+scrollBarActivationHeightComp<footerTopSoFooterSticksAtBottom){extraScrollBarComp=0;}
if(footerTop<footerTopSoFooterSticksAtBottom){footerTop=footerTopSoFooterSticksAtBottom;}
if(extraScrollBarComp!=0){var availWidth=totalWidth+extraScrollBarComp;numberPerLine=Math.floor((availWidth-bodyMarginCompensation)/boxWidth);if(numberPerLine<4)numberPerLine=4;albumIncrement=(availWidth-bodyMarginCompensation-numberPerLine*visualAlbumBoxWidth)/(numberPerLine-1)+visualAlbumBoxWidth;slideIncrement=(availWidth-bodyMarginCompensation-numberPerLine*visualMovieBoxWidth)/(numberPerLine-1)+visualMovieBoxWidth;movieIncrement=(availWidth-bodyMarginCompensation-numberPerLine*visualMovieBoxWidth)/(numberPerLine-1)+visualMovieBoxWidth;albumGroupHeight=Math.ceil(numberAlbums/numberPerLine)*albumBoxHeight+albumExtraTopComp;slideGroupHeight=Math.ceil(numberSlides/numberPerLine)*movieBoxHeight+slideExtraTopComp;movieGroupHeight=Math.ceil(numberMovies/numberPerLine)*movieBoxHeight+movieExtraTopComp;var footerTop=albumGroupHeight+((numberMovies>0)?(movieExtraTopComp+Math.ceil(numberMovies/numberPerLine)*movieBoxHeight):0)+footerExtraTopComp;var footerTopSoFooterSticksAtBottom=totalHeight-headerBar.offsetHeight-dotMacGalleryButtonHeight-desiredExtraScrollRoomAtBottomOfPage-19;if(footerTop<footerTopSoFooterSticksAtBottom){footerTop=footerTopSoFooterSticksAtBottom;}}
if(gridLockMoviesWithAlbums)movieIncrement=albumIncrement;var noAlbums=true;if(realAlb.length!=0&&realAlb[0]&&!realAlb[0].hasClassName('movieItem'))
{noAlbums=false;}
var albumContainerLeftFromEdge=leftFromEdge;for(var i=0;i<realAlb.length;i++){var column=i%numberPerLine;var row=Math.ceil((i+1)/numberPerLine);realAlb[i].style.position="absolute";realAlb[i].style.left=Math.round(column*albumIncrement)+"px";realAlb[i].style.top=((noAlbums?movieBoxHeight:albumBoxHeight)*(row-1)+albumExtraTopComp)+"px";realAlb[i].style.visibility="visible";}
var slideContainerLeftFromEdge=leftFromEdge;for(var i=0;i<realSld.length;i++){var column=i%numberPerLine;var row=Math.ceil((i+1)/numberPerLine);realSld[i].style.position="absolute";realSld[i].style.left=Math.round(column*slideIncrement)+"px";realSld[i].style.top=(movieBoxHeight*(row-1)+slideExtraTopComp)+"px";realSld[i].style.visibility="visible";}
var movieContainerLeftFromEdge=leftFromEdge;for(var i=0;i<realMov.length;i++){var column=i%numberPerLine;var row=Math.ceil((i+1)/numberPerLine);realMov[i].style.position="absolute";realMov[i].style.left=Math.round(column*movieIncrement)+"px";realMov[i].style.top=(movieBoxHeight*(row-1)+movieExtraTopComp)+"px";realMov[i].style.visibility="visible";}
var childrenToSearch=indexView.parentNode.childNodes;var footerThenLinks=new Array();for(var i=0;i<childrenToSearch.length;i++){var el=childrenToSearch[i];if(el.hasClassName&&(el.hasClassName("indexFooter")||el.hasClassName("loginHelpLinks"))){footerThenLinks.push(childrenToSearch[i]);}}
footerThenLinks[0].setStyle({position:"absolute",visibility:"visible",top:(footerTop+dotMacGalleryButtonOffsetForIE)+"px",left:Math.floor(totalWidth/2-dotMacGalleryButtonWidth/2)+"px",height:(dotMacGalleryButtonHeight+desiredExtraScrollRoomAtBottomOfPage)+"px"});footerThenLinks[1].setStyle({position:"absolute",visibility:"visible",top:(footerTop+dotMacGalleryButtonHeight)+"px",left:null,right:"18px"});if(realAlb.length>0&&albumGroup!=null){albumGroup.style.position="absolute";albumGroup.style.left=(albumContainerLeftFromEdge)+"px";albumGroup.style.top="0px";albumGroup.style.width=Math.min(Mac.View.windowWidth()-leftFromEdge-(isSafari2?15:0),totalWidth-bodyMarginCompensation+extraScrollBarComp+(noAlbums?20:0))+"px";albumGroup.style.height=albumGroupHeight+"px";albumGroup.style.overflow="hidden";}
if(realSld.length>0&&slideGroup!=null){slideGroup.style.position="absolute";slideGroup.style.width=Math.min(Mac.View.windowWidth()-leftFromEdge-(isSafari2?15:0),totalWidth-bodyMarginCompensation+extraScrollBarComp+(gridLockMoviesWithAlbums?(visualMovieBoxWidth-visualAlbumBoxWidth):0))+"px";slideGroup.style.height=(footerTop-albumGroupHeight)+"px";slideGroup.style.left=(slideContainerLeftFromEdge)+"px";slideGroup.style.top=albumGroupHeight+"px";slideGroup.style.overflow="hidden";}
if(realSld.length==0&&slideGroup!=null)slideGroup.style.visibility="hidden";if(realMov.length>0&&movieGroup!=null){movieGroup.style.position="absolute";movieGroup.style.width=Math.min(Mac.View.windowWidth()-leftFromEdge-(isSafari2?15:0),totalWidth-bodyMarginCompensation+extraScrollBarComp+(gridLockMoviesWithAlbums?(visualMovieBoxWidth-visualAlbumBoxWidth):0))+"px";movieGroup.style.height=(footerTop-albumGroupHeight)+"px";movieGroup.style.left=(movieContainerLeftFromEdge)+"px";movieGroup.style.top=albumGroupHeight+slideGroupHeight+"px";movieGroup.style.overflow="hidden";}
if(realMov.length==0&&movieGroup!=null)movieGroup.style.visibility="hidden";if(!this.get('isLatestAlbumComputed'))
{var albums=Gallery.Album.findAll({});var latest=0;for(var i=0;i<albums.length;i++)
{var ms=new Date(albums[i].get('updated')||'').getTime();if(ms>latest)
latest=ms;}
$('lastUpdate').innerHTML=Gallery.getDateLabel(latest);this.set('isLatestAlbumComputed',true);}},arrangedObjects:[],arrangedObjectsBinding:'Gallery.indexController.arrangedObjects',content:[],contentObserver:function(){var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),gridView:Gallery.IndexGridView.extend({contentBinding:"*owner.content",selectionBinding:"Gallery.indexController.selection",loadingObserver:function(){var notLoading=!Gallery.adaptor.get('isLoading');var isShowing=!!(Gallery.workspace.indexTab.get('nowShowing'));this.set('isVisible',notLoading||isShowing);if(notLoading||isShowing)setTimeout(this.owner.doIndexLayout.bind(this.owner),1);}.observes('Gallery.adaptor.isLoading','Gallery.workspace.indexTab.nowShowing'),visibleAnimation:{hidden:'opacity: 0.0',visible:'opacity: 1.0',duration:200},animateVisible:true}).outletFor('#indexView'),sliderView:Mac.SliderView.extend({valueBinding:'Gallery.workspace.indexTab.scale',minimum:50,maximum:200,value:125}).outletFor("#indexSliderView"),dotmacGalleryButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.GalleryBranding.Tooltip",action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".helpLinkBtn?"),emptyGalleryView:Mac.View.extend({outlets:['emptyGalleryText','learnMoreBtn','dotmacGalleryButton','ownerLabel','loginLinkBtn','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],emptyGalleryText:Mac.LabelView.extend({localize:true}).outletFor("#emptyGalleryText"),learnMoreBtn:Mac.ButtonView.extend({outlets:["learnMoreText"],learnMoreText:Mac.LabelView.extend({localize:true}).outletFor("#learnMoreText"),action:function(){window.open("_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor("#learnMoreBtn"),dotmacGalleryButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.GalleryBranding.Tooltip",action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".helpLinkBtn?")}),emptyGalleryObserver:function(){if(Gallery.adaptor.get('emptyRecordSet')&&Gallery.workspace.indexTab.get('nowShowing')&&$('indexView').innerHTML.length==0){var view=this.emptyGalleryView.viewFor('emptyGalleryView');view.removeClassName("hidden");$('workspace').set('isVisible',false);}}.observes('Gallery.adaptor.emptyRecordSet','Gallery.workspace.indexTab.nowShowing'),noSuchAlbumView:Mac.View.extend({outlets:['noSuchAlbumText','noSuchAlbumlearnMoreBtn','dotmacGalleryButton','ownerLabel','loginLinkBtn','helpLinkBtn','privacyLinkBtn','tosLinkBtn'],noSuchAlbumText:Mac.LabelView.extend({localize:true}).outletFor("#noSuchAlbumText"),noSuchAlbumlearnMoreBtn:Mac.ButtonView.extend({outlets:["noSuchAlbumLearnMoreText"],noSuchAlbumLearnMoreText:Mac.LabelView.extend({localize:true}).outletFor("#noSuchAlbumLearnMoreText"),action:function(){var currentLoc=window.location;window.location=location.protocol+"//"+location.host+Gallery.homepath();if(currentLoc=window.location)
{setTimeout(this.relocate.bind(this),100);}},relocate:function()
{window.location=location.protocol+"//"+location.host+Gallery.homepath();}}).outletFor("#noSuchAlbumlearnMoreBtn"),dotmacGalleryButton:Mac.ButtonView.extend({action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".helpLinkBtn?")}),noSuchAlbumObserver:function(){if(Gallery.workspace.get("noSuchAlbum")){var noSuchAlbum=this.noSuchAlbumView.viewFor('noSuchAlbumView');noSuchAlbum.removeClassName("hidden");$('workspace').set('isVisible',false);}}.observes('Gallery.workspace.noSuchAlbum'),loadingView:Mac.View.extend({outlets:['Loading'],Loading:Mac.LabelView.extend({localize:true}).outletFor(".loadingText?"),isVisibleBinding:Mac.Binding.Flag('Gallery.adaptor.isLoading')}).outletFor("#loadingView")});require('views/image_view');Gallery.MosaicImageView=Gallery.ImageView.extend({scale:100,_defaultDim:80,_maxDim:160,emptyElement:'<div class="mosaicItem"'+((SC.isSafari()&&!SC.isSafari3())?'':' style="visibility:hidden;"')+'><img class="mosaicImg"></div>',outlets:["mosaicImg"],mosaicImg:".mosaicImg?",render:function(){var content=this.get("content");if(!content)return;this._oldScale=this.get('scale');var thisStyles=content.get("userHidden")?{height:this._defaultDim+"px",width:this._defaultDim+"px",display:"none"}:{height:this._defaultDim+"px",width:this._defaultDim+"px"};var thissrc=content.get("square");Gallery.Checkpoint.startContentLoad(thissrc);this.loadee=ImageLoadee.create({owner:this,url:thissrc,importance:Gallery.mosaicLoadees?Gallery.mosaicLoadees.pending.length:0,onload:function()
{Gallery.Checkpoint.endContentLoad(this.url);this.owner.mosaicImg.src=this.url;},onerror:this.missing.bind(this)}).enter(Gallery.mosaicLoadees);if(Gallery.cacheWebsInMosaic){this.webLoadee=ImageLoadee.create({url:content.get('web'),importance:Gallery.mosaicWebLoadees.pending.length,onload:function(){}}).enter(Gallery.mosaicWebLoadees);}
var color=Gallery.workspace.colorPicker.get('selectedColor')||"black";this.mosaicImg.src="/g/images/gallery/carouseljs/"+color+"loading.jpg";this.mosaicImg.observe('error',this.missing.bind(this));this.mosaicImg.observe('load',this.loaded.bind(this));Element.setStyle(this,thisStyles);},scaleObserver:function(){var scale=this.get('scale');if(this._oldScale!=scale)this.resizeMe(scale);this._oldScale=scale;}.observes("scale"),scaleMe:function(value){return(value*this.scale)/100;},missing:function(){this.mosaicImg.src='/g/images/gallery/spacer.gif';this.addClassName('missing');this.mosaicImg.stopObserving('error',this.missing.bind(this));this.mosaicImg.stopObserving('load',this.loaded.bind(this));},loaded:function(){this.mosaicImg.stopObserving('error',this.missing.bind(this));this.mosaicImg.stopObserving('load',this.loaded.bind(this));},didMouseOver:function(evt){this.addClassName('hover');},didMouseOut:function(){this.removeClassName('hover');},hitTest:function(evt){var target=Event.element(evt);var hits=[this,this.mosaicImg];return(hits.include(target)&&!this.classNames().include('missing'));},resizeMe:function(){var scale=this.get('scale');var defaultDim=Math.floor(this.scaleMe(this._defaultDim));var thisStyles={height:defaultDim+"px",width:defaultDim+"px"};Element.setStyle(this,thisStyles);}});Gallery.MosaicGridView=Mac.CollectionView.extend({exampleView:Gallery.MosaicImageView,scroll:0,scrollingObserver:function()
{if(Gallery.workspace.get('nowShowing')=="mosaic")
{setTimeout(this.scrollMe.bind(this),1);}}.observes("Gallery.workspace.nowShowing","Gallery.photosController.currentPage"),scrollMe:function()
{Gallery.workspace.mosaicTab.mosaicGrid.scrollTop=this.get("scroll");},action:function(evt){var sel=this.get('selection');if(sel&&sel.length>0&&sel.classNames&&!sel.classNames().include('missing')){Gallery.detailView().showPhotos(sel[0],(sel.length>1)?sel:Gallery.allPhotosController.get('records'));}},scaleTimeoutObject:null,lastScaleTime:0,scaleBinding:"Gallery.workspace.mosaicTab.scale",scaleObserver:function(){var now=Math.floor(new Date());var time=now-this.lastScaleTime;var child=this.firstChild;var i=0;while(child){child=child.nextSibling;i++;}
var setTheTimeout=false;if(SC.isFireFox()&&SC.isMacOSX()){setTheTimeout=true;}
if(SC.isFireFox()&&SC.isWindows()){setTheTimeout=i>40;}
if(SC.isSafari3()&&SC.isMacOSX()){setTheTimeout=i>100;}
if(SC.isSafari()&&SC.isWindows()){setTheTimeout=i>40;}
if(SC.isSafari()&&!SC.isSafari3()){setTheTimeout=i>10;}
if(SC.isIE()){setTheTimeout=i>10;}
if(SC.isIE6()){setTheTimeout=true;}
if(time>0&&!SC.isIE6()){if(!setTheTimeout)this.scaleContents();else
setTimeout(this.scaleContents.bind(this),0);}
if(this.scaleTimeoutObject)clearTimeout(this.scaleTimeoutObject);this.scaleTimeoutObject=setTimeout(this.scaleContents.bind(this),500);}.observes('scale'),scaleContents:function(){var child=this.firstChild;var scale=this.get('scale');while(child){if(child.set)child.set('scale',scale);child=child.nextSibling;}
if(!(SC.isSafari()&&!SC.isSafari3()))Gallery.workspace.mosaicTab.doMosaicViewLayout();setTimeout((function(){this.lastScaleTime=Math.floor(new Date());}).bind(this),0);},fixScale:function(){var child=this.firstChild;var scale=this.get('scale');while(child){if(child.set)child.set('scale',scale);child=child.nextSibling;}}});Gallery.MosaicWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['mosaicGrid','mosaicDetail'],paginationObserver:function(){if(SC.isSafari()&&!SC.isSafari3())Gallery.workspace.mosaicTab.mosaicDetail.setDimension();}.observes("Gallery.workspace.showPagination"),maxGridOccupationRatio:0.35,init:function(){arguments.callee.base.call(this);this.getReadyForDoingMosaicViewLayout();if(!(SC.isSafari()&&!SC.isSafari3()))Event.observe(window,'resize',this.mosaicViewBodyResize.bind(this));},mosaicViewBodyResize:function(){if(!(SC.isSafari()&&!SC.isSafari3()))this.doMosaicViewLayout("window resized");},enteringMosaicViewObserver:function(){var nowShowing=Gallery.workspace.get('nowShowing');var nowShowingDidChange=Gallery.workspace.didChangeFor('mosaic','nowShowing');var currentPageDidChange=Gallery.photosController.didChangeFor('mosaic','currentPage');if(!nowShowingDidChange&&!currentPageDidChange)return;if(!(SC.isSafari()&&!SC.isSafari3())){setTimeout("Gallery.workspace.mosaicTab.doMosaicViewLayout('entered mosaic');",0);if(!currentPageDidChange){Element.setOpacity(Gallery.workspace.mosaicTab.mosaicDetail,0);setTimeout("Element.setOpacity(Gallery.workspace.mosaicTab.mosaicDetail,1);",500);}}}.observes("Gallery.workspace.nowShowing",'Gallery.photosController.currentPage'),toolbarObserver:function(){if(Gallery.workspace.get('nowShowing')=="mosaic"){if(!(SC.isSafari()&&!SC.isSafari3()))setTimeout(this.doMosaicViewLayout.bind(this),0);}}.observes("Gallery.workspace.showToolBarBool"),detailShadowPointers:null,getReadyForDoingMosaicViewLayout:function(){if(!(SC.isSafari()&&!SC.isSafari3())){this.mosaicDetail.style.cssText="position:absolute; left:26px; top:19px; width:100%; height:100%; padding:0px; margin-top:0px; overflow:hidden;";this.mosaicDetail.mosaicDetailImg.style.zIndex=2;this.mosaicGrid.parentNode.style.cssText="position:absolute; right:0px; top:0px; padding-top:14px; padding-bottom:10px;";this.mosaicGrid.style.cssText="overflow: hidden; margin-top:0px; position:absolute; left:13px; margin-left:0px; margin-right:0px; top:0px; padding-top:14px; padding-bottom:10px; z-index:3;";this.mosaicDetail.movieBadge.style.position="absolute";this.mosaicDetail.movieBadge.style.zIndex=3;this.mosaicDetail.mosaicTitleLabel.style.zIndex=100;}
this.detailShadowPointers=$("mosaicDetailShadowTL","mosaicDetailShadowT","mosaicDetailShadowTR","mosaicDetailShadowRT","mosaicDetailShadowR","mosaicDetailShadowRB","mosaicDetailShadowBR","mosaicDetailShadowB","mosaicDetailShadowBL","mosaicDetailShadowLB","mosaicDetailShadowL","mosaicDetailShadowLT");if((SC.isSafari()&&!SC.isSafari3())||SC.isIE6()){for(var i=0;i<this.detailShadowPointers.length;i++){this.detailShadowPointers[i].parentNode.removeChild(this.detailShadowPointers[i]);}}},doMosaicViewLayout:function(reason){if(SC.isSafari()&&!SC.isSafari3())return;if(Gallery.workspace.get('nowShowing')!="mosaic")return;var totalWidth=Mac.View.windowWidth();var totalHeight=Mac.View.windowHeight();var usedHeight=125;if(Gallery.workspace.get("showToolBarBool"))usedHeight+=51;usedHeight+=Gallery.workspace.get("showPagination")?24:0;var availHeight=totalHeight-usedHeight;if(reason===undefined)reason="scale changed";var theGrid=this.mosaicGrid;var theGridContainer=this.mosaicGrid.parentNode;var images;try{images=theGrid.childNodes;}catch(e){return;}
var realImages=new Array();for(var i=0;i<images.length;i++)
if(images[i].style.display!="none"||images[i].tagName.toLowerCase()!="div")
realImages[realImages.length]=images[i];var numberPics=realImages.length;var gridHeight=availHeight;var scale=this.scale;var boxSize=Math.floor(scale*.8+10);var rows=Math.floor(gridHeight/boxSize);var columns=Math.ceil(numberPics/rows);var maxGridWidth=27+Math.floor((totalWidth*this.maxGridOccupationRatio)/boxSize)*boxSize;var desiredGridWidth=27+columns*boxSize;var gridWidth=desiredGridWidth;var gridTop;var rows=Math.ceil(numberPics/columns);var isSafari2=(SC.isSafari()&&!SC.isSafari3());if(desiredGridWidth>maxGridWidth){gridWidth=maxGridWidth;gridHeight=availHeight+3;gridTop=0;theGridContainer.style.overflowY="auto";theGridContainer.style.overflowX="hidden";theGridContainer.style.overflow="auto";if(isSafari2)theGrid.style.overflow="auto";}else{gridHeight=availHeight+3;gridTop=0;theGridContainer.scrollTop=0;theGridContainer.style.overflow="visible";theGridContainer.style.overflowY="visible";theGridContainer.style.overflowX="visible";if(isSafari2)theGrid.style.overflow="visible";}
columns=Math.min(Math.ceil(numberPics/rows),(gridWidth-27)/boxSize);rows=Math.ceil(numberPics/columns);columns=Math.min(Math.ceil(numberPics/rows),(gridWidth-27)/boxSize);gridWidth=27+columns*boxSize;var innerGridHeight=(rows)*boxSize;theGrid.style.width=Math.max(0,gridWidth-27)+"px";theGrid.style.height=Math.max(0,innerGridHeight)+"px";theGrid.style.top=gridTop+"px";theGridContainer.style.height=Math.max(0,gridHeight)+"px";theGridContainer.style.top=gridTop+"px";gridWidth+=8;if(gridHeight<innerGridHeight){gridWidth+=15;}
theGridContainer.style.width=Math.max(0,gridWidth-1)+"px";for(var i=0;i<realImages.length;i++){var thisRow=Math.ceil((i+1)/columns);var thisColumn=(i%columns)%columns;realImages[i].style.left=(boxSize*(thisColumn))+"px";realImages[i].style.top=(14+boxSize*(thisRow-1))+"px";realImages[i].style.position="absolute";realImages[i].style.visibility="visible";}
var containerWidth=Math.max(totalWidth,800)-gridWidth-29;var theBox=this.mosaicDetail;theBox.style.width=Math.max(0,containerWidth)+"px";theBox.style.height=Math.max(0,availHeight-7)+"px";theBox.style.top="19px";theBox.style.visibility="visible";if(isSafari2)theBox.style.overflow="hidden";else theBox.style.overflow="visible";var hasTitle=this.mosaicDetail&&this.mosaicDetail.get('content')&&this.mosaicDetail.get('content').get('showTitle');var boxHMargin=5;var boxVMargin=hasTitle?28:12;var detailContent=this.mosaicDetail.get("content");if(!detailContent)return;var w=detailContent.get("webImageWidth");var h=detailContent.get("webImageHeight");var a=w/h;var vertBound=a<(containerWidth-boxHMargin)/(availHeight-boxVMargin);var sizeFactor;sizeFactor=1;var theImage=this.mosaicDetail.mosaicDetailImg;theImage.style.position="absolute";if(vertBound){theImage.style.height=Math.floor(Math.max(48,(availHeight-boxVMargin)*sizeFactor))+"px";theImage.style.width=Math.floor(Math.max(71,(availHeight-boxVMargin)*sizeFactor*a))+"px";}else{theImage.style.width=Math.floor(Math.max(71,(containerWidth-boxHMargin)*sizeFactor))+"px";theImage.style.height=Math.floor(Math.max(48,(containerWidth-boxHMargin)*sizeFactor/a))+"px";}
w=parseInt(theImage.style.width,10);h=parseInt(theImage.style.height,10);var l=Math.floor(containerWidth/2-w/2);var t=0;theImage.style.left=Math.max(0,l)+"px";theImage.style.top=Math.max(0,t)+"px";if(!isSafari2&&!SC.isIE6()){this.detailShadowPointers[0].style.left=l-14+"px";this.detailShadowPointers[0].style.top=t-9+"px";this.detailShadowPointers[1].style.left=l+17+"px";this.detailShadowPointers[1].style.top=t-9+"px";this.detailShadowPointers[1].style.width=Math.max(0,w-17-14)+"px";this.detailShadowPointers[2].style.left=l+w-14+"px";this.detailShadowPointers[2].style.top=t-9+"px";this.detailShadowPointers[3].style.left=l+w+"px";this.detailShadowPointers[3].style.top=t+"px";this.detailShadowPointers[4].style.left=l+w+"px";this.detailShadowPointers[4].style.top=t+29+"px";this.detailShadowPointers[4].style.height=Math.max(0,h-29-19)+"px";this.detailShadowPointers[5].style.left=l+w+"px";this.detailShadowPointers[5].style.top=t+h-19+"px";this.detailShadowPointers[6].style.left=l+w-14+"px";this.detailShadowPointers[6].style.top=t+h+"px";this.detailShadowPointers[7].style.left=l+17+"px";this.detailShadowPointers[7].style.top=t+h+"px";this.detailShadowPointers[7].style.width=Math.max(0,w-14-17)+"px";this.detailShadowPointers[8].style.left=l-14+"px";this.detailShadowPointers[8].style.top=t+h+"px";this.detailShadowPointers[9].style.left=l-14+"px";this.detailShadowPointers[9].style.top=t+h-19+"px";this.detailShadowPointers[10].style.left=l-14+"px";this.detailShadowPointers[10].style.top=t+20+"px";this.detailShadowPointers[10].style.height=Math.max(0,h-20-19)+"px";this.detailShadowPointers[11].style.left=l-14+"px";this.detailShadowPointers[11].style.top=t+"px";}
var titleLabel=this.mosaicDetail.mosaicTitleLabel;titleLabel.style.position="absolute";titleLabel.style.width="100%";titleLabel.style.height="20px";titleLabel.style.left="0px";titleLabel.style.top=(t+h-3)+"px";var movieBadge=this.mosaicDetail.movieBadge;movieBadge.style.left=l+"px";movieBadge.style.top=(t+h)+"px";movieBadge.style.width=Math.max(0,w)+"px";if(reason!="window resized")
theGrid.fixScale();if(isSafari2){theGrid.style.display="block";theImage.style.display="block";theBox.style.display="block";}},arrangedObjects:[],arrangedObjectsBinding:'Gallery.photosController.arrangedObjects',content:[],_lastObjs:null,contentObserver:function(){var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),mosaicGrid:Gallery.MosaicGridView.extend({contentBinding:"*owner.content",selectionBinding:"Gallery.photosController.selection"}).outletFor('#mosaicGrid'),mosaicDetail:Gallery.ImageView.extend({outlets:['mosaicTitleLabel','movieBadge','duration','mosaicDetailImg'],contentBinding:"Gallery.photosController.selection",divWidthBinding:"Gallery.workspace.mosaicView.mosaicDetail.clientWidth",mosaicTitleLabel:Mac.LabelView.extend({}).outletFor('#mosaicTitleLabel'),movieBadge:"#mosaicMovieBadge",duration:".duration?",mosaicDetailImg:"#mosaicDetailImg",didMouseOver:function(){this.mosaicTitleLabel.addClassName('hover');},didMouseOut:function(){this.mosaicTitleLabel.removeClassName('hover');},isMovie:false,init:function(){arguments.callee.base.call(this);this._content=this.content;Event.observe(window,'resize',this.resizeHandler.bind(this));this.render();this.style.visibility="hidden";},observesEvents:true,hitTest:function(evt){var target=Event.element(evt);var hits=[this.mosaicDetailImg,this.mosaicTitleLabel];return hits.include(target);},didClick:function(evt){if(!this.hitTest(evt)||Math.floor(new Date())-Gallery.workspace._lastExitedDetailViewViaClickOnPhotoDate<500)return;var photo=this.get('content');var gridView=this.owner.mosaicGrid;var sel=gridView.get('selection');var photos;if(sel&&sel.length>1){var content=gridView.get('content')||[];photos=sel.sort(function(a,b){return content.indexOf(a)-content.indexOf(b);});}else photos=Gallery.allPhotosController.get('records');var elementInfo=null;if($('mosaicDetailImg')){var toolHeight=0;if(Gallery.workspace.get("showToolBarBool"))toolHeight=52;elementInfo={clientHeight:$('mosaicDetailImg').clientHeight,clientWidth:$('mosaicDetailImg').clientWidth,offsetTop:Position.cumulativeOffset($('mosaicDetailImg'))[1]-60,offsetLeft:Position.cumulativeOffset($('mosaicDetailImg'))[0]};}
if(photo){Gallery.detailView().set("scaling",true);Gallery.detailView().showPhotos(photo,photos,elementInfo,false);}},fadeInTheDetailImage:function(){if(Gallery.workspace.get('nowShowing')!='mosaic'){this.detailImageFading=false;if(!this.mosaicDetailImg)return;Element.setOpacity(this.mosaicDetailImg,1);return;}
now=Math.floor(new Date());var timeElapsed=now-this.lastDetailImageFadeFrame;this.lastDetailImageFadeFrame=now;if(timeElapsed>100)timeElasped=33;if(this.detailImageOpacity<1){this.detailImageFading=true;this.detailImageOpacity+=0.05*timeElapsed/15;}
else return;if(this.detailImageOpacity>=1){this.detailImageFading=false;this.detailImageOpacity=1;}
Element.setOpacity(this.mosaicDetailImg,this.detailImageOpacity);if(this.detailImageOpacity<1)setTimeout(this.fadeInTheDetailImage.bind(this),10);},detailImageOpacity:1,detailImageFading:false,lastDetailImageFadeFrame:0,render:function(){var content=this.get('content');var emptyValues=[null,Mac.Binding.NULL_PLACEHOLDER,Mac.Binding.MULTIPLE_PLACEHOLDER,Mac.Binding.EMPTY_PLACEHOLDER];if(!emptyValues.include(content)){var imgStyle={width:content.get("webImageWidth"),height:content.get("webImageHeight")};if(SC.isSafari()&&!SC.isSafari3())this.setDimension();this.mosaicDetailImg.style.visibility="hidden";this.mosaicDetailImg.onload=function(){Gallery.workspace.mosaicTab.mosaicDetail.mosaicDetailImg.style.visibility="visible";};if(content.get('web'))
{Element.setStyle(this.mosaicDetailImg,imgStyle);if(SC.isFireFox()&&!SC.isFireFox2()){Gallery.workspace.mosaicTab.mosaicDetail.mosaicDetailImg.src=content.get("web");}else{var myImgWebSize=document.createElement("img");myImgWebSize.onload=function(){Gallery.Checkpoint.endContentLoad(this.src);Gallery.workspace.mosaicTab.mosaicDetail.mosaicDetailImg.src=content.get("web");if(SC.isSafari3()&&Gallery.workspace.mosaicTab.mosaicDetail.offsetWidth*Gallery.workspace.mosaicTab.mosaicDetail.offsetHeight<900000){Gallery.workspace.mosaicTab.mosaicDetail.detailImageOpacity=0;Gallery.workspace.mosaicTab.mosaicDetail.lastDetailImageFadeFrame=Math.floor(new Date())-30;Gallery.workspace.mosaicTab.mosaicDetail.fadeInTheDetailImage();}};var webSrc=content.get("web");if(SC.isFireFox())
myImgWebSize.src="";var delay=(Gallery.workspace.get('nowShowing')!='mosaic')?500:1;setTimeout(function()
{Gallery.Checkpoint.startContentLoad(webSrc);myImgWebSize.src=webSrc;},delay);}
this.mosaicTitleLabel.set("content",content.get('showTitle')?content.get("title"):"");this.mosaicTitleLabel.style.visibility=content.get('showTitle')?"visible":"hidden";if(imgStyle.width){this.mosaicTitleLabel.style.width=imgStyle.width;}}
if(content.get("isVideo"))
{this.isMovie=true;this.movieBadge.style.width=imgStyle.width;var dur=content.get("videoDuration");this.movieBadge.style.visibility="visible";if(content.get("videoDuration")!==undefined&&content.get("videoDuration")!==null)
{var min=Math.floor(dur/60);var hrs=Math.floor(min/60);min=min-hrs*60;var sec=dur%60;var time=(hrs>0)?hrs+":":"";time+=min+":"+((sec>9)?"":"0")+sec;this.duration.innerHTML=time;}}else{this.movieBadge.style.visibility="hidden";}
if(!(SC.isSafari()&&!SC.isSafari3()))Gallery.workspace.mosaicTab.doMosaicViewLayout("photo changed");else this.resizeHandler();}},setDimension:function(){var content=this.get('content');var emptyValues=[null,Mac.Binding.NULL_PLACEHOLDER,Mac.Binding.MULTIPLE_PLACEHOLDER,Mac.Binding.EMPTY_PLACEHOLDER];if(!emptyValues.include(content)){var imageWidth=content.get("webImageWidth");var imageHeight=content.get("webImageHeight");var fullWidth=Math.floor((Mac.View.windowWidth()-100)*0.65);var fullHeight=Mac.View.windowHeight()-158-(Gallery.workspace.get("showToolBarBool")?52:0)-(Gallery.workspace.get("showPagination")?24:0)-(SC.isFireFox()?4:0);fullWidth=fullWidth>0?fullWidth:1;fullHeight=fullHeight>0?fullHeight:1;var goFullWidth=((fullWidth/fullHeight)<(imageWidth/imageHeight))?true:false;var computedHeight=(imageWidth>0)?Math.floor((imageHeight/imageWidth)*fullWidth):1;var computedWidth=(imageHeight>0)?Math.floor((imageWidth/imageHeight)*fullHeight):1;Gallery.workspace.mosaicTab.mosaicGrid.style.height=fullHeight+32+'px';if($('mosaiccontent'))$('mosaiccontent').style.height=fullHeight+60+'px';return{width:(goFullWidth?fullWidth:computedWidth)+"px",height:(goFullWidth?computedHeight:fullHeight)+"px"};}},resizeHandler:function(){if(!(SC.isSafari()&&!SC.isSafari3()))return;var imgStyle=this.setDimension();if(this.mosaicTitleLabel&&imgStyle)
{if(this.isMovie){this.movieBadge.style.width=imgStyle.width;}
this.mosaicTitleLabel.style.width=imgStyle.width;Element.setStyle(this.mosaicDetailImg,imgStyle);}}}).outletFor('#mosaicDetail'),scale:100,minScale:80,maxScale:120});Gallery.CarouselView=Mac.FlashView.extend({resourceURL:"/g/flash/carousel/carousel.swf?234124",width:"100%",height:"100%",version:"8",loadParameters:{quality:'high',bgcolor:'',wmode:"transparent"},loadVariables:{},loadAttributes:{quality:'high',bgcolor:'',wmode:"transparent"},albumRoute:null,albumRouteBinding:'Gallery.albumController.route',scroll:0,detailViewSupport:false,selectedpicURL:"nourl",updateSelection:function(theURL){if(theURL!=null){var photo=Gallery.Photo.findAll({url:theURL});if(photo!=null){Gallery.photosController.set('selection',photo);selectedpicURL=theURL;}}},initStartImage:function(){var movie=this.get('movie');if(movie){var url=this.getCurrentImage();movie.setStartImage(url);}},carouselData:function(){var thisGuid=Gallery.albumController.get('guid');var photos=Gallery.albumController.get('allPhotos').get('records');var data=[];if(photos){photos.each(function(photo){data.push({baseURL:photo.get('url'),imageurl:photo.get('web'),id:photo.get('guid'),mediumImageURL:photo.get('medium'),viewIdentifier:photo.get('viewIdentifier'),vidduration:photo.get('videoDuration'),userOrder:photo.get('userOrderIndex'),imgwidth:photo.get('webImageWidth'),imgheight:photo.get('webImageHeight')});});}
return data.sort(function(a,b){return a.userOrder-b.userOrder;});},sendMovieData:function(){var movie=this.get('movie');var data=this.carouselData();if(movie){movie.updateMovieData(data);}},openDetailView:function(theArgs){return;},getCurrentImage:function()
{return Gallery.selectedPhotoController.get('url');},getSupported:function()
{this.checkDetailViewSupport();var movie=this.get('movie');if(movie){movie.setSupported(this.detailViewSupport);}},checkDetailViewSupport:function()
{var info=this.getCapabilities();var isReno=info.os.indexOf("10.4.10")!=-1;var safariMac=(SC.isSafari()&&!this.isWindows());var safariReno=(SC.isSafari()&&isReno&&!SC.isSafari3());var ffReno=(SC.isFireFox()&&isReno);this.detailViewSupport=false;},getCapabilities:function()
{var flashInfo;var movie=this.get('movie');if(movie){flashInfo=movie.getFlashInfo();return flashInfo;}},isWindows:function()
{var useragent=navigator.userAgent.toLowerCase();return(useragent.indexOf('win')!=-1);},isVista:function()
{if(SC.isWindows())
{var useragent=navigator.userAgent.toLowerCase();return(useragent.indexOf('nt 6.0')!=-1);}
else
{return false;}},isSafariBeta:function(){if(SC.isSafari()){var vers=parseInt(navigator.appVersion.replace(/^.*?AppleWebKit\/(\d+).*?$/,'$1'),0);return(vers>420&&vers<525);}else return false;},backgroundColorObserver:function(){if(Gallery.workspace.colorPicker.didChangeFor('colorBGswitch','selectedColor')&&(SC.isWindows()&&this.isSafariBeta())||SC.isIE6()){var color=Gallery.workspace.colorPicker.get("selectedColor");if(color=="black"){this.loadAttributes.bgcolor="#000000";this.loadParameters.bgcolor="#000000";}else if(color=="white"){this.loadAttributes.bgcolor="#FFFFFF";this.loadParameters.bgcolor="#FFFFFF";}else if(color=="ltgrey"){this.loadAttributes.bgcolor="#d9d9d9";this.loadParameters.bgcolor="#d9d9d9";}else if(color=="dkgrey"){this.loadAttributes.bgcolor="#262626";this.loadParameters.bgcolor="#262626";}
var forceLoad=Math.floor(Math.random()*10000);this.resourceURL="/g/flash/carousel/carousel.swf?"+forceLoad;this.render();delete forceLoad;}}.observes('Gallery.workspace.colorPicker.selectedColor'),ieRefreshViewObserver:function()
{if(Gallery.workspace.didChangeFor('carousel','nowShowing'))
{if(SC.isIE()&&Gallery.workspace.get("nowShowing")!="carousel")
{this.innerHTML="";}}}.observes('Gallery.workspace.carouselTab.nowShowing'),init:function()
{if(SC.isWindows()&&(this.isSafariBeta()||SC.isIE6())){this.addClassName('wmodeWindow');}
arguments.callee.base.apply(this);},render:function()
{if(this.get('hasValidVersion')==false)
{this.flashNotAvailable();}
else
{if(SC.isIE())
{var forceLoad=Math.floor(Math.random()*10000);this.resourceURL="/g/flash/carousel/carousel.swf?"+forceLoad;}
arguments.callee.base.apply(this);if(Gallery.fullscreen){$("fullScreenCarousel").addClassName('fullscreen');$("fullScreenCarouselDiv").addClassName('fullscreen');$("fullScreenCarousel").title="_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip".loc();}
else{$("fullScreenCarousel").title="_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip".loc();}}},flashNotAvailable:function(){if(!SC.isIE()&&$("noFlashParent"))
{return;}
if(SC.isIE())
{$("carouselView").innerHTML="";}
var noFlashParentDiv=document.createElement("div");noFlashParentDiv.id="noFlashParent";var noFlashParentLeftDiv=document.createElement("div");noFlashParentLeftDiv.id="noFlashParentLeft";var noFlashParentRightDiv=document.createElement("div");noFlashParentRightDiv.id="noFlashParentRight";var noFlashDiv=document.createElement("div");noFlashDiv.id="noFlash";var noFlashGraphicImg=document.createElement("div");noFlashGraphicImg.id="noFlashGraphic";var noFlashUpperLbl=document.createElement("div");noFlashUpperLbl.id="noFlashUpper";var noFlashLowerLbl=document.createElement("div");noFlashLowerLbl.id="noFlashLower";if(String.currentLanguage()=="English")
{noFlashUpperLbl.innerHTML="_VisitorExperience.FlashError.UnableToView".loc();}
else if(String.currentLanguage()=="Japanese")
{noFlashUpperLbl.innerHTML='<span class="japanese">'+"_VisitorExperience.FlashError.UnableToView".loc()+'</span>';}
else
{noFlashUpperLbl.innerHTML='<span class="germanFrench">'+"_VisitorExperience.FlashError.UnableToView".loc()+'</span>';}
noFlashLowerLbl.innerHTML='<a href="'+"_VisitorExperience.FlashError.Href".loc()+'">'+"_VisitorExperience.FlashError.GetFlash Player".loc()+"</a>";noFlashGraphicImg.appendChild(noFlashUpperLbl);noFlashGraphicImg.appendChild(noFlashLowerLbl);noFlashDiv.appendChild(noFlashGraphicImg);noFlashParentDiv.appendChild(noFlashDiv);if(!SC.isIE6())
{noFlashParentDiv.appendChild(noFlashParentLeftDiv);noFlashParentDiv.appendChild(noFlashParentRightDiv);}
$("carouselView").appendChild(noFlashParentDiv);}});Gallery.CarouselWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['carousel','fullScreenCarousel'],arrangedObjects:[],arrangedObjectsBinding:'Gallery.photosController.arrangedObjects',content:[],contentObserver:function(){var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),fullScreenCarousel:Mac.ButtonView.extend({action:function(){if(Gallery.fullscreen)
{var photo=window.opener.Gallery.Photo.findAll({url:selectedpicURL});if(photo!=null){window.opener.Gallery.photosController.set('selection',photo);}
window.opener.SC.Routes.set('location',{route:window.opener.SC.Routes.get('location'),view:'carousel'});window.opener.Gallery.fullscreenOpen=false;setTimeout("window.close()",1);}
else
{Gallery.goFullscreen({},"carousel");SC.Routes.set('location',{route:SC.Routes.get('location'),view:'grid'});}}}).outletFor('#fullScreenCarousel'),carousel:Gallery.CarouselView.extend({selectionBinding:"Gallery.photosController.selection",contentBinding:"*owner.content",locked:true,lockedBinding:SC.Binding.Not('*owner.nowShowing')}).outletFor('#carouselView')});Gallery.CarouseljsView=Mac.View.extend({iFrame:null,iFrameVisible:false,iFrameReady:false,dataSenderTimeout:null,fsPopup:null,fsScrollCurrent:null,fsScrollTarget:null,fsScrollValuesAlreadyUsed:false,ifURL:null,fsURL:null,renderObserver:function(){this.resetAndImbueIFrame();}.observes("content"),init:function(){arguments.callee.base.call(this);this.iFrame=$("carouseljsframe");if(this.iFrame==null)return;setTimeout(this.resized.bind(this),0);Event.observe(window,'resize',this.resized.bind(this));Event.observe(window,'keypress',this.sendKeyPressToIFrame.bindAsEventListener(this));if(this.iFrame!=null){window.v=this;window.vi=this.iFrame;window.w=this.iFrame.contentWindow;window.f=frames['cjsif'];}
this.ifURL=Gallery.carouseljsURL;this.fsURL=Gallery.carouseljsURL+"?fullscreen";},renoResizeHackTimeout:null,renoResizeHack:function(){this.iFrame.style.width=Mac.View.windowWidth()-1+'px';setTimeout('Gallery.workspace.carouseljsTab.carouseljs.iFrame.style.width = Mac.View.windowWidth()+"px";',0);this.renoResizeHackTimeout=null;},resized:function(){if(!this.iFrame)return;var oldW=parseInt(this.iFrame.style.width,10);var oldH=parseInt(this.iFrame.style.height,10);this.iFrame.style.width=Mac.View.windowWidth()+'px';this.iFrame.style.height=Gallery.availableHeight()+"px";this.iFrame.style.left=(this.iFrameVisible==true?0:-10000)+"px";this.iFrame.style.top=(this.iFrameVisible==true?Gallery.headerHeight():-10000)+"px";setTimeout("if((x = Gallery.workspace.carouseljsTab.carouseljs.iFrame) && x.contentWindow && x.contentWindow.carouselBodyResized) x.contentWindow.carouselBodyResized();",0);if((SC.isSafari3()==true||SC.isSafari()==false)||(oldW!=Mac.View.windowWidth()))return;if(this.renoResizeHackTimeout)clearTimeout(this.renoResizeHackTimeout);this.renoResizeHackTimeout=setTimeout(this.renoResizeHack.bind(this),0);},selectedColorObserver:function(){var nowShowing=Gallery.workspace.get('nowShowing');if(this.iFrame&&this.iFrame.contentWindow&&this.iFrame.contentWindow.setColor&&nowShowing=="carouseljs"){this.iFrame.contentWindow.updateSelectionFromCurrentIndex();task="setColor('"+Gallery.workspace.colorPicker.get('selectedColor')+"');window.colorTimeout = null;";if(this.iFrame.contentWindow.colorTimeout){this.iFrame.contentWindow.colorTimeout.task=task;}else{this.iFrame.contentWindow.colorTimeout=this.iFrame.contentWindow.F.setTimeout(task,1);}}}.observes('Gallery.workspace.colorPicker.selectedColor'),toolbarResizeObserver:function(){if(!Gallery.workspace.showToolBar()){if(SC.isIE7()){try{this.resized();}catch(e){}}
setTimeout(this.resized.bind(this),300);}
else{setTimeout(this.resized.bind(this),0);}}.observes('Gallery.workspace.showToolBar'),lastNowShowing:"",enterCarouselObserver:function(){try{var nowShowing=Gallery.workspace.get('nowShowing');if(nowShowing=="carouseljs"&&this.lastNowShowing!="carouseljs"){if(!this.iFrame.contentWindow)return;if(this.iFrame.contentWindow.F){this.iFrame.contentWindow.F.resume();this.iFrame.contentWindow.F.lastFrameDate=Math.floor(new Date());}
setTimeout(this.iFrameShowingObserver.bind(this),100);if(SC.isFireFox()&&SC.isWindows())setTimeout(function(){var it=Gallery.workspace.carouseljsTab.carouseljs.iFrame;it.style.height=parseInt(it.style.height,10)+1+"px";setTimeout(function(){var it=Gallery.workspace.carouseljsTab.carouseljs.iFrame;it.style.height=parseInt(it.style.height,10)-1+"px";},0);},0);}else if(nowShowing=="carouseljs"&&this.lastNowShowing=="carouseljs"){}else if(nowShowing!="carouseljs"&&this.lastNowShowing=="carouseljs"){this.iFrame.contentWindow.updateSelectionFromCurrentIndex();this.iFrame.contentWindow.F.pause();this.hideIFrame();}
this.lastNowShowing=nowShowing;}catch(e){}}.observes("Gallery.workspace.nowShowing"),showIFrame:function(){this.iFrameVisible=true;this.iFrame.style.visibility="visible";Event.observe(document,"mousemove",this.mouseMoved);if(this.iFrame&&(x=this.iFrame.contentWindow)&&x.scrollToSelection&&x.F&&x.F){this.iFrame.contentWindow.scrollToSelection();this.iFrame.contentWindow.F.resume();this.iFrame.contentWindow.F.lastFrameDate=Math.floor(new Date());}
this.resized();},hideIFrame:function(){this.iFrameVisible=false;this.iFrame.style.visibility="hidden";Event.stopObserving(document,"mousemove",this.mouseMoved);if(this.iFrame&&this.iFrame.contentWindow&&this.iFrame.contentWindow.F){this.iFrame.contentWindow.F.pause();this.iFrame.contentWindow.temporarilyAndQuicklyHideHud();}
this.resized();},iFrameShowingObserver:function(){var visible=this.get('isVisible')==true&&(!Gallery.workspace.detailView||Gallery.workspace.detailView.get('isVisible')==false)&&Gallery.workspace.get('nowShowing')=='carouseljs'&&Gallery.workspace.get('noSuchAlbum')!=true&&Gallery.workspace.get('isVisible')==true;if(visible==true&&!this.iFrameVisible)this.showIFrame();if(visible==false)this.hideIFrame();}.observes('Gallery.workspace.nowShowing','isVisible','Gallery.workspace.detailView.isVisible','Gallery.workspace.noSuchAlbum','Gallery.workspace.isVisible'),resetAndImbueIFrame:function(){this.iFrame.style.visibility="hidden";if(!(SC.isSafari()&&!SC.isSafari3())){var newURL=this.ifURL+"#account="+Gallery.accountName+"&album="+this.get('albumNumber');if(this.iFrameReady!=true)this.iFrame.src=newURL;else this.iFrame.contentWindow.location=newURL;}else{if(this.iFrame.src!=this.ifURL)this.iFrame.src=this.ifURL;}
this.dataSenderTimeout=null;if(!this.iFrame.contentWindow.clearView)this.iFrameReady=false;this.sendWhenIFrameReady();},sendWhenIFrameReady:function(){if(this.dataSenderTimeout)clearTimeout(this.dataSenderTimeout);this.dataSenderTimeout=null;if(this.iFrameReady){this.sendImageData(this.iFrame.contentWindow);this.iFrame.style.visibility="visible";}
else{this.dataSenderTimeout=setTimeout(this.sendWhenIFrameReady.bind(this),50);}},makePopup:function(){if(this.fsPopup!=null)this.closePopup();var w=window.open(this.fsURL+"#account="+Gallery.accountName+"&album="+this.get('albumNumber'),null,'status=0,resize=0,toolbar=0,location=0,menubar=0, directories=0,scrollbars=0,width='+screen.availWidth+',height='+(screen.availHeight-21)+',left=0,right=0,top=0,screenX=0,screenY=0,fullscreen=1');if(SC.isIE())setTimeout(function(){try{Gallery.workspace.carouseljsTab.carouseljs.fsPopup.focus();}catch(e){}},0);this.fsPopup=w;},fsLoaded:function(){var thisView=Gallery.workspace.carouseljsTab.carouseljs;thisView.sendImageData(this.fsPopup);thisView.iFrame.contentWindow.F.pause();thisView.fsScrollValuesAlreadyUsed=false;setTimeout(thisView.checkForPopupClosure.bind(thisView),50);},sendImageData:function(it,fsTryCount){var content=this.owner.content;if(it!=this.fsPopup)try{it.clearView();}catch(e){return;}
else{try{it.clearView();}
catch(e){if(!fsTryCount)fsTryCount=0;if(fsTryCount<10)setTimeout(function(){Gallery.workspace.carouseljsTab.carouseljs.sendImageData(it,fsTryCount+1);},50);else this.closePopup();return;}}
it.numberPics=content.length;for(var i=0;i<it.numberPics;i++){it.photoObjects[i]=content[content.length-i-1];it.imageURLs[i]=content[content.length-i-1].get("medium");it.bigURLs[i]=content[content.length-i-1].get("web");it.imageWs[i]=content[content.length-i-1].get("thumbImageWidth");it.imageHs[i]=content[content.length-i-1].get('thumbImageHeight');it.downloadURLs[i]=content[content.length-i-1].get("downloadPath");}
it.setColor(Gallery.workspace.colorPicker.get('selectedColor'));it.normalizeHeights();it.fsbTT="_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip".loc();it.fsbfsTT="_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip".loc();it.spbTT="_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip".loc();it.contentReceived=true;it.document.title=document.title;Event.observe(it,'keypress',it.docKeyPress);it.showProgressWhenReady=Gallery.showCarouselProgress;},checkForPopupClosure:function(){var popupExists=true;try{popupExists=(this.fsPopup&&this.fsPopup.F!=null);}catch(e){popupExists=false;}
if(popupExists){setTimeout(this.checkForPopupClosure.bind(this),50);return;}
this.setScrollValuesInMainToThoseFromFullscreen();this.cleanUpFromPopup();},closePopup:function(){if(this.fsPopup&&this.fsPopup.close)this.fsPopup.close();this.setScrollValuesInMainToThoseFromFullscreen();this.cleanUpFromPopup();},setScrollValuesInMainToThoseFromFullscreen:function(){if(this.fsScrollValuesAlreadyUsed==true)return;var c=this.fsScrollCurrent;var t=this.fsScrollTarget;if(c===null||t===null)return;try{this.iFrame.contentWindow.simpleTracker.frackers[0].t=t;this.iFrame.contentWindow.simpleTracker.frackers[0].c=c;this.iFrame.contentWindow.F.resume();this.iFrame.contentWindow.F.lastFrameDate=this.iFrame.contentWindow.F.now();}catch(e){}
this.fsScrollValuesAlreadyUsed=true;},cleanUpFromPopup:function(){this.fsPopup=null;this.fsDataSenderTimeout=null;this.fsScrollCurrent=null;this.fsScrollTarget=null;},sendKeyPressToIFrame:function(e){if(this.iFrameVisible==false)return;try{this.iFrame.contentWindow.docKeyPress(e);}catch(e){}},mouseMoved:function(e){try{Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow.lastHudWorthyInteractionDate=Math.floor(new Date());}catch(er){}},albumNumber:function(){var l=window.location+"";var end=l.indexOf('&',l.indexOf('#')+1);return parseInt(l.substring(l.indexOf('#')+1,end!=-1?end:l.length),10);}.property()});Gallery.CarouseljsWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['carouseljs'],arrangedObjects:[],arrangedObjectsBinding:'Gallery.allPhotosController.arrangedObjects',content:[],contentObserver:function(){var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),carouseljs:Gallery.CarouseljsView.extend({selectionBinding:"Gallery.photosController.selection",contentBinding:"*owner.content",locked:true,lockedBinding:SC.Binding.Not('*owner.nowShowing')}).outletFor('#carouseljsView')});Gallery.GridfsView=Mac.View.extend({iFrame:null,iFrameVisible:false,iFrameReady:false,dataSenderTimeout:null,bridge:null,slider:null,ifURL:null,renderObserver:function(){this.resetAndImbueIFrame();}.observes("content"),_lastScale:Gallery.gridScale==undefined?200:Gallery.gridScale,init:function(){arguments.callee.base.call(this);this.iFrame=$("gridfsframe");if(this.iFrame==null)return;setTimeout(this.resized.bind(this),0);Event.observe(window,'resize',this.resized.bind(this));Event.observe(window,'keypress',this.sendKeyPressToIFrame.bindAsEventListener(this));if(this.iFrame!=null){window.gfs=this;window.gfsi=this.iFrame;}
this.ifURL=Gallery.gridfsURL;},setUpBridge:function(){if(this.bridge)return;this.bridge=this.iFrame.contentWindow.FS.WindowBridge.create({window:window,name:"to Gallery"});Event.observe(document,'mousemove',this.bridge.mouseMoveFun.go);Event.observe(document,'mouseout',this.bridge.mouseOutFun.go);Event.observe(document,'mousedown',this.bridge.mouseDownFun.go);Event.observe(document,'mouseup',this.bridge.mouseUpFun.go);Event.observe(window,'resize',this.bridge.resizeFun.go);},resized:function(){if(!this.iFrame)return;var oldW=parseInt(this.iFrame.style.width,10);var oldH=parseInt(this.iFrame.style.height,10);if(this.iFrame.style.width!=Mac.View.windowWidth()+'px')this.iFrame.style.width=Mac.View.windowWidth()+'px';if(this.iFrame.style.height!=Gallery.availableHeight()+"px")this.iFrame.style.height=Gallery.availableHeight()+"px";if(this.iFrame.style.left!=(this.iFrameVisible==true?0:-10000)+"px")this.iFrame.style.left=(this.iFrameVisible==true?0:-10000)+"px";if(this.iFrame.style.top!=(this.iFrameVisible==true?Gallery.headerHeight():-10000)+"px")this.iFrame.style.top=(this.iFrameVisible==true?Gallery.headerHeight():-10000)+"px";},toolbarResizeObserver:function(){if(!Gallery.workspace.showToolBar()){if(SC.isIE7()){try{this.resized();}catch(e){}}
setTimeout(this.resized.bind(this),300);}
else{setTimeout(this.resized.bind(this),0);}}.observes('Gallery.workspace.showToolBar'),lastNowShowing:"",enterGridObserver:function(){try{var nowShowing=Gallery.workspace.get('nowShowing');if(nowShowing=="gridfs"&&this.lastNowShowing!="gridfs"){if(!this.iFrame.contentWindow)return;if(this.iFrame.contentWindow.FS){this.iFrame.contentWindow.FS.resume();this.iFrame.contentWindow.FS.nextTime=0;}
setTimeout(this.iFrameShowingObserver.bind(this),100);if(SC.isFireFox()&&SC.isWindows())setTimeout(function(){var it=Gallery.workspace.gridfsTab.gridfs.iFrame;it.style.height=parseInt(it.style.height,10)+1+"px";setTimeout(function(){var it=Gallery.workspace.gridfsTab.gridfs.iFrame;it.style.height=parseInt(it.style.height,10)-1+"px";},0);},0);}else if(nowShowing=="gridfs"&&this.lastNowShowing=="gridfs"){}else if(nowShowing!="gridfs"&&this.lastNowShowing=="gridfs"){this.hideIFrame();}
this.lastNowShowing=nowShowing;}catch(e){}}.observes("Gallery.workspace.nowShowing"),showIFrame:function(){this.iFrameVisible=true;if(!this.iFrame)return;this.iFrame.style.visibility="visible";if(this.iFrame&&(x=this.iFrame.contentWindow)&&x.FS){this.iFrame.contentWindow.FS.resume();this.iFrame.contentWindow.FS.nextTime=0;if(this.slider&&!this.slider.parentNode){document.body.appendChild(this.slider);}}
this.fixGallerySliderVisibility();this.resized();},hideIFrame:function(){this.iFrameVisible=false;if(!this.iFrame)return;this.iFrame.style.visibility="hidden";if(this.iFrame&&this.iFrame.contentWindow&&this.iFrame.contentWindow.FS)
this.iFrame.contentWindow.FS.pause();if(this.slider&&this.slider.parentNode){Element.remove(this.slider);}
this.fixGallerySliderVisibility();this.resized();},iFrameShowingObserver:function(){if(Gallery.avoidGridfs())return;var visible=this.get('isVisible')==true&&(!Gallery.workspace.detailView||Gallery.workspace.detailView.get('isVisible')==false)&&Gallery.workspace.get('nowShowing')=='gridfs'&&Gallery.workspace.get('noSuchAlbum')!=true&&Gallery.workspace.get('isVisible')==true;if(visible==true)this.showIFrame();if(visible==false)this.hideIFrame();}.observes('Gallery.workspace.nowShowing','isVisible','Gallery.workspace.detailView.isVisible','Gallery.workspace.noSuchAlbum','Gallery.workspace.isVisible'),fixGallerySliderVisibility:function(){var h=$('resizerSliderHandle');if(!h)return;var gridfsSliderOn=this.slider&&this.slider.style.display!="none"&&this.slider.parentNode&&this.slider.visibility!="hidden";h.style.display=gridfsSliderOn?"none":"";var s=$("resizerSliderSmallerButton"),l=$("resizerSliderLargerButton");if(!s||!l)return;if(gridfsSliderOn){s.onmouseup=this.scaleDown.bind(this);l.onmouseup=this.scaleUp.bind(this);}else{s.onmouseup=null;l.onmouseup=null;}},resetAndImbueIFrame:function(){this.iFrame.style.visibility="hidden";this.iFrame.src=this.ifURL+"#account="+Gallery.accountName+"&album="+this.get('albumNumber');this.dataSenderTimeout=null;if(!this.iFrame.contentWindow.FS)this.iFrameReady=false;this.sendWhenIFrameReady();},sendWhenIFrameReady:function(){if(this.dataSenderTimeout)clearTimeout(this.dataSenderTimeout);this.dataSenderTimeout=null;if(this.iFrameReady){this.sendImageData(this.iFrame.contentWindow);this.iFrame.style.visibility="visible";}
else{this.dataSenderTimeout=setTimeout(this.sendWhenIFrameReady.bind(this),50);}},sendImageData:function(it,fsTryCount){if(this.slider){if(this.slider.parentNode)Element.remove(this.slider);this.slider=null;}
var content=this.owner.content;it.photos=[];for(var i=0;i<content.length;i++){it.photos[i]={lo:content[i].get(Gallery.gridImageSize),lolo:content[i].get('small'),ref:content[i].get("smallReflection"),mask:"/g/images/gallery/reflections/grid_black.png",hi:content[i].get('web'),down:content[i].get('down'),w:content[i].get('thumbImageWidth'),h:content[i].get('thumbImageHeight'),title:(content[i].get("showTitle")?content[i].get("title").escapeHTML():null)};}
it.document.title=document.title;it.useTracking=Gallery.useGridFSTracking;it.FS.prefs.maxFPS=Gallery.gridFSFPS;it.noCanvas=it.noCanvas||!Gallery.useGridFSCanvases;it.loaderThreadCount=Gallery.gridFSThreadCount;it.loaderThreadDelay=Gallery.gridFSThreadDelay;it.defaultScale=this._lastScale;it.setColor(Gallery.bgColors[Gallery.workspace.colorPicker.get('selectedColor')]);it.document.onkeypress=it.docKeyPress;Event.observe(it,'keypress',it.docKeyPress);it.goWithInfo();},sendKeyPressToIFrame:function(e){if(this.iFrameVisible==false)return;try{this.iFrame.contentWindow.docKeyPress(e);}catch(e){}},scaleDown:function(){if(this.iFrame&&this.iFrame.contentWindow&&this.iFrame.contentWindow.grid)this.iFrame.contentWindow.grid.animateScaleTo(0);},scaleUp:function(){if(this.iFrame&&this.iFrame.contentWindow&&this.iFrame.contentWindow.grid)this.iFrame.contentWindow.grid.animateScaleTo(10000);},selectedColorObserver:function(){if(this.iFrame&&(x=this.iFrame.contentWindow)&&x.setColor)this.iFrame.contentWindow.setColor(Gallery.bgColors[Gallery.workspace.colorPicker.get('selectedColor')]);}.observes('Gallery.workspace.colorPicker.selectedColor'),albumNumber:function(){var l=window.location+"";var end=l.indexOf('&',l.indexOf('#')+1);return parseInt(l.substring(l.indexOf('#')+1,end!=-1?end:l.length),10);}.property()});Gallery.GridfsWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['gridfs'],arrangedObjects:[],arrangedObjectsBinding:'Gallery.allPhotosController.arrangedObjects',content:[],contentObserver:function(){var isShowing=this.get('nowShowing')!=null;var objs=this.get('arrangedObjects');if(isShowing&&objs&&objs.length>0)this.set('content',objs);}.observes('nowShowing','arrangedObjects'),gridfs:Gallery.GridfsView.extend({selectionBinding:"Gallery.photosController.selection",contentBinding:"*owner.content",locked:true,lockedBinding:SC.Binding.Not('*owner.nowShowing')}).outletFor('#gridfsView')});Gallery.SlideshowView=Mac.View.extend({outlets:['slideshowImageView','slideshowHoverViewMenu'],photos:null,prevphoto:null,nextphoto:null,current:null,nextPhotoTimer:null,isSlideshowHoverViewMenuOn:false,slideshowImageView:Gallery.ImageView.extend({contentBinding:Mac.Binding.From("*owner.current"),outlets:['slideshowImageDetail','slideshowImageReflection','slideshowReflectionContainer','_detailTemp','slideshowReflectionMask'],slideshowImageDetail:Mac.View.extend({didClick:function(){if(this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.className.indexOf('pause_slideshow')>=0){if(this.owner.owner.nextPhotoTimer){clearTimeout(this.owner.owner.nextPhotoTimer);this.owner.owner.set('nextPhotoTimer',null);}
this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.removeClassName("pause_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.addClassName("play_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip".loc());}else{this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.removeClassName("play_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.addClassName("pause_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip".loc());this.owner.setTimeoutForNextSlide();}
return;var toolHeight=0;if(Gallery.workspace.get("showToolBarBool"))toolHeight=Gallery.workspace.toolBar.getHeight();var photo=this.owner.get('content');var photos=photo.get('album').get('photos').get('records')||[];var elementInfo=null;if($('slideshow_img_detail')){elementInfo={clientHeight:this.clientHeight,clientWidth:this.clientWidth,offsetTop:this.offsetTop+toolHeight,offsetLeft:this.offsetLeft};}
if(photo){Gallery.detailView().set("scaling",true);Gallery.detailView().showPhotos(photo,photos,elementInfo,false);}}}).outletFor("#slideshow_img_detail"),_detailTemp:Mac.View.extend({didClick:function(){if(this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.className.indexOf('pause_slideshow')>=0){if(this.owner.owner.nextPhotoTimer){clearTimeout(this.owner.owner.nextPhotoTimer);this.owner.owner.set('nextPhotoTimer',null);}
this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.removeClassName("pause_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.addClassName("play_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip".loc());}else{this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.removeClassName("play_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.addClassName("pause_slideshow");this.owner.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip".loc());this.owner.setTimeoutForNextSlide();}
return;}}).outletFor("#slideshow_img_detailTemp"),slideshowImageReflection:Mac.View.outletFor("#slideshow_img_reflection"),slideshowReflectionContainer:Mac.View.outletFor(".reflectionContainer?"),slideshowReflectionMask:"reflectionMask",canShowNextSlide:false,_reflectionTemp:new Image(),_imgStyle:{},firstSlide:true,newImage:null,oldImage:null,init:function(){arguments.callee.base.call(this);this.oldImage=this._detailTemp;this.newImage=this.slideshowImageDetail;Event.observe(window,'resize',this.resizeHandler.bind(this));},fixIE6SlideshowReflection:function(){if(SC.isIE6()){var it=$("slideshowImageView").getElementsByClassName("reflectionMask")[0];it.style.background="transparent";it.style.overflow="hidden";it.style.width="3000px";var itsKid=document.createElement("div");itsKid.style.width="1000px";itsKid.style.height="150px";itsKid.style.position="absolute";itsKid.id="slideshowReflectionPNGIEChild";itsKid.style.left="0px";it.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/g/images/gallery/reflections/"+Gallery.workspace.colorPicker.get('selectedColor')+"_wide.png' sizingMethod='scale')";it.innerHTML="";it.appendChild(itsKid);setTimeout("$('slideshowReflectionPNGIEChild').style.bottom = '-2px';",20);}},render:function(){if(this.owner._downloadStarterHasRun==false)
this.owner.downloadStarter();if(this.owner.nextPhotoTimer){clearTimeout(this.owner.nextPhotoTimer);this.owner.set('nextPhotoTimer',null);}
var content=this.get('content');if(!content||!content.get){return;}
this.owner.slideshowHoverViewMenu.slideshowDownloadButton.className=(content.get('canDownload')&&(content.get('isVideo')||content.get('largeImagePath')||content.get('isContribution')))?'download_slideshow':'download_slideshow_disabled';if(this.firstSlide){this.set('firstSlide',false);this.onFadeout();this.owner.mouseDidMove();}else{this.onFadeout();}},updateSelection:function(){},onFadeout:function(){var content=this.get('content');if(content){this._imgStyle=this.setDimension();var url=content.get('web');if((this.newImage.src==url)&&SC.isSafari()){this.onLoaded();}else{this.newImage.onload=this.onLoaded.bind(this);this.newImage.onerror=this.setTimeoutForNextSlide.bind(this);this.oldImage.setStyle({width:"1px",height:"1px",left:"0px",position:"relative"});this.newImage.setStyle({width:this._imgStyle.width+"px",height:this._imgStyle.height+"px",left:(Mac.View.windowWidth()/2-this._imgStyle.width/2)+"px",position:"relative"});this.newImage.src=url;}}},onLoaded:function(){this.oldImage.style.visibility='hidden';this.newImage.style.visibility='visible';this.setTimeoutForNextSlide();this.resizeHandler();if(this.get('content')&&this.get('content').get('showTitle')){var photos=Gallery.albumController.get('allPhotos').get('records')||[];var photo=this.owner.get('current');var index=photos.indexOf(photo)+1;var length=photos.length;document.title="_DotMacWebGallery".loc()+" - "+Gallery.albumController.get('title')+" - "+this.get('content').get('title')+(String.currentLanguage()=="Japanese"?"_VisitorExperience.AlbumPage.SlideshowView.Title".loc(length,index):"_VisitorExperience.AlbumPage.SlideshowView.Title".loc(index,length));}
var tmp=this.oldImage;this.oldImage=this.newImage;this.newImage=tmp;},setTimeoutForNextSlide:function(time){if(!time)time=SLIDESHOW_DELAY_MS;if(Gallery.workspace.get('nowShowing')=='slideshow'&&this.owner.nextPhotoTimer==null&&this.owner.slideshowHoverViewMenu.slideshowPlayPauseButton.className.indexOf('pause_slideshow')>=0)
this.owner.nextPhotoTimer=setTimeout(function(){var next=this.get('nextPhotoObject');if((next&&next.loadee&&next.loadee.completed==true)||!Gallery.useDowner){this.nextPhoto();}else{var time=100;setTimeout(function(){clearTimeout(this.nextPhotoTimer);this.nextPhotoTimer=null;this.slideshowImageView.setTimeoutForNextSlide(time);}.bind(this),0);}}.bind(this.owner),time);},observesEvents:true,setDimension:function(){var content=this.get('content');if(!content||!content.get){return;}
var imageWidth=content.get("webImageWidth");var imageHeight=content.get("webImageHeight");var fullWidth=(window.innerWidth||document.documentElement.clientWidth)-SLIDESHOW_HORIZONTAL_OFFSET_PX;var fullHeight=(window.innerHeight||document.documentElement.clientHeight)-(Gallery.fullscreen?1:SLIDESHOW_VERTICAL_OFFSET_PX)-40;fullWidth=fullWidth>0?fullWidth:1;fullHeight=fullHeight>0?fullHeight:1;var goFullWidth=((fullWidth/fullHeight)<(imageWidth/imageHeight))?true:false;var computedHeight=(imageWidth>0)?Math.floor((imageHeight/imageWidth)*fullWidth):1;var computedWidth=(imageHeight>0)?Math.floor((imageWidth/imageHeight)*fullHeight):1;return{width:(goFullWidth?fullWidth:computedWidth),height:(goFullWidth?computedHeight:fullHeight),originalWidth:imageWidth};},resizeHandler:function(){var content=this.get('content');var imgStyle=this.setDimension();if(!imgStyle){return;}
this.oldImage.setStyle({width:"1px",height:"1px",left:"0px",position:"relative",paddingTop:"0px"});this.newImage.setStyle({width:imgStyle.width+"px",height:imgStyle.height+"px",left:(Mac.View.windowWidth()/2-imgStyle.width/2)+"px",paddingTop:(Mac.View.windowHeight()-imgStyle.height)/2+"px",position:"relative"});}}).outletFor('#slideshowImageView'),slideshowHoverViewMenu:Mac.View.extend({outlets:['slideshowDownloadButton','slideshowPrevButton','slideshowPlayPauseButton','slideshowNextButton','slideshowCloseButton'],didMouseOver:function(evt){this.owner.isSlideshowHoverViewMenuOn=true;},didMouseOut:function(evt){this.owner.isSlideshowHoverViewMenuOn=false;},slideshowDownloadButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Download.Button.Tooltip",action:function(ev){if(!this.owner.owner.get('current'))return;var content=this.owner.owner.get('current');if(content.get('originalImagePath')&&content.get('largeImagePath'))
{$('playpause_slideshow').action();Gallery.downloadPanel().downloadFrom('slideshow');Gallery.downloadPanel().set("isVisible",true);}
else if(content.get('canDownload')&&(content.get('isVideo')||content.get('largeImagePath')||content.get('originalImagePath')||content.get('isContribution'))){SC.download(content.get('downloadPath'));}}}).outletFor('#download_slideshow'),slideshowPrevButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Previous.Button.Tooltip",action:function(ev){if(this.owner.owner.nextPhotoTimer){clearTimeout(this.owner.owner.nextPhotoTimer);this.owner.owner.set('nextPhotoTimer',null);}
this.owner.owner.nextPhotoTimer=setTimeout(this.owner.owner.prevPhoto.bind(this.owner.owner),1);}}).outletFor('#prev_slideshow'),slideshowPlayPauseButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip",action:function(ev){if(this.className.indexOf('pause_slideshow')>=0){if(this.owner.owner.nextPhotoTimer){clearTimeout(this.owner.owner.nextPhotoTimer);this.owner.owner.set('nextPhotoTimer',null);}
this.removeClassName("pause_slideshow");this.addClassName("play_slideshow");this.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip".loc());}else{this.removeClassName("play_slideshow");this.addClassName("pause_slideshow");this.set('toolTip',"_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip".loc());this.owner.owner.slideshowImageView.setTimeoutForNextSlide();}}}).outletFor('#playpause_slideshow'),slideshowNextButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.DetailPage.Next.Button.Tooltip",action:function(ev){if(this.owner.owner.nextPhotoTimer){clearTimeout(this.owner.owner.nextPhotoTimer);this.owner.owner.set('nextPhotoTimer',null);}
this.owner.owner.nextPhotoTimer=setTimeout(this.owner.owner.nextPhoto.bind(this.owner.owner),1);}}).outletFor('#next_slideshow'),slideshowCloseButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip",action:function(ev){window.close();}}).outletFor('#close_slideshow')}).outletFor('#slideshowHoverViewMenu'),mouseDidMove:function(evt){if(this._fadeTimeout){clearTimeout(this._fadeTimeout);this._fadeTimeout=null;}
if(this._fadingEffect){this._fadingEffect.cancel();this._fadingEffect=null;}
if(!this._boundFadeHoverView){this._boundFadeHoverView=this._fadeSlideshowHoverViewMenu.bind(this);}
this._fadeTimeout=setTimeout(this._boundFadeHoverView,2000);if(SC.isIE6())
this.slideshowHoverViewMenu.style.display="block";else if((this._fadingInEffect==null)){if(!this.slideshowHoverViewMenu.style.opacity)this.slideshowHoverViewMenu.style.opacity=1;this._fadingInEffect=new Effect.Opacity(this.slideshowHoverViewMenu,{duration:(1-this.slideshowHoverViewMenu.style.opacity)/3,to:1.0,from:this.slideshowHoverViewMenu.style.opacity,afterFinish:(function(){this.fixSlideshowOpacity(true);this._fadingInEffect=null;}).bind(this)});}},fixSlideshowOpacity:function(one){if(one){this.slideshowHoverViewMenu.style.opacity=1;}else{this.slideshowHoverViewMenu.style.opacity=0;}},hideSlideshowHoverViewMenu:function(){if(SC.isIE6()){this.slideshowHoverViewMenu.style.display="none";}else{this._fadingEffect=new Effect.Opacity(this.slideshowHoverViewMenu,{duration:1.0,to:0.0,from:1.0,afterFinish:this.fixSlideshowOpacity.bind(this,false)});}},_fadeSlideshowHoverViewMenu:function(){if(!this.isSlideshowHoverViewMenuOn){this.hideSlideshowHoverViewMenu();}},photosObserver:function(){if(!Gallery.workspace.didChangeFor('slideshow','nowShowing'))return;var nowShowing=Gallery.workspace.get("nowShowing");if(nowShowing=="slideshow"){var photos=Gallery.albumController.get('allPhotos').get('records')||[];var photo=Gallery.Photo.findAll({url:Gallery.selectedPhotoController.get('url')})[0];if(!photo||photos.indexOf(photo)<0)photo=(photos)?photos[0]:null;if(this.get('current')==null||photo!=this.get('current')){this.slideshowImageView.set('firstSlide',true);this.set('current',photo);}else{this.slideshowImageView.onFadeout();}}else if(this.nextPhotoTimer){clearTimeout(this.nextPhotoTimer);this.set('nextPhotoTimer',null);}}.observes("Gallery.workspace.nowShowing"),prevPhoto:function(){var prev=this.get('prevPhotoObject');this.set('current',prev);if(prev.loadee&&Gallery.slideshowLoadees)prev.loadee.importance=Gallery.slideshowLoadees.target;},nextPhoto:function(){var next=this.get('nextPhotoObject');this.set('current',next);if(next.loadee&&Gallery.slideshowLoadees)next.loadee.importance=Gallery.slideshowLoadees.target;},nextPhotoObject:function(){var photos=Gallery.albumController.get('allPhotos').get('records')||[];var photo=this.get('current');var index=photos.indexOf(photo)+1;if(index>=photos.length){index=0;}
return photos[index];}.property(),prevPhotoObject:function(){var photos=Gallery.albumController.get('allPhotos').get('records')||[];var photo=this.get('current');var index=photos.indexOf(photo)-1;if(index<0){index=photos.length-1;}
return photos[index];}.property(),currentObserver:function(){if(!Gallery.useDowner)return;var photos=Gallery.albumController.get('allPhotos').get('records')||[];var photo=this.get('current');var index=photos.indexOf(photo);Gallery.slideshowLoadees.target=index;var s=[];for(var i=0;i<photos.length;i++){if(photos[i].loadee){if(i<index-5)photos[i].loadee.importance=i-1000;if(i>=index-5)photos[i].loadee.importance=i;s[i]=photos[i].loadee.importance;}}}.observes('current'),_downloadStarterHasRun:false,downloadStarter:function(){if(Gallery.fullscreen!=true||!Gallery.useDowner||this._downloadStarterHasRun)return;this._downloadStarterHasRun=true;var them=Gallery.albumController.get('allPhotos').get('records')||[];for(var i=0;i<them.length;i++){them[i].loadee=ImageLoadee.create({url:them[i].get('web'),importance:i,ind:i,onload:function(){},forPrecache:true}).enter(Gallery.slideshowLoadees);}}});Gallery.SlideshowWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content','footer'],outlets:['slideshowView'],slideshowView:Gallery.SlideshowView.extend({photosBinding:"Gallery.allPhotosController.arrangedObjects"}).outletFor('#slideshowView')});Array.prototype._toString=[].toString;Array.prototype.toString=function(){return"["+this._toString()+"]";};Gallery.iMovieWorkspaceView=Mac.WorkspaceTab.extend({areas:['header','content']});require('core');Gallery.TellAFriendPanel=Mac.FormView.extend({isPanel:true,outlets:['captchaImage','spinnerImage','photo','includemobileDiv','messageField','lTitle','lInstructionalText','lToLabel','lToGhostText','lToInstructionalText','lFromLabel','lFromGhostText','lMessageLabel','lCancelButton','lSendButton','lCAPTCHAText','lCAPTCHAHelpLinkBtn','lIncludeMobileAddress','tellAFriendPanelLeft','fromField'],photo:".photo?",messageField:"#message",tellAFriendPanelLeft:".tellAFriendPanelLeft?",fromField:".lFromGhostText?",isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle?"),lInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lInstructionalText?"),lToLabel:Mac.LabelView.extend({localize:true}).outletFor(".lToLabel?"),lToInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lToInstructionalText?"),lToGhostText:".lToGhostText?",lFromLabel:Mac.LabelView.extend({localize:true}).outletFor(".lFromLabel?"),lFromGhostText:".lFromGhostText?",lMessageLabel:Mac.LabelView.extend({localize:true}).outletFor(".lMessageLabel?"),lIncludeMobileAddress:Mac.LabelView.extend({localize:true}).outletFor(".lIncludeMobileAddress?"),lCAPTCHAText:Mac.LabelView.extend({localize:true}).outletFor(".lCAPTCHAText?"),lCAPTCHAHelpLinkBtn:Mac.ButtonView.extend({outlets:["lCAPTCHAHelpLink"],lCAPTCHAHelpLink:Mac.LabelView.extend({localize:true}).outletFor(".lCAPTCHAHelpLink?"),action:function(){window.open("_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".lCAPTCHAHelpLinkBtn?"),lCancelButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button.Tooltip"}).outletFor(".lCancelButton?"),lSendButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.TellAFriend.Send.Button.Tooltip"}).outletFor(".lSendButton?"),adaptor:Mac.Adaptor.create({base:'/WebObjects/Comments.woa/wa/',requests:{prepare:{action:'getInfoForTellAFriend'},confirm:{action:'MessageDirectAction/sendMessageFromJSON',method:'post'}},prepareCaptcha:function(state,panel){this.request('prepare',{url:state.url},this.captchaPrepared.bind(this,state,panel),this.initCaptchaFail.bind(this,state,panel),this.initCaptchaFail.bind(this,state,panel));},initCaptchaFail:function(state,panel,originalResponse,result){this.prepareCaptcha(state,panel);},confirmCaptcha:function(state,panel){if(state.body=="")
{state.body=Gallery.tellAFriendPanel().messageField.value;}
var post=Object.toJSONString({data:{signature:state.signature,iv:state.iv,postURL:encodeURIComponent(state.url),to:state.to,from:state.from,includeMobile:state.includemobile,body:encodeURIComponent(this.toJSONSubString(state.body)),title:encodeURIComponent(this.toJSONSubString(state.title)),keyImage:encodeURIComponent(state.keyImage),moNumber:encodeURIComponent(state.moNumber),isProtected:"false",viewIdentifier:state.viewIdentifier}});this.request('confirm','postBody='+post,this.captchaConfirmed.bind(this,state,panel),this.captchaError.bind(this,state,panel),this.captchaFailure.bind(this,state,panel));},toJSONSubString:function(str)
{str=str||'';str=str.replace(/%0A/g,'\n').replace(/%0D/g,'\n');str=str.toJSONString();str=str.substr(1,str.length-2);return str;},captchaPrepared:function(state,panel,originalResponse,result){var rec=result.data;for(var key in rec.signature)
{var val=rec.signature[key];rec.signature[key]=eval(val);}
state.signature=rec.signature;state.captchaImageURL=rec.captchaImageURL;state.wosid=rec.wosid;state.woinst=rec.woinst;panel.runPanel(state);},captchaConfirmed:function(state,panel,originalResponse,result){state.status=result.status;panel.commitComplete(state);},captchaError:function(state,panel,originalResponse,result){state.status=result.status;state.errorCode=result.data.errorCode;state.statusString=result.statusString;panel.commitFailed(state);},captchaFailure:function(state,panel,originalResponse,result){this.state=state;this.setErrorFor(this.fields['iv'],"_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error".loc());var captchaURL=this.get('captchaImageURL');this.set('captchaImageURL',captchaURL);this.set('isCommitting',false);}}),url:'',albumTitle:'',keyImage:'',moNumber:'',isProtected:false,viewIdentifier:'0',_defaultDim:160,_defaultDimMovie:180,_defaultHtMovie:100,includemobileDiv:"#includemobileDiv",generateData:function(){this.set("albumTitle",Gallery.albumController.get("title"));var mobileEmail=(Gallery.albumController.get("mobileEmail"))?Gallery.albumController.get("mobileEmail"):"null";if(Gallery.albumController.get("mobileEmail"))
{this.includemobileDiv.style.visibility="";}
else
{this.includemobileDiv.style.visibility="hidden";}
this.set("moNumber",mobileEmail);this.set("viewIdentifier",Gallery.albumController.get("viewIdentifier").toString());if(Gallery.albumController.get("isAlbum"))
{this.tellAFriendPanelLeft.removeClassName("movieItem");this.setImage(Gallery.albumController.get("square"));this.set("isProtected",Gallery.albumController.get("isProtected").toString());this.set("keyImage",Gallery.albumController.get("square"));this.set("url",Gallery.albumController.get("path"));}
else
{this.set("isProtected",Gallery.albumController.get("isProtected").toString());this.tellAFriendPanelLeft.addClassName("movieItem");var aspect=Gallery.albumController.get("posterImageWidth")/Gallery.albumController.get("posterImageHeight");if(aspect<(16/9)){this.photo.style.position="relative";}
this.setMovie(Gallery.albumController.get("medium"));this.set("url",Gallery.albumController.get("url"));this.set("keyImage",Gallery.albumController.get("square"));}
var state={url:this.get("url"),title:this.get("albumTitle"),keyImage:this.get("keyImage"),moNumber:this.get("moNumber"),isProtected:this.get("isProtected"),viewIdentifier:this.get("viewIdentifier")};this.state=state;this.adaptor.prepareCaptcha(state,this);if(!Gallery.albumController.get("isAlbum"))
{setTimeout(this.makePanelSafe.bind(this),300);setTimeout(this.makePanelSafe.bind(this),1000);}},makePanelSafe:function()
{Gallery.detailView().movieView.makePanelSafe();},setMovie:function(path){if(path)
{this.photo.src="";this.photo.src=path;this.photo.setStyle({width:this._defaultDimMovie+"px",marginLeft:"3px",marginTop:"4px"});}},setImage:function(path){if(path)
{this.photo.src="";this.photo.src=path;this.photo.setStyle({width:this._defaultDim+"px",height:this._defaultDim+"px",marginLeft:"3px",marginTop:"4px"});}},runPanel:function(state){this.state=state;this.set('captchaImageURL',state.captchaImageURL);this.set('formValues',{});this.set('isDirty',true);this.fromField.focus();},init:function(){arguments.callee.base.apply(this,arguments);Event.observe(this.messageField,"keypress",this.checkMessageLength.bindAsEventListener(this));},checkMessageLength:function()
{if(this.messageField.value.length>300)
{this.messageField.value=this.messageField.value.substring(0,300);}},captchaImageURL:'',captchaImageObserver:function(){this.captchaImage.src=this.get('captchaImageURL')+"&"+Math.random();this.captchaImage.observe('error',this.captchaImgError.bind(this));}.observes('captchaImageURL'),captchaImgError:function()
{this.adaptor.prepareCaptcha(this.state,this);},captchaImage:Mac.View.outletFor('#tellAFriendCaptchaImage'),spinnerImage:Mac.View.extend({isVisibleBinding:'*owner.isCommitting',init:function(){arguments.callee.base.apply(this,arguments);this.set('isVisible',false);}}).outletFor('img.spinner'),resetForm:function(){this.set('formValues',{});this.setCurrentFormValues(this.get('formValues'));Gallery.tellAFriendPanel().messageField.value='';Gallery.tellAFriendPanel().messageField.innerHTML='';arguments.callee.base.apply(this,arguments);this.set('isVisible',false);setTimeout("try{Gallery.workspace.detailView.movieView.doneMakePanelSafe();}catch(e){}",1000);},commitForm:function(){Gallery.blockUpdate=true;var value=arguments.callee.base.apply(this,arguments);Gallery.blockUpdate=false;if(value){this.set('isCommitting',true);var state=this.state;var fv=this.get('formValues');state.from=fv.from;state.to=fv.to;state.body=fv.body;state.includemobile=(fv.includemobile)?"true":"false";if(state.includemobile=="")
{state.includemobile="false";}
state.iv=fv.iv;this.adaptor.confirmCaptcha(state,this);return true;}else return false;},commitFailed:function(state)
{this.state=state;switch(state.errorCode)
{case'1':this.setErrorFor(this.fields['iv'],"_VisitorExperience.DetailPage.MismatchCAPTCHA.Error".loc());case'2':this.setErrorFor(this.fields['iv'],"_VisitorExperience.DetailPage.MismatchCAPTCHA.Error".loc());break;case'8':this.setErrorFor(this.fields['iv'],"_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error".loc());break;case'9':this.setErrorFor(this.fields['to'],"_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error".loc());break;case'11':this.setErrorFor(this.fields['to'],"_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error".loc());break;}
var captchaURL=this.get('captchaImageURL');this.set('captchaImageURL',captchaURL);this.set('isCommitting',false);},commitComplete:function(state){this.set('isCommitting',false);this.set('isVisible',false);this.resetForm();}});function openHelpWindow(url,width,height)
{window.open(url,"displayHelpWindowName",'width='+width+',height='+height+',resizable=yes,scrollbars=yes,menubar=yes,status=0,toolbar=no');}
require('core');Gallery.MobilePanel=Mac.FormView.extend({isPanel:true,outlets:["mobileEmail","lTitle","lInstructionalText","lDoneButton","helpButton"],isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle?"),lInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lInstructionalText?"),lDoneButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.MobilePosting.Done.Button.Tooltip"}).outletFor(".lDoneButton?"),lHelpButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Help.Button.Tooltip"}).outletFor(".lHelpButton?"),mobileEmail:".mobileEmail?",generateData:function()
{var content=Gallery.albumController.get("content");if(Gallery.albumController.get("allowMobile")&&Gallery.albumController.get("mobileEmail")!=undefined)
{this.mobileEmail.innerHTML=Gallery.albumController.get("mobileEmail");this.mobileEmail.href="mailto:"+Gallery.albumController.get("mobileEmail");}},helpButton:SC.ButtonView.extend({outlets:['lHelpButton'],action:function(evt){if((evt.clientY==null&&evt.clientX==null)||(evt.clientY!=0&&evt.clientX!=0))
{window.open("_VisitorExperience.AlbumOptions.Help.Button.MobilePosting.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=no,toolbar=no');}
else
{this.owner.commitForm();}},lHelpButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Help.Button.Tooltip"}).outletFor(".lHelpButton?")}).outletFor(".help?"),commitForm:function(){this.set("isVisible",false);this.style.display='';}});require('core');Gallery.CPanel=Mac.FormView.extend({isPanel:true,canSubmit:true,isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),outlets:['captchaImage','spinnerImage','lTitle','lInstructionalText','lNameLabel','lAddressLabel','lAddressGhostText','lCAPTCHAText','lCAPTCHAHelpLinkBtn','lCancelButton','lChooseFilesButton','contributeName','helpButton'],contributeName:'.contributeName?',lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle?"),lInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lInstructionalText?"),lNameLabel:Mac.LabelView.extend({localize:true}).outletFor(".lNameLabel?"),lAddressLabel:Mac.LabelView.extend({localize:true}).outletFor(".lAddressLabel?"),lAddressGhostText:".lAddressGhostText?",lCAPTCHAText:Mac.LabelView.extend({localize:true}).outletFor(".lCAPTCHAText?"),helpButton:SC.ButtonView.extend({outlets:['lHelpButton'],action:function(evt){if((evt.clientY==null&&evt.clientX==null)||(evt.clientY!=0&&evt.clientX!=0))
{window.open("_VisitorExperience.AlbumOptions.Help.Button.AddtoAlbum.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}
else
{this.owner.commitForm();}},lHelpButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Help.Button.Tooltip"}).outletFor(".lHelpButton?")}).outletFor(".help?"),lCAPTCHAHelpLinkBtn:Mac.ButtonView.extend({outlets:["lCAPTCHAHelpLink"],lCAPTCHAHelpLink:Mac.LabelView.extend({localize:true}).outletFor(".lCAPTCHAHelpLink?"),action:function(){window.open("_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".lCAPTCHAHelpLinkBtn?"),lCancelButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button.Tooltip"}).outletFor(".lCancelButton?"),lChooseFilesButton:Mac.LabelView.extend({localize:true,didClick:function(){if(!this.owner.get("scaling")){this.owner.set('canSubmit',true);}},toolTip:"_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button.Tooltip"}).outletFor(".lChooseFilesButton?"),adaptor:Mac.Adaptor.create({base:'/WebObjects/Comments.woa/wa/',requests:{prepare:{action:'contribute'},confirm:{action:'validateContribution',method:'post'}},prepareCaptcha:function(state,panel){state.url=state.albumGuid;this.request('prepare',{url:state.albumGuid},this.captchaPrepared.bind(this,state,panel),this.initCaptchaFail.bind(this,state,panel),this.initCaptchaFail.bind(this,state,panel));},confirmCaptcha:function(state,panel){var post=Object.toJSONString({data:{signature:state.signature,iv:state.iv,postURL:state.albumGuid,userURL:encodeURIComponent(state.userURL),name:encodeURIComponent(state.name)}});this.request('confirm','postBody='+post.toString(),this.captchaConfirmed.bind(this,state,panel),this.captchaError.bind(this,state,panel),this.captchaFailure.bind(this,state,panel));},initCaptchaFail:function(state,panel,originalResponse,result){state.status=result.status;state.errorCode=result.data.errorCode;state.statusString=result.statusString;panel.commitFailed(state);},captchaPrepared:function(state,panel,originalResponse,result){var rec=result.data;for(var key in rec.signature)
{var val=rec.signature[key];rec.signature[key]=eval(val);}
state.signature=rec.signature;state.captchaImageURL=rec.captchaImageURL;state.wosid=rec.wosid;state.woinst=rec.woinst;panel.runPanel(state);},captchaConfirmed:function(state,panel,originalResponse,result){state.batchLimit=result.batchLimit;state.contributionsAllowed=result.contributionsAllowed;state.availableSpace=result.availableSpace;state.status=result.status;panel.commitComplete(state);},captchaError:function(state,panel,originalResponse,result){state.status=result.status;state.errorCode=result.data.errorCode;state.statusString=result.statusString;panel.commitFailed(state);},captchaFailure:function(state,panel,originalResponse,result){this.state=state;var captchaURL=this.get('captchaImageURL');this.set('captchaImageURL',captchaURL);this.set('isCommitting',false);}}),contributeTo:function(albumGuid,albumName){var state={albumGuid:albumGuid,albumName:albumName};this.state=state;this.adaptor.prepareCaptcha(state,this);},runPanel:function(state){this.state=state;this.set('captchaImageURL',state.captchaImageURL);this.set('formValues',{});this.set('isDirty',true);this.retryTimeout=1000;this.retryCount=0;if(Gallery.albumController.get('viewIdentifier')===VIEW_APERTURE_ALBUM)
$('cPanelInstructions').innerHTML='_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalTextAperture'.loc();else
$('cPanelInstructions').innerHTML='_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalText'.loc();this.contributeName.focus();},retryTimeout:1000,retryCount:0,retryMax:3,init:function(){arguments.callee.base.apply(this,arguments);},captchaImageURL:'',captchaImageObserver:function(){var src=this.get('captchaImageURL');if(!src.match(/^\/g/))
src+="&"+Math.random();this.captchaImage.src=src;this.captchaImage.observe('error',this.captchaImgError.bind(this));}.observes('captchaImageURL'),captchaImgError:function()
{if(this.retryCount++<=this.retryMax)
{this.retryTimeout*=2;setTimeout(function(){this.adaptor.prepareCaptcha(this.state,this);}.bind(this),this.retryTimeout);}},captchaImage:Mac.View.outletFor('#cPanelCaptchaImage'),spinnerImage:Mac.View.extend({isVisibleBinding:'*owner.isCommitting',init:function(){arguments.callee.base.apply(this,arguments);this.set('isVisible',false);}}).outletFor('img.spinner'),didKeyPress:function(evt){var evt=(evt)?evt:((event)?event:null);var node=(evt.target)?evt.target:((evt.srcElement)?evt.srcElement:null);if(evt.keyCode==13&&(node.type=="text"||node.type=="submit")){this.set('canSubmit',true);this.commitForm();}},resetForm:function(){this.set('formValues',{});this.setCurrentFormValues(this.get('formValues'));arguments.callee.base.apply(this,arguments);this.set('isVisible',false);},commitForm:function(){if(this.get('canSubmit')){this.popUp=null;this.popUp=window.open('','share_uploader','status=0,toolbar=0, menubar=0, resizable='+((SC.isSafari()&&!SC.isSafari3())?'0':'1')+', width=350, height=300');if(this.popUp==null){return false;}
if(arguments.callee.base.apply(this,arguments)){this.set('isCommitting',true);var state=this.state;var fv=this.get('formValues');state.name=(fv.name.length<51)?fv.name:fv.name.substring(0,50);state.userURL=fv.userUrl;state.iv=fv.iv;this.adaptor.confirmCaptcha(state,this);return true;}
else
{if(this.popUp)
{this.popUp.close();}
return false;}}},commitFailed:function(state)
{this.state=state;var resetCapcha=false;if(this.popUp)
this.popUp.close();switch(state.errorCode)
{case'1':this.setErrorFor(this.fields['iv'],"_VisitorExperience.DetailPage.MismatchCAPTCHA.Error".loc());this.set('canSubmit',true);resetCapcha=true;break;case'2':this.setErrorFor(this.fields['iv'],"_VisitorExperience.DetailPage.MismatchCAPTCHA.Error".loc());this.set('canSubmit',true);resetCapcha=true;break;case'3':this.setErrorFor(this.fields['userUrl'],"_VisitorExperience.DetailPage.InvalidURLOrEmail.Error".loc());this.set('canSubmit',false);resetCapcha=true;break;case'5':break;}
var captchaURL=(resetCapcha?this.get('captchaImageURL'):'/g/images/gallery/captchaerror.jpg');this.set('captchaImageURL',captchaURL);this.set('isCommitting',false);},commitComplete:function(state){if(state.contributionsAllowed<=0||state.availableSpace<1048576){if(state.contributionsAllowed<=0)
{alert('_VisitorExperience.AlbumOptions.FileUploader.MaxUploadCount'.loc());}
else if(state.availableSpace<1048576)
{alert("_VisitorExperience.AlbumOptions.FileUploader.MaxSpace".loc());}}else{if(state.status==1){var uniqId=new Date().getTime();var guid=state.albumGuid.slice(1,state.albumGuid.length);if(this.popUp){var route='choose/%@&albumGuid=%@&albumName=%@&contributionsAllowed=%@&availablespace=%@&batchLimit=%@&wosid=%@&woinst=%@'.format(uniqId,guid,state.albumName,state.contributionsAllowed,state.availableSpace,state.batchLimit,state.wosid,state.woinst);if(SC.isSafari()&&!SC.isSafari3()&&this.popUp.SC&&this.popUp.SC.Routes){this.popUp.SC.Routes.gotoRoute(route);}else{this.popUp.location='%@#%@'.format(Gallery.uploaderURL,route);}}}}
this.set('isCommitting',false);this.set('isVisible',false);this.resetForm();this.set('canSubmit',true);}});require('core');Gallery.SyndicationPanel=Mac.FormView.extend({isPanel:true,outlets:["syndicationRSSFeed","lTitle","lDoneButton","syndicationButtons","syndicationRSSOnlyLabel","syndicationRSSLabel","syndicationiPhotoLabel","syndicationRSSOnly","syndicationRSSInstructions","syndicationiPhotoInstructions","lCancelButton","syndicationChoiceRadioRSS","syndicationChoiceRadioiPhoto","syndicationiPhotoPanel","syndicationRSSPanel","syndicationiPhoto","syndicationiPhoto","syndicationRSS","syndicationInstructionalText","syndicationInstructionalText2","syndicationRSSInstructions1","syndicationRSSInstructions2","syndicationiPhotoInstructions1","syndicationiPhotoInstructions2"],isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle?"),lDoneButton:Mac.LabelView.extend({init:function(){arguments.callee.base.call(this);if(SC.isIE6())this.innerHTML="_VisitorExperience.AlbumOptions.Subscribe.Copy.Button".loc();},localize:true,toolTip:(SC.isIE6()?"_VisitorExperience.AlbumOptions.Subscribe.Copy.Button.Tooltip":"_VisitorExperience.AlbumOptions.Subscribe.Done.Button.Tooltip")}).outletFor(".lDoneButton?"),lCancelButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button.Tooltip"}).outletFor(".lCancelButton?"),subscriptionName:function()
{var value='';if(Gallery.workspace.get("atHome"))
value=Gallery.defaults.title.escapeHTML();else
value=Gallery.albumController.get("title").escapeHTML();return value;},syndicationInstructionalText:Mac.LabelView.extend({localize:true,escapeHTML:false,formatter:function(value)
{value=Gallery.syndicationPanel().subscriptionName();return'_VisitorExperience.AlbumOptions.Subscribe.InstructionalText'.loc(value);}}).outletFor("#syndicationInstructionalText"),syndicationInstructionalText2:Mac.LabelView.extend({localize:true,escapeHTML:false,formatter:function(value)
{value=Gallery.syndicationPanel().subscriptionName();return'_VisitorExperience.AlbumOptions.Subscribe.InstructionalText2'.loc(value);}}).outletFor("#syndicationInstructionalText2"),syndicationButtons:"#syndicationButtons",syndicationRSSFeed:"#syndicationRSSFeed",syndicationChoiceRadioRSS:"#syndicationChoiceRadioRSSId",syndicationChoiceRadioiPhoto:"#syndicationChoiceRadioiPhotoId",syndicationRSSPanel:"#syndicationRSSPanel",syndicationiPhotoPanel:"#syndicationiPhotoPanel",syndicationRSSInstructions:Mac.LabelView.extend({localize:true}).outletFor("#syndicationRSSInstructions"),syndicationiPhotoInstructions:Mac.LabelView.extend({localize:true}).outletFor("#syndicationiPhotoInstructions"),syndicationRSSInstructions1:Mac.LabelView.extend({localize:true}).outletFor("#syndicationRSSInstructions1"),syndicationRSSInstructions2:Mac.LabelView.extend({localize:true}).outletFor("#syndicationRSSInstructions2"),syndicationiPhotoInstructions1:Mac.LabelView.extend({localize:true}).outletFor("#syndicationiPhotoInstructions1"),syndicationiPhotoInstructions2:Mac.LabelView.extend({localize:true}).outletFor("#syndicationiPhotoInstructions2"),syndicationRSSOnlyLabel:Mac.LabelView.extend({localize:true}).outletFor("#syndicationRSSOnlyLabel"),syndicationRSSLabel:Mac.LabelView.extend({localize:true}).outletFor("#syndicationRSSLabel"),syndicationiPhotoLabel:Mac.LabelView.extend({localize:true}).outletFor("#syndicationiPhotoLabel"),syndicationRSSOnly:"#syndicationRSSOnly",syndicationiPhoto:"#syndicationiPhoto",syndicationRSS:"#syndicationRSS",syndicationFeedURL:'',currentHeight:0,previousErrorCount:0,generateData:function(){if(Gallery.workspace.get("atHome")||!HAS_PHOTOCAST_PLUGIN)
{this.set("url","http://"+HOST+"/"+Gallery.accountName);var state={url:this.get("url"),viewIdentifier:this.get("viewIdentifier")};this.state=state;if(Gallery.workspace.get("atHome"))
{this.syndiationFeedURL="http://"+PHOTOCAST_HOST+"/"+Gallery.accountName+"/rss";}
else
{var content=Gallery.albumController.get("content");var urlArray=content[0].get("path").split('/');this.set("url",Gallery.albumController.get("path"));this.syndiationFeedURL="http://"+PHOTOCAST_HOST+"/"+Gallery.accountName+"/"+urlArray[4]+"/rss";}
this.syndicationRSSFeed.innerHTML=this.syndiationFeedURL;this.syndicationInstructionalText2.set('content','');this.syndicationInstructionalText2.set("isVisible",true);this.syndicationInstructionalText.set("isVisible",false);this.syndicationRSS.style.display='none';this.syndicationRSSOnly.style.display='';this.syndicationiPhoto.style.display='none';}
else
{this.syndicationInstructionalText2.set("isVisible",false);this.syndicationInstructionalText.set('content','');this.syndicationInstructionalText.set("isVisible",true);this.syndicationRSS.style.display='';this.syndicationRSSOnly.style.display='none';if(!HAS_PHOTOCAST_PLUGIN||Gallery.workspace.get("atHome"))
{this.syndicationiPhoto.style.display='none';}
else
{this.syndicationiPhoto.style.display='';}
var content=Gallery.albumController.get("content");var urlArray=content[0].get("path").split('/');this.set("url",Gallery.albumController.get("path"));var state={url:this.get("url"),viewIdentifier:this.get("viewIdentifier")};this.state=state;this.syndiationFeedURL="http://"+PHOTOCAST_HOST+"/"+Gallery.accountName+"/"+urlArray[4]+"/rss";this.syndicationRSSFeed.innerHTML=this.syndiationFeedURL;}
this.toggleVisibleOption("RSS");},resetForm:function()
{this.set("isVisible",false);this.set('formValues',{});this.set("errors",null);Gallery.workspace.set("showingSyndicationPanel",false);setTimeout("try{Gallery.workspace.detailView.movieView.doneMakePanelSafe();}catch(e){}",1000);},commitForm:function()
{if(this.get("currentOption")=="iPhoto")
{var content=Gallery.albumController.get("content");var urlArray=content[0].get("path").split('/');window.location="http://"+PHOTOCAST_HOST+"/"+urlArray[3]+"/iPhoto/"+urlArray[4]+"/subscribe";this.resetForm();}
else
{if(SC.isIE6()==false)window.location=this.syndiationFeedURL;else window.clipboardData.setData("Text",this.syndiationFeedURL);this.resetForm();}},init:function()
{arguments.callee.base.call(this);this.syndicationChoiceRadioRSS.onclick=this.toggleVisibleOption.bind(this,"RSS");this.syndicationChoiceRadioiPhoto.onclick=this.toggleVisibleOption.bind(this,"iPhoto");this.syndicationRSS.onclick=this.toggleVisibleOption.bind(this,"RSS");this.syndicationiPhoto.onclick=this.toggleVisibleOption.bind(this,"iPhoto");this.syndicationRSSPanel.style.display='';this.syndicationiPhotoPanel.style.display='none';},toggleVisibleOption:function(toggle)
{this.set("currentOption",toggle);this.set('formValues',{});this.set("errors",null);this.set('errorCount',0);this.set('isDirty',true);if(!SC.isIE6());this.syndicationButtons.style.top="-93px";switch(toggle)
{case"RSS":this.syndicationRSSPanel.style.display='';this.syndicationiPhotoPanel.style.display='none';if(Gallery.workspace.get("atHome"))
{this.syndicationRSS.style.display='none';}
else
{this.syndicationChoiceRadioRSS.checked="checked";}
this.currentHeight=300;if(SC.isIE7()){this.style.height="281px";}
else{this.style.height="300px";}
break;case"iPhoto":if(HAS_PHOTOCAST_PLUGIN&&!Gallery.workspace.get("atHome"))
{this.syndicationChoiceRadioiPhoto.checked="checked";this.syndicationRSSPanel.style.display='none';this.syndicationiPhotoPanel.style.display='';this.currentHeight=300+(20*this.errorCount);this.style.height=this.currentHeight+"px";}
break;}}});require('core');Gallery.DownloadPanel=Mac.FormView.extend({isPanel:true,outlets:["downloadURL","downloadTitle","spinnerImage","lTitle",'lInstructionalText','lStatusText','lCancelButton','lDownloadButton'],isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle?"),lInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lInstructionalText?"),lStatusText:Mac.LabelView.extend({localize:true}).outletFor(".lStatusText?"),lCancelButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip"}).outletFor('.lCancelButton?'),lDownloadButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip"}).outletFor('.lDownloadButton?'),filename:' ',isPreparing:false,isError:false,downloadLocation:null,prepareDownload:function(viewType){if(viewType==='album')
var photos=Gallery.albumController.get('allPhotos').get('records')||[];else if(viewType==='slideshow')
var photos=[Gallery.workspace.slideshowTab.slideshowView.get('current')]||[];else if(viewType==='detail')
var photos=[Gallery.detailPhotoController.get('content')]||[];var strings=[];strings.push(ZIP_REQUEST_HEADER);var titles=[];for(var i=0;i<photos.length;i++)
titles[i]=photos[i].get('title').replace(/[{}~@&\*<>\[\]=\+\\\/,\.:;]/g,'_');for(var i=0;i<titles.length-1;i++)
{var dupeCount=1;for(var j=i+1;j<titles.length;j++)
if(titles[i]===titles[j])
titles[j]=titles[j]+'-'+dupeCount++;}
for(var i=0;i<photos.length;i++){var photo=photos[i];var view=photo.get('viewIdentifier');if(view==VIEW_IPHOTO_PHOTO){var originalImageExtension='';if(photo.get('originalImagePath'))
{var href=photo.get('original');originalImageExtension=href.substr(href.lastIndexOf('.')+1);var title=titles[i]+'_original'+'.'+originalImageExtension;strings.push('<entry>\r\n<name>'+title+'</name>\r\n<href>'+href+'</href>\r\n</entry>\r\n');}
if(photo.get('large'))
{var href=photo.get('large');var title=titles[i]+'.'+photo.get('fileExtension');strings.push('<entry>\r\n<name>'+title+'</name>\r\n<href>'+href+'</href>\r\n</entry>\r\n');}}
else if(view==VIEW_IPHOTO_VIDEO){var href=photo.get('video');var title=titles[i]+'.'+photo.get('videoPath').split('.')[1];strings.push('<entry>\r\n<name>'+title+'</name>\r\n<href>'+href+'</href>\r\n</entry>\r\n');}}
strings.push(ZIP_REQUEST_FOOTER);var body=strings.join('\r\n');return body;},downloadFrom:function(viewType){if(viewType==='album')
var myFilename=Gallery.albumController.get('title').replace(/[{}~@&\*<>\[\]=\+\\\/,\.:;]/g,'').replace(/ /g,'_').toLowerCase();else if(viewType==='slideshow')
var myFilename=Gallery.workspace.slideshowTab.slideshowView.get('current').get('title');else if(viewType==='detail')
var myFilename=Gallery.detailPhotoController.get('title').replace(/[{}~@&\*<>\[\]=\+\\\/,\.:;]/g,'').replace(/ /g,'_').toLowerCase();else
return;this.set('filename',myFilename.substr(0,Math.min(myFilename.length,20))+'.zip');this.set('isPreparing',true);this.set('isError',false);this.set('isDirty',false);this.downloadTitle.set("content",this.get('filename'));this.lStatusText.set("content","_VisitorExperience.AlbumOptions.Download.PreparingDownload");this.lStatusText.setStyle({left:164+"px"});var url;if(Gallery.isLocalhost){url='xhr/'+Gallery.defaultUser+'/'+getRouteAsPath()+'?webdav-method=ZIPLIST';}
else{url=getRouteAsPath()+'?webdav-method=ZIPLIST';}
new Ajax.Request(url,{method:'POST',contentType:'text/xml',postBody:this.prepareDownload(viewType),onSuccess:this.verifyResponse.bind(this),onFailure:this.downloadError.bind(this)});},verifyResponse:function(response){var responses=response.responseXML.getElementsByTagName('status');if($A(responses).all(function(el){return(el.firstChild.nodeValue=='HTTP/1.1 200 OK');})){this.setDownloadLocation(response);}
else{this.downloadError();}},setDownloadLocation:function(response){this.set('isPreparing',false);var title=encodeURIComponent(this.get('filename'));var token=response.getResponseHeader('X-Zip-Token');if(token){this.set("isDirty",true);this.set('downloadLocation','http://'+HOST+'/'+getRouteAsPath().replace('\/gallery\/','/'+Gallery.accountName+'/')+'/'+title+'?webdav-method=ZIPGET&token='+token+'&disposition=download');this.lStatusText.set("content","_VisitorExperience.AlbumOptions.Download.DownloadReady");this.lStatusText.setStyle({left:160+"px"});}
else{this.downloadError();}},downloadError:function(){this.set('isPreparing',false);this.set('isError',true);this.set('isDirty',false);this.lStatusText.set("content","_VisitorExperience.AlbumOptions.Download.UnableToDownload");this.lStatusText.setStyle({left:160+"px"});},downloadLocationObserver:function(){this.downloadURL.set("content",this.get('filename'));}.observes('downloadLocation'),isDone:function(){return(!this.get('isPreparing')&&!this.get('isError'));}.property(),downloadTitle:Mac.LabelView.extend({isVisibleBinding:Mac.Binding.Not('*owner.isDone')}).outletFor('div.downloadTitle'),downloadURL:Mac.LabelView.extend({isVisibleBinding:'*owner.isDone'}).outletFor('.downloadURL?'),spinnerImage:Mac.View.extend({isVisibleBinding:'*owner.isPreparing'}).outletFor('img.spinner'),commitForm:function(){SC.download(this.get("downloadLocation"));this.set("isVisible",false);this.set("isPreparing",false);this.set("isError",false);this.set("isDirty",false);this.downloadURL.innerHTML=" ";},resetForm:function(){this.set("isVisible",false);this.set("isPreparing",false);this.set("isError",false);this.set("isDirty",false);this.downloadURL.innerHTML=" ";},init:function(){arguments.callee.base.apply(this,arguments);Event.observe(this.downloadURL,'click',this.commitForm.bind(this));this.registerDependentKey('isDone','isPreparing');this.registerDependentKey('isDone','isError');this.set("isDirty",false);if(SC.isIE6()){$("downloadPanel").getElementsByClassName("icon")[0].src="/g/images/gallery/ie6/actions_drawer/zip_icon.gif";}}});require('core');Gallery.DownloadMoviePanel=Mac.FormView.extend({isPanel:true,outlets:["lTitle",'lInstructionalText','lCancelButton','lDownloadButton','mediumMovie','largeMovie','mediumMovieCheckbox','largeMovieCheckbox'],isAnimationEnabled:function(){return!(Gallery.workspace.moreThan100Items()||(SC.isIE7()&&Gallery.workspace.get('nowShowing')=='carouseljs'));}.property(),lTitle:Mac.LabelView.extend({localize:true}).outletFor(".lTitle"),lInstructionalText:Mac.LabelView.extend({localize:true}).outletFor(".lInstructionalText"),lCancelButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip"}).outletFor('.lCancelButton?'),lDownloadButton:Mac.LabelView.extend({localize:true,toolTip:"_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip"}).outletFor('.lDownloadButton?'),movieContent:null,mediumMovieCheckbox:"#mediumMovieCheckboxId",largeMovieCheckbox:"#largeMovieCheckboxId",_hasSmall:false,_hasMedium:false,_hasLarge:false,mediumMovie:Mac.View.extend({outlets:['movieSizeName','movieDimensions','movieFileSize'],movieSizeName:Mac.LabelView.extend({localize:true}).outletFor("#mediumMovieSizeName"),movieDimensions:Mac.LabelView.extend({}).outletFor("#mediumMovieDimensions"),movieFileSize:Mac.LabelView.extend({}).outletFor("#mediumMovieFileSize")}).viewFor('#mediumMovieDownload'),largeMovie:Mac.View.extend({outlets:['movieSizeName','movieDimensions','movieFileSize'],movieSizeName:Mac.LabelView.extend({localize:true}).outletFor("#largeMovieSizeName"),movieDimensions:Mac.LabelView.extend({}).outletFor("#largeMovieDimensions"),movieFileSize:Mac.LabelView.extend({}).outletFor("#largeMovieFileSize")}).viewFor('#largeMovieDownload'),formatMovieSize:function(height,width)
{return width+"x"+height;},generateData:function(){var movieContent=Gallery.detailView().movieView.get("content");var currentiMovieSize=Gallery.detailView().movieView._currentiMovieSize;this._hasSmall=movieContent.get("videoSmall")?true:false;this._hasMedium=movieContent.get("videoMedium")?true:false;this._hasLarge=movieContent.get("videoLarge")?true:false;if(this._hasMedium)
{this.mediumMovie.movieDimensions.set("content",this.formatMovieSize(movieContent.get("videoHeightMedium"),movieContent.get("videoWidthMedium")));if($('mediumDim'))$('mediumDim').style.display='';}
else if(this._hasSmall)
{this.mediumMovie.movieDimensions.set("content",this.formatMovieSize(movieContent.get("videoHeightSmall"),movieContent.get("videoWidthSmall")));if($('mediumDim'))$('mediumDim').style.display='';}
else
{if($('mediumDim'))$('mediumDim').style.display='none';}
if(this._hasLarge)
{this.largeMovie.movieDimensions.set("content",this.formatMovieSize(movieContent.get("videoHeightLarge"),movieContent.get("videoWidthLarge")));if($('largeDim'))$('largeDim').style.display='';}
else
{if($('largeDim'))$('largeDim').style.display='none';}
this.mediumMovie.movieSizeName.set("content","_VisitorExperience.AlbumOptions.DownloadMovie.iPodOriPhone");this.largeMovie.movieSizeName.set("content","_VisitorExperience.AlbumOptions.DownloadMovie.macPCOrAppleTV");var duration=Math.round(movieContent.get('videoDurationMedium')||movieContent.get('videoDurationLarge')||movieContent.get('videoDurationSmall')||movieContent.get('videoDurationMobile')||0);this.largeMovie.movieFileSize.set("content","_VisitorExperience.AlbumOptions.DownloadMovie.About".loc()+" "+Math.round(0.47*duration*10)/10+" MB");this.mediumMovie.movieFileSize.set("content","_VisitorExperience.AlbumOptions.DownloadMovie.About".loc()+" "+Math.round(0.20*duration*10)/10+" MB");if(!this._hasMedium&&this._hasSmall)
{this.mediumMovie.movieFileSize.set("content","_VisitorExperience.AlbumOptions.DownloadMovie.About".loc()+" "+Math.round(0.12*duration*10)/10+" MB");}
this.mediumMovieCheckbox.disabled=(this._hasMedium||this._hasSmall)?"":"disabled";this.largeMovieCheckbox.disabled=(this._hasLarge)?"":"disabled";this.mediumMovieCheckbox.checked=(this._hasLarge)?"":"checked";this.largeMovieCheckbox.checked=(!this._hasLarge)?"":"checked";setTimeout(this.makePanelSafe.bind(this),300);setTimeout(this.makePanelSafe.bind(this),1000);},makePanelSafe:function()
{Gallery.detailView().movieView.makePanelSafe();$('mediumMovieDownload').className=(this._hasMedium||this._hasSmall)?'':'disabled';$('largeMovieDownload').className=(this._hasLarge)?'':'disabled';},commitForm:function(){var mediumMovie=this.mediumMovieCheckbox.checked;var largeMovie=this.largeMovieCheckbox.checked;if(mediumMovie&&this._hasMedium)
{window.location.href=Gallery.detailView().movieView.get("content").get("videoMedium")+"?disposition=download";}
else if(mediumMovie&&this._hasSmall)
{window.location.href=Gallery.detailView().movieView.get("content").get("videoSmall")+"?disposition=download";}
else if(largeMovie&&this._hasLarge)
{window.location.href=Gallery.detailView().movieView.get("content").get("videoLarge")+"?disposition=download";}
this.resetForm();},resetForm:function(){this.mediumMovieCheckbox.checked='';this.largeMovieCheckbox.checked='';this.set("isVisible",false);setTimeout("try{Gallery.workspace.detailView.movieView.doneMakePanelSafe();}catch(e){}",1000);},selectMovieSize:function(size)
{switch(size)
{case"medium":if(this._hasMedium)
{this.mediumMovieCheckbox.checked="checked";}
break;case"large":if(this._hasLarge)
{this.largeMovieCheckbox.checked="checked";}
break;}},init:function(){arguments.callee.base.apply(this,arguments);$('mediumMovieDownload').onclick=this.selectMovieSize.bind(this,"medium");$('largeMovieDownload').onclick=this.selectMovieSize.bind(this,"large");}});require('core');Gallery.PagingView=Mac.View.extend({outlets:['paginationLabel','paginationInterface','paginationList','pagePrevArrow','pageNextArrow'],paginationLabel:Mac.LabelView.extend().outletFor("#paginationLabel"),paginationInterface:'#paginationInterface',pagePrevArrow:Mac.ButtonView.extend({action:function(){var currentPage=Gallery.photosController.get("currentPage");if(currentPage>0)
{this.owner.setPage(currentPage-1);}},enabledObserver:function()
{if((Gallery.photosController.get("currentPage")>0))
{this.set("isEnabled",true);this.title="_VisitorExperience.Pagination.PrevButton.Tooltip".loc();}
else
{this.set("isEnabled",false);this.title="";}}.observes('Gallery.photosController.currentPage')}).outletFor('#pagePrevArrow'),pageNextArrow:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.Pagination.NextButton.Tooltip",action:function(){var pageCount=Gallery.photosController.pageCount();var currentPage=Gallery.photosController.get("currentPage");if(pageCount>currentPage+1)
{this.owner.setPage(currentPage+1);}},enabledObserver:function()
{if(Gallery.photosController.get("currentPage")+1!=Gallery.photosController.pageCount())
{this.set("isEnabled",true);this.title="_VisitorExperience.Pagination.NextButton.Tooltip".loc();}
else
{this.set("isEnabled",false);this.title="";}}.observes('Gallery.photosController.currentPage')}).outletFor('#pageNextArrow'),currentPageObserver:function()
{this.renderPagination();}.observes('Gallery.photosController.currentPage'),isVisibleObserver:function()
{if(this.get("isVisible"))
{Gallery.workspace.toolBar.addClassName('paginationEnabled');this.renderPagination();}
else
{Gallery.workspace.toolBar.removeClassName('paginationEnabled');}}.observes('isVisible'),renderPagination:function()
{this.paginationInterface.innerHTML='';var pageCount=Gallery.photosController.pageCount();var currentPage=Gallery.photosController.get("currentPage");if(String.currentLanguage()=="Japanese")
{this.paginationLabel.set("content","_VisitorExperience.PaginationLabel".loc(pageCount,currentPage+1));}
else
{this.paginationLabel.set("content","_VisitorExperience.PaginationLabel".loc(currentPage+1,pageCount));}
for(var i=0;i<pageCount;i++)
{var aElm=document.createElement('a');aElm.onclick=this.setPage.bind(this,i);if(i==currentPage)
{Element.addClassName(aElm,'currentPage');}
else
{aElm.title="_VisitorExperience.Pagination.Dot.Tooltip".loc(i+1);}
aElm.innerHTML="&nbsp;";this.paginationInterface.appendChild(aElm);}
this.pagePrevArrow.set("isEnabled",(currentPage>0));this.pageNextArrow.set("isEnabled",(currentPage+1!=pageCount));},setPage:function(page)
{var idx=page*Gallery.photosController.get('pageSize');SC.Routes.set("location",{sel:idx,route:SC.Routes.get("location")});}});require('views/detail_view');require('views/grid_view');require('views/index');require('views/mosaic_view');require('views/carousel_view');require('views/carouseljs_view');require('views/gridfs_view');require('views/slideshow_view');require('views/imovie_view');require('views/tellafriend_panel');require('views/mobile_panel');require('views/contribute_panel');require('views/syndication_panel');require('views/download_panel');require('views/downloadmovie_panel');require('views/paging_view');Gallery.Workspace=Mac.WorkspaceView.extend({areas:['header','content','footer'],init:function(){arguments.callee.base.call(this);this.registerDependentKey('showPagination','nowShowing');this.registerDependentKey('atHome','nowShowing');this.registerDependentKey('isMovieNotShowTitle','nowShowing');this.registerDependentKey('isNotAlbum','nowShowing');this.registerDependentKey('isPrivateAlbum','nowShowing');this.registerDependentKey('showToolBar','showToolBarBool');this.registerDependentKey('showToolBar','nowShowing');this.registerDependentKey('showSlider','nowShowing');this.registerDependentKey('enableColorPicker','nowShowing');this.registerDependentKey('showAlbumOptionsButton','nowShowing');this.registerDependentKey('showAlbumWidgetButton','nowShowing');this.registerDependentKey('isFirefoxWinCarousel','nowShowing');this.registerDependentKey('showAddToAlbumButton','nowShowing');this.registerDependentKey('showMobileButton','nowShowing','showMobile');this.registerDependentKey('showSubscribeButton','nowShowing','hasPhotocastPlugin');this.registerDependentKey('hasPhotos','nowShowing');this.registerDependentKey('moreThan100Items','nowShowing');this.registerDependentKey('indexTitle','nowShowing','atHome');this.registerDependentKey('albumCount','nowShowing','atHome');this.registerDependentKey('albumDescription','nowShowing','atHome');if(SC.isIE())document.getElementsByTagName("HTML")[0].style.overflow="hidden";},outlets:['albumLabelContainer','homeButton','viewControls','detailView','albumOptionsButton','toolBar','imovieTab','imovieButton','gridTab','gridButton','carouselTab','carouseljsTab','gridfsTab','carouseljsButton','slideshowTab','slideshowButton','mosaicTab','mosaicButton','indexTab','indexButton','sliderView','indexLabel','colorPicker','footerBar','logoButton','paginationView','headerBar','uploader','galleryLastUpdate','galleryLastUpdateValue','gallerySubscribeLinkBtn'],showToolBarBool:true,_lastExitedDetailViewViaClickOnPhotoDate:0,uploader:Mac.Uploader.extend({}).outletFor('#osCheckFlashView'),logoButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.GalleryBranding.Tooltip",action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor("#logoButton"),headerBar:Mac.View.extend({isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isFullscreen')}).outletFor("#headerBar"),sliderView:Mac.SliderView.extend({valueBinding:'Gallery.workspace*content.scale',minimumBinding:'Gallery.workspace*content.minScale',maximumBinding:'Gallery.workspace*content.maxScale',value:0,isEnabledBinding:'Gallery.workspace.showSlider',resetSliderObserver:function(){setTimeout(this.configureSlider.bind(this),1);}.observes('isEnabled')}).outletFor("#sliderView"),footerBar:Mac.View.extend({isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum'),hideView:function(){Element.hide(this);if(SC.isFireFox())this.parentNode.style.display="none";else this.style.display="none";},showView:function(){Element.show(this);if(SC.isFireFox())this.parentNode.style.display="inline";else this.style.display="block";}}).outletFor("#footerBar"),paginationView:Gallery.PagingView.extend({isVisibleBinding:'Gallery.workspace.showPagination'}).outletFor("#paginationView"),homeButton:Mac.ButtonView.extend({outlets:['label'],localize:false,action:function()
{if(Gallery.workspace.get("nowShowing")!="imovie")
{Gallery.workspace.gridTab.gridView.set("scroll",0);Gallery.workspace.mosaicTab.mosaicGrid.set("scroll",0);var allPhotos=Gallery.albumController.get('allPhotos').get('records')||[];allPhotos.each(function(photo)
{photo.visitDate=new Date().getTime();});if(Gallery.workspace.gridTab.gridView&&Gallery.workspace.gridTab.gridView.childViews)
{for(var i=0;i<Gallery.workspace.gridTab.gridView.childViews.length;i++)
{Gallery.workspace.gridTab.gridView.childViews[i].renderVisitedState();}}}
SC.Routes.set('location','gallery');},label:Mac.LabelView.extend({localize:true,formatter:function(str){var fin="";var url=Gallery.adaptor.get('currentURL');if(url.indexOf(Gallery.accountName+'/')!=-1)
{var oldTitle=$("indexLabel").innerHTML;if(oldTitle!="")
str=oldTitle.unescapeHTML();}
if(str.length>19){Gallery.workspace.homeButton.set("toolTip",str);str=str.substr(0,16);fin=str.trim()+"...";}else{Gallery.workspace.homeButton.set("toolTip","");fin=str;}
if(!SC.isFireFox3()){var t=document.createElement("span");t.innerHTML=fin;t.style.cssText="font-size: 13px; font-weight: bold;";$("desktop").appendChild(t);var w=t.offsetWidth;Element.remove(t);var button=$("homeButton").getElementsByClassName("large")[0];button.style.width=Math.max(100,w+5)+"px";}
return fin;},contentBinding:"Gallery.defaults.title"}).outletFor(".label?"),isVisibleBinding:'Gallery.workspace.showHomeButton'}).outletFor('#homeButton'),showHomeButton:function()
{if(Gallery.albumController.get('isPrivate')===null)return false;return!Gallery.albumController.get('isPrivate')&&!Gallery.albumController.get('userHidden')&&this.get('nowShowing')!='index';}.property('nowShowing'),albumOptionsButton:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip",localize:true,action:function(ev){if(this.owner.get("showToolBarBool")){this.owner.set("showToolBarBool",false);this.set("toolTip","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip");this.set("labelText","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button");if(Gallery.workspace.get("nowShowing")=="mosaic")setTimeout("Gallery.workspace.mosaicTab.mosaicDetail.resizeHandler()",1000);if(Gallery.workspace.get("nowShowing")=="slideshow")setTimeout("Gallery.workspace.slideshowTab.slideshowView.slideshowImageView.resizeHandler()",1000);}else{this.owner.set("showToolBarBool",true);this.set("toolTip","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button.Tooltip");this.set("labelText","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button");if(Gallery.workspace.get("nowShowing")=="mosaic")Gallery.workspace.mosaicTab.mosaicDetail.resizeHandler();if(Gallery.workspace.get("nowShowing")=="slideshow")Gallery.workspace.slideshowTab.slideshowView.slideshowImageView.resizeHandler();}},isVisibleBinding:'Gallery.workspace.showAlbumOptionsButton'}).outletFor("#albumOptionsButton"),albumLabelContainer:Mac.View.extend({outlets:['albumLabel','albumCountLabel','albumDescriptionLabel'],isVisibleBinding:Mac.Binding.Not('Gallery.workspace.atHome'),albumLabel:Mac.LabelView.extend({contentBinding:Mac.Binding.From('Gallery.albumController.title',{multiplePlaceholderBinding:''})}).outletFor('#albumLabel'),albumCountLabel:Mac.LabelView.extend({escapeHTML:false,isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum'),contentBinding:'Gallery.workspace.albumCount'}).outletFor('#albumCountLabel'),albumDescriptionLabel:Mac.LabelView.extend({escapeHTML:false,isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum'),contentBinding:'Gallery.workspace.albumDescription',formatter:function(str)
{if(str&&str!=''&&str!=SC.Binding.MULTIPLE_PLACEHOLDER){str=str.escapeHTML();$("albumLabelContainer").addClassName("desc");if(str.length>66){Gallery.workspace.albumLabelContainer.set("toolTip",str);str=str.substr(0,65);str=str.replace(/\w+$/,'');str=str.trim()+"&hellip;";}}
else{$("albumLabelContainer").removeClassName("desc");Gallery.workspace.albumLabelContainer.set("toolTip","");}
return str;}}).outletFor('#albumDescriptionLabel')}).outletFor('#albumLabelContainer'),indexLabel:Mac.LabelView.extend({isVisibleBinding:Mac.Binding.Flag('Gallery.workspace.atHome'),formatter:function(str){var url=Gallery.adaptor.get('currentURL');if(url.indexOf(Gallery.accountName+'/')!=-1)
{var oldTitle=$("indexLabel").innerHTML;if(oldTitle!="")
{str=oldTitle.unescapeHTML();}}
return str;},didClick:function(evt)
{if(evt.shiftKey&&evt.altKey)
Gallery.badging.setupLocalStorage();else if(evt.shiftKey)
Gallery.badging.clearLocalStorage();},contentBinding:Mac.Binding.From('Gallery.defaults.title',{multiplePlaceholderBinding:''})}).outletFor('#indexLabel'),galleryLastUpdate:Mac.LabelView.extend({localize:true,isVisibleBinding:"Gallery.workspace.atHome",contentBinding:'_VisitorExperience.Visited.LastUpdate'}).outletFor("#galleryLastUpdate"),galleryLastUpdateValue:Mac.LabelView.extend({localize:true,isVisibleBinding:"Gallery.workspace.atHome",contentBinding:'_VisitorExperience.Visited.Calculating'}).outletFor("#lastUpdate"),gallerySubscribeLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.GalleryPage.Subscribe.Button.Tooltip",isVisibleBinding:"Gallery.workspace.atHome",action:function()
{Gallery.workspace.toolBar.subscribeButton.action();}}).outletFor("#gallerySubscribeLinkBtn"),toolBar:Mac.View.extend({outlets:['addButton','mobileButton','tellAFriendButton','downloadButton','subscribeButton'],animateVisible:function(){return!this.isFirefoxWinCarousel;}.property(),isFirefoxWinCarousel:false,isFirefoxWinCarouselBinding:'Gallery.workspace.isFirefoxWinCarousel',visibleAnimation:{hidden:'height: 0px',visible:'height: 52px',duration:200},isAnimationEnabled:function(){return!this.isFirefoxWinCarousel;}.property(),showView:function(){if(Gallery.workspace.get("nowShowing")=="index"){Element.show(this);}else{if(Gallery.albumController.get("isVideo"))
{this.downloadButton.set("toolTip","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip");}
else
{this.downloadButton.set("toolTip","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip");}
arguments.callee.base.call(this);}
setTimeout(function(){Gallery.workspace.addClassName("toolbarOpen");},250);if(this.recenterToolbar)
setTimeout(this.recenterToolbar.bind(this),1);},hideView:function(){if(Gallery.workspace.get("nowShowing")=="index"){Element.hide(this);}else{arguments.callee.base.call(this);}
Gallery.workspace.removeClassName("toolbarOpen");},lastPage:0,currentPageObserver:function()
{if(this.get("lastPage")!=Gallery.photosController.get("currentPage"))
{Gallery.workspace.gridTab.gridView.set("scroll",0);Gallery.workspace.mosaicTab.mosaicGrid.set("scroll",0);this.set("lastPage",Gallery.photosController.get("currentPage"));}}.observes("Gallery.photosController.currentPage"),recenterToolbarObserver:function(){var n=0;if(this.addButton.get('isVisible'))n++;if(this.mobileButton.get('isVisible'))n++;if(this.tellAFriendButton.get('isVisible'))n++;if(this.downloadButton.get('isVisible'))n++;if(this.subscribeButton.get('isVisible'))n++;if($("toolBarContainer")!=null)$("toolBarContainer").setStyle({marginLeft:Math.floor(-120*n/2)+"px",width:"680px"});}.observes('Gallery.workspace.toolBar.addButton.isVisible','Gallery.workspace.toolBar.mobileButton.isVisible','Gallery.workspace.toolBar.subscribeButton.isVisible'),addButton:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button.Tooltip",action:function(ev){if(Gallery.hasDetailView()){Gallery.detailView().movieView.destroyMovie();}
var albumGuid='/'+(Gallery.albumController.get('path')||'').replace(/http:\/\/.*?\//,'');var albumName=Gallery.albumController.get('title');Gallery.cPanel().contributeTo(albumGuid,albumName);Gallery.cPanel().set("isVisible",true);},validate:function(){return Gallery.albumController.get('path')!=null;},isEnabledBinding:'Gallery.workspace.showAddToAlbumButton',isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum')}).outletFor('#addButton'),mobileButton:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button.Tooltip",localize:true,action:function(ev){if(Gallery.hasDetailView()){Gallery.detailView().movieView.makePanelSafe();}
Gallery.mobilePanel().set("isVisible",true);Gallery.mobilePanel().generateData();if(Gallery.albumController.get('viewIdentifier')===VIEW_APERTURE_ALBUM)
$('mobileInstructions').innerHTML='_VisitorExperience.AlbumOptions.MobilePosting.InstructionalTextAperture'.loc();else
$('mobileInstructions').innerHTML='_VisitorExperience.AlbumOptions.MobilePosting.InstructionalText'.loc();},validate:function(){return Gallery.albumController.get('path')!=null;},isEnabledBinding:'Gallery.workspace.showMobileButton',isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum')}).outletFor('#mobileButton'),tellAFriendButton:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button.Tooltip",localize:true,action:function(ev){if(Gallery.hasDetailView()){Gallery.detailView().movieView.makePanelSafe();}
Gallery.tellAFriendPanel().set("isVisible",true);Gallery.tellAFriendPanel().generateData();}}).outletFor('#tellAFriendButton'),downloadButton:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip",localize:true,action:function(){if(this.owner.owner.get('nowShowing')=='imovie'){var movieContent=Gallery.detailView().movieView.get("content");var contentCount=(movieContent.get("videoSmall")?1:0)+(movieContent.get("videoMedium")?1:0)+(movieContent.get("videoLarge")?1:0);if(contentCount==0&&movieContent.get("videoMobile"))
{window.location.href=Gallery.detailView().movieView.get("content").get("videoMobile")+"?disposition=download";}
else if(contentCount>0)
{if(Gallery.hasDetailView()){Gallery.detailView().movieView.makePanelSafe();}
Gallery.downloadMoviePanel().set("isVisible",true);Gallery.downloadMoviePanel().generateData();}}else{if(Gallery.hasDetailView())Gallery.detailView().movieView.makePanelSafe();Gallery.downloadPanel().downloadFrom('album');Gallery.downloadPanel().set("isVisible",true);}},isEnabledBinding:Mac.Binding.Flag('Gallery.albumController.download')}).outletFor('#downloadButton'),showingSyndicationPanel:false,subscribeButton:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button.Tooltip",localize:true,action:function(){if(Gallery.hasDetailView()){Gallery.detailView().movieView.makePanelSafe();}
Gallery.workspace.set("showingSyndicationPanel",true);Gallery.syndicationPanel().set("isVisible",true);Gallery.syndicationPanel().generateData();document.body.onselectstart=function(){return true;};},isEnabledBinding:Mac.Binding.Not('Gallery.workspace.isPrivateAlbum'),isVisibleBinding:Mac.Binding.Flag('Gallery.workspace.showSubscribeButton')}).outletFor('#subscribeButton'),isVisibleBinding:'Gallery.workspace.showToolBar'}).outletFor('#toolBar'),closePanels:function(){var open=['c','mobile','tellAFriend','download','downloadMovie','syndication'].map(function(p){p=(Gallery['has%@Panel'.format(p.capitalize())]())?Gallery[p+'Panel']():null;return(p&&p.get('isVisible'))?p:null;}).compact();open.invoke('set','isVisible',false);},viewControls:Mac.View.extend({outlets:["gridBtn","mosaicBtn","carouseljsBtn","slideshowBtn","imovieBtn"],saveScrollPositions:function()
{if(Gallery.workspace.get("nowShowing")=="mosaic")
{Gallery.workspace.mosaicTab.mosaicGrid.set("scroll",Gallery.workspace.mosaicTab.mosaicGrid.scrollTop);}
else if(Gallery.workspace.get("nowShowing")=="grid")
{Gallery.workspace.gridTab.gridView.set("scroll",Gallery.workspace.gridTab.gridView.parentNode.parentNode.scrollTop);}},gridBtn:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link.Tooltip",localize:true,action:function(){Gallery.workspace.viewControls.saveScrollPositions();SC.Routes.set('location',{route:SC.Routes.get('location'),view:Gallery.avoidGridfs()?"grid":"gridfs",sel:Gallery.currentPhotoSel()});}}).outletFor('#grid'),mosaicBtn:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link.Tooltip",localize:true,action:function(){Gallery.workspace.viewControls.saveScrollPositions();SC.Routes.set('location',{route:SC.Routes.get('location'),view:this.id,sel:Gallery.currentPhotoSel()});setTimeout("Gallery.workspace.mosaicTab.mosaicDetail.resizeHandler()",100);}}).outletFor('#mosaic'),carouseljsBtn:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link.Tooltip",localize:true,action:function(){Gallery.workspace.viewControls.saveScrollPositions();SC.Routes.set('location',{route:SC.Routes.get('location'),view:Gallery.avoidCarouseljs()?"carousel":this.id,sel:Gallery.currentPhotoSel()});}}).outletFor('#carouseljs'),slideshowBtn:Mac.ButtonView.extend({toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip",localize:true,action:function(){Gallery.goFullscreen({},"slideshow");}}).outletFor('#slideshow'),isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum')}).outletFor("#viewControls"),colorPicker:Mac.ButtonView.extend({selectedColor:'',outlets:["colorPickerLabel","white","ltgrey","dkgrey","black"],isEnabledBinding:"Gallery.workspace.enableColorPicker",init:function(){arguments.callee.base.call(this);},colorPickerLabel:Mac.LabelView.extend({localize:true}).outletFor(".label?"),white:Mac.ButtonView.extend({isEnabledBinding:"Gallery.workspace.enableColorPicker",gridText:Mac.LabelView.extend({localize:true}).outletFor("#gridText"),toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.White.Tooltip",localize:true,stopEvent:true,action:function(){Gallery.workspace.colorPicker.set("selectedColor",'white');$("hoverViewMenu").style.background="url(/g/images/gallery/ie6/hud_control/HUD-controls_bg_white.gif) top left no-repeat";}}).outletFor('#white'),ltgrey:Mac.ButtonView.extend({isEnabledBinding:"Gallery.workspace.enableColorPicker",mosaicText:Mac.LabelView.extend({localize:true}).outletFor("#mosaicText"),toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Gray.Tooltip",localize:true,stopEvent:true,action:function(){Gallery.workspace.colorPicker.set("selectedColor",'ltgrey');$("hoverViewMenu").style.background="url(/g/images/gallery/ie6/hud_control/HUD-controls_bg_ltgrey.gif) top left no-repeat";}}).outletFor('#ltgrey'),dkgrey:Mac.ButtonView.extend({isEnabledBinding:"Gallery.workspace.enableColorPicker",carouselText:Mac.LabelView.extend({localize:true}).outletFor("#carouselText"),toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.DarkGray.Tooltip",localize:true,stopEvent:true,action:function(){Gallery.workspace.colorPicker.set("selectedColor",'dkgrey');$("hoverViewMenu").style.background="url(/g/images/gallery/ie6/hud_control/HUD-controls_bg_dkgrey.gif) top left no-repeat";}}).outletFor('#dkgrey'),black:Mac.ButtonView.extend({isEnabledBinding:"Gallery.workspace.enableColorPicker",slideshowText:Mac.LabelView.extend({localize:true}).outletFor("#slideshowText"),toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Black.Tooltip",localize:true,isSelected:true,stopEvent:true,action:function(){Gallery.workspace.colorPicker.set("selectedColor",'black');$("hoverViewMenu").style.background="url(/g/images/gallery/ie6/hud_control/HUD-controls_bg.gif) top left no-repeat";}}).outletFor('#black'),selectedColorObserver:function(){var selectedColor=this.get('selectedColor');var _oldColor=this.get('_oldSelecedColor');if(selectedColor==this._oldSelectedColor){this.get(selectedColor).set('isSelected',true);return;}
var desktop=$('desktop');this.get(this._oldSelectedColor).set('isSelected',false);desktop.addClassName("bg_"+selectedColor);desktop.removeClassName("bg_"+this._oldSelectedColor);this.get(selectedColor).set('isSelected',true);this.set('_oldSelectedColor',selectedColor);Gallery.workspace.viewControls.saveScrollPositions();SC.Routes.set('location',{route:SC.Routes.get('location'),bgcolor:selectedColor});}.observes('selectedColor'),_oldSelectedColor:'black',isVisibleBinding:Mac.Binding.Not('Gallery.workspace.isNotAlbum')}).outletFor("#colorPicker"),gridfsTab:Gallery.GridfsWorkspaceView.outletFor('#gridfsWorkspace'),gridTab:Gallery.GridWorkspaceView.outletFor('#gridViewWorkspace'),gridButton:'#grid',imovieTab:Gallery.iMovieWorkspaceView.outletFor('#imovieWorkspace'),imovieButton:'#imovie',carouseljsTab:Gallery.CarouseljsWorkspaceView.outletFor('#carouseljsWorkspace'),carouseljsButton:'#carouseljs',carouselTab:Gallery.CarouselWorkspaceView.outletFor('#carouselWorkspace'),mosaicTab:Gallery.MosaicWorkspaceView.outletFor('#mosaicWorkspace'),mosaicButton:'#mosaic',slideshowTab:Gallery.SlideshowWorkspaceView.outletFor('#slideshowWorkspace'),slideshowButton:'#slideshow',indexTab:Gallery.IndexWorkspaceView.outletFor('#indexWorkspace'),indexButton:'#homeButton',hideoverflowObserver:function(){if(['mosaic','carousel','carouseljs','gridfs','slideshow'].include(Gallery.workspace.get('nowShowing'))){Gallery.workspace.addClassName("hideoverflow");}else{Gallery.workspace.removeClassName("hideoverflow");}}.observes('Gallery.workspace.nowShowing'),errorGettingDataView:Mac.View.extend({outlets:['errorGettingDataText','errorGettingDatalearnMoreBtn','dotmacGalleryButton','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],errorGettingDataText:Mac.LabelView.extend({localize:true}).outletFor("#errorGettingDataText"),errorGettingDatalearnMoreBtn:Mac.ButtonView.extend({outlets:["errorGettingDataLearnMoreText"],errorGettingDataLearnMoreText:Mac.LabelView.extend({localize:true}).outletFor("#errorGettingDataLearnMoreText"),action:function(){var currentLoc=window.location;window.location=location.protocol+"//"+location.host+Gallery.homepath();if(currentLoc=window.location)
{setTimeout(this.relocate.bind(this),100);}},relocate:function()
{window.location=location.protocol+"//"+location.host+Gallery.homepath();}}).outletFor("#errorGettingDatalearnMoreBtn"),dotmacGalleryButton:Mac.ButtonView.extend({action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+580+',height='+500+',resizable=yes,scrollbars=yes,menubar=no,status=0,toolbar=0');}}).outletFor(".helpLinkBtn?")}),errorGettingDataObserver:function(){if(Gallery.workspace.get("errorGettingData")){var errorGettingData=this.errorGettingDataView.viewFor('errorGettingDataView');errorGettingData.removeClassName("hidden");$('workspace').set('isVisible',false);}}.observes('Gallery.workspace.errorGettingData'),stillPublishingView:Mac.View.extend({outlets:['stillPublishingText','stillPublishinglearnMoreBtn','dotmacGalleryButton','helpLinkBtn','tosLinkBtn','privacyLinkBtn'],stillPublishingText:Mac.LabelView.extend({localize:true}).outletFor("#stillPublishingText"),stillPublishinglearnMoreBtn:Mac.ButtonView.extend({outlets:["stillPublishingLearnMoreText"],stillPublishingLearnMoreText:Mac.LabelView.extend({localize:true}).outletFor("#stillPublishingLearnMoreText"),action:function(){var currentLoc=window.location;window.location=location.protocol+"//"+location.host+Gallery.homepath();if(currentLoc=window.location)
{setTimeout(this.relocate.bind(this),100);}},relocate:function()
{window.location=location.protocol+"//"+location.host+Gallery.homepath();}}).outletFor("#stillPublishinglearnMoreBtn"),dotmacGalleryButton:Mac.ButtonView.extend({action:function(){window.open("_VisitorExperience.AppleLogo.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".dotmacGalleryButton?"),tosLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_TermsOfService.Tooltip",action:function(){window.open("_TermsOfService.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".tosLinkBtn?"),privacyLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_PrivacyPolicy.Tooltip",action:function(){window.open("_PrivacyPolicy.Href".loc(),"_blank",'width='+1024+',height='+600+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".privacyLinkBtn?"),helpLinkBtn:Mac.ButtonView.extend({localize:true,toolTip:"_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip",action:function(){window.open("_VisitorExperience.IndexPage.HeaderFooter.Help.Href".loc(),"_blank",'width='+570+',height='+500+',resizable=yes,scrollbars=yes,menubar=yes,status=1,toolbar=1');}}).outletFor(".helpLinkBtn?")}),stillPublishingObserver:function(){if(Gallery.workspace.get("stillPublishing")){var stillPublishing=this.stillPublishingView.viewFor('stillPublishingView');stillPublishing.removeClassName("hidden");$('workspace').set('isVisible',false);}}.observes('Gallery.workspace.stillPublishing'),nowShowing:null,shouldShow:'index',indexTitle:function(){if(this.atHome){return Gallery.defaults.get('title');}else{return"";}}.property(),albumCount:function()
{var count=Gallery.albumController.get("numPhotos")+Gallery.albumController.get("numMovies");return(count>0?'(<span class="count">'+count+'</span>)':'');}.property(),albumDescription:function(){if(this.atHome){return Gallery.albumController.get('description');}else{return"";}}.property(),atHome:function(){return this.get('nowShowing')=='index';}.property(),isMovieNotShowTitle:function(){return(this.get('nowShowing')=='imovie'&&!Gallery.albumController.get('showTitle'));}.property(),isNotAlbum:function(){return(this.get('nowShowing')=='index'||this.get('nowShowing')=='imovie'||this.get('isFullscreen'));}.property(),showSlider:function(){return(this.get('nowShowing')=='grid'||this.get('nowShowing')=='gridfs'||this.get('nowShowing')=='mosaic');}.property(),showToolBar:function(){return(this.get('nowShowing')!='index'&&this.get("showToolBarBool"));}.property(),showAlbumOptionsButton:function(){return(this.get('nowShowing')!='index');}.property(),isPrivateAlbum:function(){return(this.get('nowShowing')!='index'&&Gallery.albumController.get('isPrivate'));}.property(),showAddToAlbumButton:function(){var ret=(this.get('nowShowing')!='index'&&Gallery.albumController.get('addPhoto')&&(Gallery.albumController.get('numPhotos')+Gallery.albumController.get('numMovies'))<500);var fi=(SC.isMacOSX()&&Gallery.workspace.uploader)?Gallery.workspace.uploader.get('flashInfo'):null;if(ret&&(fi==null)){setTimeout(function(){Gallery.workspace.propertyDidChange('showAddToAlbumButton');},1000);}
return(ret&&fi&&fi.os)?!(fi.os.indexOf('10.5.0')>=0):ret;}.property(),showMobileButton:function(){return(this.get('nowShowing')!='index'&&Gallery.albumController.get('showMobile'));}.property(),showAlbumWidgetButton:function(){return(this.get('nowShowing')!='index'&&(this.get('nowShowing')=='imovie'||Gallery.albumController.get('albumWidget')));}.property(),showSubscribeButton:function(){return(this.get('nowShowing')!='index'&&this.get('nowShowing')!='imovie');}.property(),hasPhotos:function(){return(this.get('nowShowing')!='index'&&this.get('nowShowing')!='imovie'&&((Gallery.albumController.get('numPhotos')&&Gallery.albumController.get('numPhotos')>0)||Gallery.albumController.get('isProtected')));}.property(),showPagination:function(){return((this.get('nowShowing')=='grid'||this.get('nowShowing')=='mosaic')&&Gallery.photosController.pageCount()>1);}.property(),enableColorPicker:function(){return(this.get('nowShowing')=='grid'||this.get('nowShowing')=='slideshow'||this.get('nowShowing')=='mosaic'||this.get('nowShowing')=='carousel'||this.get('nowShowing')=='carouseljs'||this.get('nowShowing')=='gridfs');}.property(),isFirefoxWinCarousel:function(){return(SC.isFireFox()&&SC.isWindows()&&(this.get('nowShowing')=='carousel'));}.property(),moreThan100Items:function(){return((Gallery.albumController.get('numPhotos')+Gallery.albumController.get('numMovies'))>1000);}.property(),isFullscreen:function(){return(window.name&&window.name.indexOf('_fullscreen')>=0);}.property(),goingToAlbumFromGallery:false,flipGoingToAlbumFromGalleryFlag:function()
{this.goingToAlbumFromGallery=false;}});indexRoute2=function(params)
{Gallery.fullscreen=(params.fullscreen=='true');if(Gallery.fullscreen&&(!SC.isIE()))
window.moveTo(0,0);if(Gallery.workspace)
Gallery.workspace.closePanels();if(Gallery.hasDetailView())
{if(Gallery.hasDetailView())Gallery.detailView().movieView.destroyMovie();Gallery.detailView().showPhotos(null,null,null,false);if(Gallery.detailView().isVideo&&Gallery.detailView().showOnIndex)
{$('desktop').appendChild(Gallery.detailView());}}
Gallery.indexController.set('content',[]);Gallery.indexController.set("selection",[]);Gallery.albumController.set('selection',[]);if(Gallery.workspace)
{Gallery.workspace.set("nowShowing","index");Gallery.workspace.removeClassName("albumView");Gallery.workspace.addClassName("indexView");}
if(!Gallery.fullscreen&&!Gallery.adaptor.afterLoad)
{if(isPreReno())Gallery.noScrubbing=true;Gallery.adaptor.set('albumsLoaded',true);Gallery.adaptor.request('refresh',Gallery.adaptor.truthQuery('album'));}
document.title="_DotMacWebGallery".loc()+" - "+Gallery.defaults.title;};indexRoute=function(params)
{SC.Benchmark._bench(indexRoute2.bind(this,params),'indexRoute');};SC.Routes.addRoute('',indexRoute);SC.Routes.addRoute('gallery',indexRoute);SC.Routes.addRoute(':album',function(params){Gallery.fullscreen=(params.fullscreen=='true');if(Gallery.fullscreen&&(!SC.isIE()))window.moveTo(0,0);Gallery.workspace.closePanels();if(Gallery.hasDetailView()){Gallery.detailView().movieView.destroyMovie();}
var album=Gallery.Album.findAll({route:params.album})[0];if(album)
{var guid=album.get('guid');if(!Gallery.badging.albumVisitInfo[guid])
{Gallery.badging.albumVisitInfo[guid]={visitDate:0,previousVisitDate:0,contentVersion:0,numPhotos:0};}
Gallery.badging.albumVisitInfo[guid].previousVisitDate=album.get('visitDate');Gallery.badging.saveAlbumVisitDate(guid,new Date().getTime());}
Gallery.workspace.removeClassName("indexView");Gallery.workspace.removeClassName("albumView");var view=params.view||'grid';if(!Gallery.fullscreen&&view=='slideshow')view='grid';if(Gallery.avoidCarouseljs()&&view=='carouseljs')view='carousel';if(!Gallery.avoidCarouseljs()&&view=='carousel')view='carouseljs';if(Gallery.avoidGridfs()&&view=='gridfs')view='grid';if(!Gallery.avoidGridfs()&&view=='grid')view='gridfs';if(!['grid','gridfs','mosaic','slideshow','carousel','carouseljs'].include(view)){view=Gallery.avoidGridfs()?'grid':'gridfs';}
if(!Gallery.fullscreen)
Gallery.workspace.set('nowShowing',view);if(view=='mosaic')
{Gallery.workspace.gridTab.gridView.parentNode.parentNode.scrollTop=0;}
else if(view=='grid')
{Gallery.workspace.mosaicTab.mosaicGrid.scrollTop=0;}
Gallery.workspace.goingToAlbumFromGallery=true;setTimeout("Gallery.workspace.flipGoingToAlbumFromGalleryFlag()",500);if(album)
{Gallery.workspace.addClassName("albumView");var sel=Gallery.indexController.get('selection');if(!sel||(sel.length!=1)||(sel[0]._guid!=album._guid))
{Gallery.indexController.set('selection',[album]);}
document.title="_DotMacWebGallery".loc()+" - "+Gallery.albumController.get('title');var color=params.bgcolor||Gallery.workspace.colorPicker.get("selectedColor")||'black';Gallery.workspace.colorPicker.set("selectedColor",color);var idx=parseInt(params.sel||0,0);if(idx<0)idx=0;var page=Math.floor(idx/Gallery.photosController.get('pageSize'));if(Gallery.photosController.get('currentPage')!=page)
Gallery.photosController.set('currentPage',page);if(Gallery.fullscreen)
{Gallery.adaptor.set('enableSpinner',false);Gallery.workspace.set('nowShowing',view);Gallery.adaptor.request('akamai',Gallery.adaptor.truthQuery('album'));}
if(Gallery.hasDetailView())
{Gallery.detailView().showPhotos(null,null,null,false);}}
else
{var movie=Gallery.Photo.findAll({route:params.album})[0];if(movie)
{Gallery.badging.saveAlbumVisitDate(movie.get('guid'),new Date().getTime());Gallery.indexController.set('selection',[movie]);Gallery.workspace.set('nowShowing','imovie');if(Gallery.fullscreen)
Gallery.adaptor.set('enableSpinner',false);if(!movie.get('isProtected')||Gallery.fullscreen)
{if(SC.isIE6())
setTimeout(showiMovieFromRoute.bind(this,movie),5000);else
{showiMovieFromRoute(movie);}}}
if(Gallery.detailPhotoController.get('showTitle'))
document.title="_DotMacWebGallery".loc()+" - "+Gallery.detailPhotoController.get('title');}
if(!Gallery.adaptor.afterLoad&&!Gallery.fullscreen){if(album){Gallery.adaptor.set('enableSpinner',!!!album.get('fullyLoaded'));album.set('fullyLoaded',true);}
Gallery.noScrubbing=false;if(isPreReno()&&album)Gallery.loadAlbumOnly=album.get('guid');var queryInfo=Gallery.adaptor.truthQuery('album');if(album&&album.get('isProtected'))
{Gallery.ignoreFocus=true;Gallery.adaptor.request('pwrefresh',queryInfo);}
else if(movie&&movie.get('isProtected')){Gallery.adaptor.request('pwrefresh',queryInfo);}
else{Gallery.adaptor.request('refresh',queryInfo);}}
else if(album){album.set('fullyLoaded',true);}});function showiMovieFromRoute(movie)
{movie.set('visitDate',new Date().getTime());Gallery.detailView().showPhotos(movie,[movie],null,false,true);}
SC.Routes.addRoute(':album/:photo',function(params){Gallery.fullscreen=(params.fullscreen=='true');Gallery.workspace.closePanels();var album=Gallery.Album.findAll({route:params.album})[0];var photoPath="%@/%@".format(params.album,params.photo);var photo=Gallery.Photo.findAll({route:photoPath})[0];if(photo)
photo.set('visitDate',new Date().getTime());if(album&&(Gallery.albumController.get('route')!=params.album)){Gallery.indexController.set('selection',[album]);}
if(photo&&(Gallery.detailPhotoController.get('route')!=photoPath)){var color=params.bgcolor||Gallery.workspace.colorPicker.get("selectedColor")||'black';Gallery.workspace.colorPicker.set("selectedColor",color);var photos=(album)?album.get('photos').get('records'):null;Gallery.detailView().showPhotos(photo,photos,null,false,true);}
if(Gallery.detailPhotoController.get('showTitle')){document.title="_DotMacWebGallery".loc()+" - "+Gallery.detailPhotoController.get('title');}
if(!Gallery.fullscreen&&Gallery.adaptor.get('initialLoad')){Gallery.adaptor.set('enableSpinner',true);Gallery.adaptor.request('refresh',Gallery.adaptor.truthQuery());}});Gallery.hasDetailView=function(){return Gallery.workspace&&Gallery.workspace.detailView;};Gallery.detailViewElement=$('detailView');Gallery.detailView=function(){if(!Gallery.hasDetailView()){if(Gallery.workspace!=null)
Gallery.workspace.detailView=Gallery.DetailView.viewFor(Gallery.detailViewElement);}
return Gallery.workspace.detailView;};['c','tellAFriend','mobile','syndication','download','downloadMovie'].each(function(panel){var def='Gallery.%@Element = $("%@Panel"); Gallery.%@Panel = function() { if (!Gallery._%@Panel) Gallery._%@Panel = Gallery.%@Panel.viewFor(Gallery.%@Element); return Gallery._%@Panel ; }; Gallery.has%@Panel = function() { return !!Gallery._%@Panel; };'.format(panel,panel,panel,panel,panel,panel.capitalize(),panel,panel,panel.capitalize(),panel);eval(def);});Gallery.currentPhotoSel=function(){var photoGuid=Gallery.selectedPhotoController.get('guid');var idx=0;if(photoGuid){var photo=Gallery.Photo.find(photoGuid);var album=photo.get('album');idx=album.get('allPhotos').get('records').indexOf(photo);}else{idx=Gallery.photosController.get('currentPage')*Gallery.photosController.get('pageSize');}
return idx;};var fullscreenOpen;Gallery.goFullscreen=function(value,view){if(!value)value={};value.fullscreen='true';value.route=SC.Routes.get('location');var parts=(value.route)?value.route.split('&'):[''];var route=parts.shift();var params={};parts.each(function(p){var bits=p.split('=');params[bits[0]]=bits[1];});for(var key in value){if(!value.hasOwnProperty(key))continue;if(key!='route'){params[key]=encodeURIComponent(''+value[key]);}}
parts=[route];for(var key in params){if(!params.hasOwnProperty(key))continue;parts.push([key,params[key]].join('='));}
value=parts.join('&');var loc=window.location.href.split('#').first()+'?fullscreen#'+value+(view=="slideshow"?'&view=slideshow':'');var windowName="_fullscreen";if(view=="movie"||view=="carousel"||view=="slideshow")
{windowName+="_"+view;}
if(Gallery.fullscreenOpen&&(!fullscreenOpen.closed))
{fullscreenOpen.close();}
fullscreenOpen=window.open('',windowName,'status=0,resize=0,toolbar=0,location=0,menubar=0, directories=0,scrollbars=0,width='+screen.availWidth+',height='+(screen.availHeight-21)+',left=0,right=0,top=0,screenX=0,screenY=0,fullscreen=1');var color=Gallery.workspace.colorPicker.get("selectedColor")||'black';if(color=='ltgrey'){color="#d9d9d9";}else if(color=='dkgrey'){color="#242424";}
fullscreenOpen.document.write('<meta http-equiv="refresh" content="0;url='+loc+'">');fullscreenOpen.document.write('<BODY BGCOLOR="'+color+'">');fullscreenOpen.document.write("</BODY>");fullscreenOpen.document.write("</HTML>");fullscreenOpen.document.close();Gallery.fullscreenOpen=true;if(Gallery.workspace.carouseljsTab&&Gallery.workspace.carouseljsTab.carouseljs&&Gallery.workspace.carouseljsTab.carouseljs.iFrame&&Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow&&Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow.F)Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow.F.pause();};require('core');if(Gallery.useDowner){var ImageLoadeeStuffs={className:"ImageLoadee",url:null,requested:false,completed:false,erred:false,aborted:false,group:null,thread:null,importance:0,proximityAdjust:0,onload:null,onerror:null,image:null,image2:null,overwritable:true,append:false,forPrecache:false,init:function(){if(!this.url){return;}},load:function(){if(this.completed)return;this.requested=true;this.image=document.createElement('img');this.image.style.cssText="position:absolute; left:-10000px; top:-10000px; z-index:-10; visibility:hidden;";if(this.append)document.body.appendChild(this.image);this.image.onload=this.loaded.bind(this);this.image.onerror=this.erred.bind(this);this.image.src=this.url;},erred:function(event,secondLoad){if(SC.isSafari3()&&!secondLoad&&this.forPrecache){this.funkySafariSecondLoad();return;}
this.completed=true;this.erred=true;for(var i in this){if(i.indexOf('onerror')!=-1&&typeof this[i]=='function'){this[i]();this[i]=null;if(typeof this["onload"+i.substring(7)]=='function'){this["onload"+i.substring(7)]=null;}}}
this.width=this.image.width;this.height=this.image.height;if(this.image.parentNode)this.image.parentNode.removeChild(this.image);if(this.thread)this.thread.handleFinished();if(this.group)this.group.handleFinished(this);},loaded:function(event,secondLoad){if(SC.isSafari3()&&!secondLoad&&this.forPrecache){this.funkySafariSecondLoad();return;}
this.completed=true;this.erred=false;for(var i in this){if(i.indexOf('onload')!=-1&&typeof this[i]=='function'){this[i]();this[i]=null;if(typeof this["onerror"+i.substring(6)]=='function'){this["onerror"+i.substring(6)]=null;}}}
this.width=this.image.width;this.height=this.image.height;if(this.image.parentNode)this.image.parentNode.removeChild(this.image);if(this.image2&&this.image2.parentNode)this.image2.parentNode.removeChild(this.image2);if(this.thread)this.thread.handleFinished();if(this.group)this.group.handleFinished(this);},funkySafariSecondLoad:function(){this.image2=document.createElement('img');this.image2.style.cssText="position:absolute; left:-10000px; top:-10000px; z-index:-10; visibility:hidden;";if(this.append)document.body.appendChild(this.image2);this.image2.onload=function(){this.loaded(null,true);}.bind(this);this.image2.onerror=function(){this.erred(null,true);}.bind(this);this.image2.src=this.url;},needsAttention:function(){return this.requested==false&&this.completed==false;},enter:function(group,importance){if(this.completed)return this;if(!group)return false;group.add(this,importance);return this;},accommodate:function(hash){if(hash.url!=this.url)return;var marker=(new Date().valueOf())+Math.random();if(typeof hash.onload=='function')this["onload"+marker]=hash.onload;if(typeof hash.onerror=='function')this["onerror"+marker]=hash.onerror;delete hash.onload;delete hash.onerror;hash.forPrecache=hash.forPrecache||this.forPrecache;delete hash.requested;delete hash.completed;delete hash.aborted;delete hash.completed;delete hash.erred;delete hash.group;delete hash.thread;delete hash.proximityAdjust;delete hash.image;delete hash.image2;this.mixin(hash);if(!this.completed){if(hash.group){}}else{this.group=null;this.thread=null;if(ImageLoadee.loaderToRunCompletedLoadeeLoadedFunctions)ImageLoadee.loaderToRunCompletedLoadeeLoadedFunctions.runAtNextCheck(this.loaded.bind(this));else setTimeout(this.loaded.bind(this),0);}},toString:function(){return"[object ImageLoadee i="+this.importance+"]";}};window.mixin=function(obj,hash){for(var i in hash)obj[i]=hash[i];};ImageLoadeeStuffs.mixin=function(hash){mixin(this,hash);};ImageLoadee=function(hash){mixin(this,hash);this.init();return this;};ImageLoadee.prototype=ImageLoadeeStuffs;ImageLoadee._create=function(hash){window.loadeeCount++;var ret=new this(hash);ret.loadeeNumber=window.loadeeCount;return ret;};ImageLoadee.create=function(hash){if(!hash.url)return null;var existing=allImageLoadees[hash.url];if(existing&&existing.overwritable){existing.accommodate(hash);return existing;}else{var ret=ImageLoadee._create(hash);allImageLoadees[hash.url]=ret;return ret;}};window.allImageLoadees={};window.loadees=function(){var s="";for(var i in allImageLoadees)s+="\n"+i+": "+allImageLoadees[i];return s;};window.showLoadees=function(){alert(loadees());};window.loadeeCount=0;}
if(Gallery.useDowner){ImageThread=SC.Object.extend({className:"ImageThread",owner:null,waiting:false,loading:false,active:false,currentLoadee:null,loadedCount:0,_requestNextTimeout:null,start:function(){this.active=true;this.requestNext();return this;},requestNext:function(){if(this.loading)return;this.abortAnyScheduledRequest();this.currentLoadee=this.owner.getNext();if(this.currentLoadee==null){this.loading=false;this.terminate();return;}
this.loading=true;this.waiting=false;this.currentLoadee.thread=this;this.currentLoadee.load();},handleFinished:function(){this.currentLoadee=null;this.loading=false;if(this.active){this.waiting=true;this.abortAnyScheduledRequest();this._requestNextTimeout=setTimeout(this.requestNext.bind(this),this.owner.delay);}
this.loadedCount++;},terminate:function(){this.active=false;this.waiting=false;this.abortAnyScheduledRequest();},abortAnyScheduledRequest:function(){if(this._requestNextTimeout)clearTimeout(this._requestNextTimeout);this._requestNextTimeout=null;},toString:function(){return"[object ImageThread: "+(this.active?"A":"a")+(this.waiting?"W":"w")+(this.loading?"L":"l")+" count="+this.loadedCount+"]";}});}
if(Gallery.useDowner){ImageLoader=SC.Object.extend({className:"ImageLoader",threadCount:5,delay:0,group:null,threads:null,_checkerInterval:null,paused:null,init:function(){arguments.callee.base.call(this);this.group=ImageGroup.create();this.threads=[];for(var i=0;i<this.threadCount;i++)this.threads[i]=ImageThread.create({owner:this}).start();this._lastThreadCount=this.threadCount;this._checkerInterval=setInterval(this.checkAndHandlePhotosAdded.bind(this),200);this.existingLoadeeLoadedFunctions=[];},threadCountObserver:function(){if(this._lastThreadCount==this.threadCount)return;if(this._lastThreadCount<this.threadCount){for(var i=this._lastThreadCount;i<this.threadCount;i++)
this.threads.unshift(ImageThread.create({owner:this}).start());}else{var deletedThreads=this.threads.splice(0,this._lastThreadCount-this.threadCount);for(var i=0;i<deletedThreads.length;i++)deletedThreads[i].terminate();}
this._lastThreadCount=this.threadCount;}.observes('threadCount'),checkAndHandlePhotosAdded:function(){if(this.group.needsAttention()){for(var i=0;i<this.threads.length;i++)
if(!this.threads[i].active){this.threads[i].start();return;}}
if(this.existingLoadeeLoadedFunctions.length>0){for(var i=0;i<this.existingLoadeeLoadedFunctions.length;i++){this.existingLoadeeLoadedFunctions[i]();}
this.existingLoadeeLoadedFunctions.length=0;}},runAtNextCheck:function(func){this.existingLoadeeLoadedFunctions.push(func);},getNext:function(){if(this.paused)return null;return this.group.getNext();},toString:function(){return"[object ImageLoader]";}});}
if(Gallery.useDowner){ImageGroup=SC.Object.extend({name:"Untitled ImageGroup",className:"ImageGroup",importance:0,proximityAdjust:0,target:2147483647,pending:null,loaded:null,paused:false,init:function(){arguments.callee.base.call(this);this.pending=[];this.loaded=[];},getNext:function(){if(this.pending.length==0||this.paused)return null;var lowestDiff=-1;var winner=null;var winningIndex=-1;for(var i=0;i<this.pending.length;i++){var it=this.pending[i];if((it.importance===undefined)||(it.importance===null))it.importance=0;var diff=Math.abs(it.importance-this.target)+it.proximityAdjust;if(it.needsAttention()&&(diff<lowestDiff||lowestDiff==-1)){winner=it;lowestDiff=diff;winningIndex=i;}}
if(winningIndex==-1)return null;if(winner.className=="ImageGroup")return winner.getNext();else{winner.group=this;this.pending.splice(winningIndex,1);return winner;}},needsAttention:function(){if(this.paused)return false;for(var i=0;i<this.pending.length;i++)
if(this.pending[i].needsAttention())return true;return false;},add:function(obj,importance){this.pending.push(obj);if(!(importance===undefined)&&!(importance===null))obj.importance=importance+1-1;},handleFinished:function(loadee){},abortPending:function(){for(var i=0;i<this.pending.length;i++){var it=this.pending[i];if(it.className=="ImageGroup")it.abortPending();else{it.aborted=true;this.pending.splice(i,1);i--;}}},enter:function(group,importance){if(!group)return false;group.add(this,importance);return this;},toString:function(){return"[object ImageGroup "+this.name+"]";}});}
window.disableDowner=function(){if(Gallery.useDowner)return;window.ImageLoadee={};ImageLoadee.create=function(hash){var ret=document.createElement('img');ret.mixin=SC.Object.mixin;ret.mixin(hash);ret.src=ret.url;ret.image=ret;ret.enter=function(){return this;};return ret;};};disableDowner();require('core');require('checkpoint');require('adaptor');require('model/album');require('model/photo');require('views/workspace');require('config');require('downloader');if(window.name.indexOf('_fullscreen')>=0){Gallery.fullscreen=true;}
function main(){if(window.name.indexOf('_fullscreen')>=0)
{Gallery.fullscreen=true;SC.Store=window.opener.SC.Store;Gallery.Photo=window.opener.Gallery.Photo;Gallery.Album=window.opener.Gallery.Album;Gallery.selectedPhotoController=window.opener.Gallery.selectedPhotoController;Gallery.Workspace.gridTab=null;Gallery.Workspace.gridfsTab=null;Gallery.Workspace.mosaicTab=null;Gallery.Workspace.indexTab=null;Gallery.Workspace.carouseljsTab=null;switch(window.name)
{case"_fullscreen_movie":Gallery.speed=Gallery.speedTest();Gallery.Workspace.slideshowTab=null;Gallery.Workspace.carouselTab=null;break;case"_fullscreen_carousel":Gallery.Workspace.slideshowTab=null;break;case"_fullscreen_slideshow":Gallery.Workspace.carouselTab=null;if(SC.isIE())
{window.onunload=function(){if(window.opener)
window.opener.location.reload();};}
break;}}
var workspaceTRs=$("workspace").getElementsByTagName("TR");var second=workspaceTRs[1];var fourth=workspaceTRs[3];second.parentNode.removeChild(second);fourth.parentNode.removeChild(fourth);var after=$("workspace").getElementsByTagName("TR");if(!Gallery.avoidCarouseljs()&&Gallery.fullscreen!=true){var cjsif=document.createElement('iframe');cjsif.style.cssText="border:0px; z-index:9999; position:absolute; width:0px; height:0px; left:-10000px; top:-10000px; visibility:hidden;";cjsif.id="carouseljsframe";cjsif.setAttribute('name','cjsif');cjsif.setAttribute('border','0');cjsif.setAttribute('frameBorder','0');document.getElementsByTagName('body')[0].appendChild(cjsif);}
if(!Gallery.avoidGridfs()&&Gallery.fullscreen!=true){var gfsif=document.createElement('iframe');gfsif.style.cssText="border:0px; z-index:9999; position:absolute; width:0px; height:0px; left:-10000px; top:-10000px; visibility:hidden;";gfsif.id="gridfsframe";gfsif.setAttribute('name','gfsif');gfsif.setAttribute('border','0');gfsif.setAttribute('frameBorder','0');document.getElementsByTagName('body')[0].appendChild(gfsif);gfsif.src=Gallery.gridfsURL;}
if(Gallery.avoidGridfs())Gallery.Workspace.gridfsTab=null;SC.Benchmark._bench(main2,'main');}
function main2()
{if(reject)return;if(location.hostname.indexOf(DOMAIN)>=0&&Gallery.isLocalhost)
{location.hostname=HOST;return;}
if(location.hostname==HOST)
{Gallery.accountName=location.pathname.split('/')[1];}
else
{Gallery.accountName=Gallery.defaultUser;}
if(SC.isSafari3())
{Gallery.photosController.set("pageSize",100);}
else if(SC.isFireFox()||(SC.isSafari()&&!isPreReno()&&!SC.isSafari3()))
{Gallery.photosController.set("pageSize",50);}
else
{Gallery.photosController.set("pageSize",25);}
var path=Gallery.adaptor.get('initialPath').split('/');if(path.length>2)
{path.shift();window.location='/%@#%@'.format(path.shift(),path.join('/'));return;}
setWebGalleryLogo();Gallery.workspace=Gallery.Workspace.viewFor("workspace");Gallery.workspace.removeClassName('hidden');if(!Gallery.fullscreen)
{Gallery.workspace.indexTab.loadingView.Loading.set('isVisible',true);}
else
{Gallery.workspace.headerBar.set("isVisible",false);}
Gallery.workspace.set('hasPhotocastPlugin',HAS_PHOTOCAST_PLUGIN);document.body.scroll="no";if(typeof document.body.onselectstart!="undefined")
{document.body.onselectstart=function()
{return false;};}
else if(typeof document.body.style.MozUserSelect!="undefined")
{document.body.style.MozUserSelect="none";}
else
{document.body.onmousedown=function()
{return false;};}
if(!Gallery.fullscreen)
{Gallery.updateInterval=INITIAL_UPDATE_INTERVAL;Gallery.testingForUpdate=false;Gallery.updateService=new PeriodicalExecuter(tryUpdateGallery,INITIAL_UPDATE_INTERVAL);Gallery.lastUpdate=new Date().valueOf();window.onfocus=function(e)
{tryUpdateGallery(e);if(Gallery.workspace.get('nowShowing')=='carouseljs'&&Gallery.workspace.carouseljsTab&&Gallery.workspace.carouseljsTab.carouseljs&&Gallery.workspace.carouseljsTab.carouseljs.iFrame&&Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow&&Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow.F)Gallery.workspace.carouseljsTab.carouseljs.iFrame.contentWindow.F.resume();try
{Gallery.workspace.carouseljsTab.carouseljs.closePopup();}
catch(f)
{}};window.onblur=function()
{Gallery.windowBlurred=true;};Gallery.Checkpoint.mark('initialized');}
if(SC.isFireFox3())document.body.addClassName("firefox3");if(SC.isFireFox2())document.body.addClassName("firefox2");if(SC.isIE6())document.body.addClassName("ie6");if(SC.isIE7())document.body.addClassName("ie7");if(SC.isSafari()&&!SC.isSafari3())document.body.addClassName("safari2");if(SC.isSafari3())document.body.addClassName("safari3");}
function tryUpdateGallery(e){if(!Gallery.testingForUpdate&&!Gallery.blockUpdate){var isFocusSource=false;if(e&&e.type=='focus'&&Gallery.windowBlurred&&!(Gallery.ignoreFocus)){isFocusSource=true;}
Gallery.windowBlurred=false;Gallery.testingForUpdate=true;var now=new Date().valueOf();var lapsedTime=Math.ceil((now-Gallery.lastUpdate)/1000);if(shouldSynchronize||lapsedTime>Gallery.updateInterval||isFocusSource){updateGallery(shouldSynchronize);shouldSynchronize=false;}}
Gallery.testingForUpdate=false;}
function updateGallery(shouldSynchronize)
{var location=SC.Routes.get('location');var view=Gallery.workspace.get('nowShowing');if(!['grid','gridfs','mosaic','index'].include(view)||(Gallery.workspace.detailView&&Gallery.workspace.detailView.get('isVisible')))return;if(shouldSynchronize)
{Gallery.adaptor.request('refresh',Gallery.adaptor.truthQuery('1',true));}
else
{var depth=(view=='index')?'album':'1';Gallery.adaptor.request('refresh',Gallery.adaptor.truthQuery(depth));}
Gallery.lastUpdate=new Date().valueOf();Gallery.ignoreFocus=false;setNextGalleryUpdate();}
function setNextGalleryUpdate()
{Gallery.updateService.stop();if(Gallery.windowBlurred)
{Gallery.updateInterval=Math.min(Gallery.updateInterval*2,MAXIMUM_UPDATE_INTERVAL);Gallery.updateService=new PeriodicalExecuter(tryUpdateGallery,Gallery.updateInterval);}
else
{Gallery.updateInterval=MINIMUM_UPDATE_INTERVAL;Gallery.updateService=new PeriodicalExecuter(tryUpdateGallery,Gallery.updateInterval);}}
function isPreReno()
{if(Prototype.Browser.WebKit)
{return parseFloat(navigator.appVersion.replace(/^.*?AppleWebKit\/(\d+.\d+).*?$/,'$1'),0)<419.3;}
return false;}
function setWebGalleryLogo()
{var lang="en";switch(String.currentLanguage())
{case"Japanese":lang="jp";break;case"German":lang="de";break;case"French":lang="fr";break;}
Element.addClassName($('stillPublishingButton'),"watermark_"+lang);Element.addClassName($('errorGettingDataButton'),"watermark_"+lang);Element.addClassName($('emptyGalleryButton'),"watermark_"+lang);Element.addClassName($('noSuchAlbumButton'),"watermark_"+lang);Element.addClassName($('authRequiredButton'),"watermark_"+lang);Element.addClassName($('galleryButton'),"watermark_"+lang);Element.addClassName($('iMovieGalleryButton'),"watermark_"+lang);}
if(Gallery.useDowner){Gallery.maxViewImportance=5;Gallery.downer=ImageLoader.create({threadCount:Gallery.fullscreen?Gallery.imageThreadCount:Math.min(Gallery.imageThreadCount,3),delay:Gallery.imageThreadDelay,nowShowingObserver:function(){var nows=Gallery.workspace.get('nowShowing');var group=Gallery[nows+"Loadees"];if(group)group.importance=(Gallery.maxViewImportance++);this.paused=(nows=="gridfs")||(nows=="carouseljs");}.observes("Gallery.workspace.nowShowing")});Gallery.gridLoadees=ImageGroup.create({name:"Grid Loadee Group"}).enter(Gallery.downer.group);Gallery.mosaicLoadees=ImageGroup.create({name:"Moasic Loadee Group"}).enter(Gallery.downer.group);Gallery.mosaicWebLoadees=ImageGroup.create({name:"Mosaic Web Loadee Group: Low Priority",importance:-200000}).enter(Gallery.mosaicLoadees);Gallery.indexLoadees=ImageGroup.create({name:"Index Loadee Group"}).enter(Gallery.downer.group);Gallery.backgroundLoadees=ImageGroup.create({name:"Low Priority Loadee Group",importance:-1}).enter(Gallery.downer.group);Gallery.slideshowLoadees=ImageGroup.create({name:"Slideshow Loadee Group",importance:0});if(Gallery.fullscreen)Gallery.slideshowLoadees.enter(Gallery.downer.group);ImageLoadee.loaderToRunCompletedLoadeeLoadedFunctions=Gallery.downer;}
Gallery.Checkpoint.reset('initialized');Gallery.Checkpoint.reset('contentLoading');Gallery.Checkpoint.reset('pageRendered');require('main');Gallery.adaptor=Mac.Adaptor.create({init:function()
{arguments.callee.base.apply(this,arguments);this.registerDependentKey('isLoading','showSpinner');this.registerDependentKey('isLoading','enableSpinner');},base:'/',tokens:null,namespaces:['Gallery','Mac'],requests:{home:{action:homepath,method:'get',onSuccess:loadModel,onError:reportCode,useSpinner:true,onFailure:reportCode},pwrefresh:{action:jsonpath,method:'get',onSuccess:loadModel,onError:reportCode,useSpinner:true,onFailure:reportCode,useEtag:false},refresh:{action:jsonpath,method:'get',onSuccess:loadModel,onError:reportCode,useSpinner:true,onFailure:reportCode},akamai:{action:jsonpath,method:'get',onSuccess:Prototype.emptyFunction,onError:Prototype.emptyFunction,useSpinner:false,onFailure:Prototype.emptyFunction},exif:{action:exifpath,method:'get',onSuccess:insertExif,onFailure:missingExif}},initialLoad:true,initialPath:encodeURI(decodeURI(location.pathname.replace('\/$',''))),prefix:location.protocol+'//'+location.hostname,truthQuery:function(depth,sync)
{var query={'webdav-method':'truthget','feedfmt':'json'};if(depth)
{query.depth=depth;};if(sync)
{query.synchronize='true';};if(Gallery.prettyJSON)
{query.pretty='true';};return query;},ownerLabel:function()
{return"_VisitorExperience.AlbumPage.HeaderFooter.OwnerLoggedInAs".loc(Gallery.accountName);}.property(),enableSpinner:true,albumsLoaded:false,isLoading:function()
{return this.get('showSpinner')&&this.get('enableSpinner');}.property(),mapRecordsToNamespaces:function(records)
{var ret=[];var keyPaths={};var photoPerAlbum={};records.each(function(record,index)
{switch(record.viewIdentifier)
{case VIEW_APERTURE_ALBUM:case VIEW_IPHOTO_ALBUM:record.recordType=Gallery.Album;if(Gallery.noScrubbing&&record.keyImagePath)
{keyPaths[record.keyImagePath]=true;}
record.description=record.content||'';ret.push(record);break;case VIEW_IMOVIE_MOVIE:case VIEW_SLIDESHOW:record.recordType=Gallery.Photo;ret.push(record);break;default:record.recordType=Gallery.Photo;if(Gallery.noScrubbing==true)
{if((keyPaths[record.url]==true)||(!photoPerAlbum[record.album]))
{photoPerAlbum[record.album]=record;}}
else if((location.hostname==HOST)||(Gallery.loadAlbumOnly==null)||(record.album==Gallery.loadAlbumOnly))
{ret.push(record);}
else
{}}});if(Gallery.noScrubbing==true)
{for(var album in photoPerAlbum)
{if(photoPerAlbum.hasOwnProperty(album))ret.push(photoPerAlbum[album]);}}
Gallery.noScrubbing=false;Gallery.loadAlbumOnly=null;records.length=0;return ret;},jsonpath:function()
{if(Gallery.isLocalhost)
{Gallery.adaptor.set('prefix','http://'+HOST);Gallery.adaptor.set('initialPath','/'+Gallery.adaptor.get('initialPath').split('/').slice(2).join('/'));return'xhr/'+getRouteAsPath().replace('gallery',Gallery.defaultUser);}
return getRouteAsPath();}});Gallery.noScrubbing=false;Gallery.loadAlbumOnly=null;function jsonpath()
{if(Gallery.isLocalhost)
{Gallery.adaptor.set('prefix','http://'+HOST);Gallery.adaptor.set('initialPath','/'+Gallery.adaptor.get('initialPath').split('/').slice(2).join('/'));if(Gallery.enableFixtures)
{console.log('Using fixture data:  _idisk_ui/xhr/'+Gallery.fixtureFile);return'_idisk_ui/xhr/'+Gallery.fixtureFile;}
else
{return'xhr/'+getRouteAsPath().replace('gallery',Gallery.defaultUser);}}
return getRouteAsPath();}
function homepath()
{if(Gallery.isLocalhost)
{Gallery.adaptor.set('prefix','http://'+HOST);Gallery.adaptor.set('initialPath','/'+Gallery.adaptor.get('initialPath').split('/').slice(2).join('/'));return'xhr/'+Gallery.accountName;}
return Gallery.accountName;}
function exifpath()
{if(Gallery.isLocalhost)
{Gallery.adaptor.set('prefix','http://'+HOST);Gallery.adaptor.set('initialPath','/'+Gallery.adaptor.get('initialPath').split('/').slice(2).join('/'));return'xhr/'+Gallery.defaultUser+'/'+Gallery.detailPhotoController.get('route')+'.json';}
return(jsonpath().split('/')[0]+'/'+Gallery.detailPhotoController.get('route')+'.json');}
function insertExif(response,result)
{if(result.status&&result.status==1)
{var data=result.data;if(Gallery.detailPhotoController.get('viewIdentifier')==VIEW_IPHOTO_VIDEO)
{if(data.infoHeight=='--')
{data.infoHeight=Gallery.detailPhotoController.get('videoHeight')+' pixels';}
if(data.infoWidth=='--')
{data.infoWidth=Gallery.detailPhotoController.get('videoWidth')+' pixels';}}
data.infoName=decodeURIComponent(data.infoName);data.guid=Gallery.detailPhotoController.get('guid');Mac.Store.updateRecords([data],Mac.Store,Gallery.Photo);Gallery.detailPhotoController.set('hasExifData',true);}}
function missingExif()
{var exifFields=["infoWidth","infoHeight","infoOriginalDate","infoDigitizedDate","infoName","infoSize","infoCameraMake","infoCameraModel","infoSoftware","infoShutter","infoAperture","infoMaxAperture","infoExposureBias","infoExposure","infoExposureIndex","infoFocalLength","infoDistance","infoSensing","infoLightSource","infoFlash","infoMetering","infoBrightness","infoISOSpeed","infoGPSLatitude","infoGPSLongitude","infoGPSAltitude"];for(var i=0;i<exifFields.length;i++)
{if($(exifFields[i])&&$(exifFields[i]).innerHTML!="--")
{$(exifFields[i]).innerHTML="--";}}}
function reportCode(response)
{switch(response.status)
{case 0:case 401:case null:case undefined:Gallery.workspace.set('authRequired',true);Gallery.updateService.stop();Gallery.ignoreFocus=true;break;case 404:Gallery.workspace.set('noSuchAlbum',true);Gallery.updateService.stop();Gallery.ignoreFocus=true;break;case 500:Gallery.workspace.set('errorGettingData',true);Gallery.updateService.stop();Gallery.ignoreFocus=true;break;case 522:Gallery.workspace.set('stillPublishing',true);Gallery.updateService.stop();Gallery.ignoreFocus=true;break;}}
function loadModel(response,result)
{SC.Benchmark._bench(loadModel2.bind(this,response,result),'loadModel');this.set("enableSpinner",false);}
function loadModel2(response,result)
{Gallery.albums=Gallery.PhotoCollection.create({conditions:{showOnIndex:true},orderBy:['groupType','userOrderIndex DESC','updated DESC','guid'],recordType:Gallery.Photo});Gallery.albums.refresh();if(Gallery.enableBadging)
{setTimeout(Gallery.badging.initialize.bind(this),Gallery.localStorageInitDelay);}
var photos=Gallery.albumController.get('photos');if(photos&&photos.refresh)photos.refresh();var allPhotos=Gallery.albumController.get('allPhotos');if(allPhotos&&allPhotos.refresh)allPhotos.refresh();var title=(result.data&&result.data.title)?result.data.title:"_Gallery.DefaultTitle".loc();Gallery.defaults.set('title',title);Gallery.indexController.set('content',Gallery.albums);if(Gallery.adaptor.get('initialLoad'))
{Gallery.adaptor.set('initialLoad',false);Gallery.adaptor.afterLoad=true;SC.Routes.gotoRoute(SC.Routes.get('location'));Gallery.adaptor.afterLoad=false;}
Gallery.workspace.removeClassName('hidden');if(Gallery.indexController.get('selection').length>0)
{Gallery.indexController.get('selection')[0].allPropertiesDidChange();Gallery.workspace.allPropertiesDidChange();}
var movie=Gallery.Photo.findAll({route:SC.Routes.get('location')})[0];if(movie&&movie.get('isVideo')&&movie.get('isProtected'))
showiMovieFromRoute(movie);}
require('core');Gallery.badging={isInitialized:false,retryCount:0,albumVisitInfo:[],initialize:function()
{if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.getLocalStorage)
{Gallery.badging.isInitialized=true;}
else if(Gallery.badging.retryCount++<3)
{setTimeout(Gallery.badging.initialize.bind(this),Gallery.localStorageInitDelay);Gallery.localStorageInitDelay*=2;}}
else
{Gallery.badging.isInitialized=true;}
if(Gallery.badging.isInitialized)
{Gallery.badging.loadAlbumVisitDate();Gallery.badging.loadSiteVisitDate();Gallery.badging.saveSiteVisitDate(new Date().getTime());}},getAlbumStorageKey:function()
{return'album-'+Gallery.accountName;},getSiteStorageKey:function()
{return'site-'+Gallery.accountName;},clearLocalStorage:function()
{if(!Gallery.enableBadging)return;if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.clearLocalStorage)
flash.clearLocalStorage();}
else
{this.setCookie(this.getAlbumStorageKey(),'',1);this.setCookie(this.getSiteStorageKey(),'',1);}
$('headerWrapper').style.background='#20202f';setTimeout(function(){$('headerWrapper').style.background='';},500);},setupLocalStorage:function()
{if(!Gallery.enableBadging)return;if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.setupLocalStorage)
{flash.setupLocalStorage();}}},setCookie:function(key,value,expiration)
{if(!key)return false;var expires=new Date(expiration||(new Date().getTime()+Gallery.localStorageExpiration));var domain=window.location.hostname;var cookieValue=key+'='+escape(value)+';';if(domain.indexOf('.')!=-1)
cookieValue+=' domain='+domain+';';if(Gallery.localStorageExpiration>0)
cookieValue+=' expires='+expires.toUTCString()+';';document.cookie=cookieValue;return true;},getCookie:function(key)
{var cookie=document.cookie.split(";");var value=null;for(i=0;i<cookie.length;i++)
{var crumb=cookie[i];var nvp=crumb.split("=");if(key==nvp[0].trim())
{value=unescape(nvp[1]);break;}}
return value;},loadAlbumVisitDate:function()
{if(!Gallery.enableBadging)return;var key=this.getAlbumStorageKey();var dataString=null;if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.getLocalStorage)
dataString=flash.getLocalStorage(key);}
else
{dataString=this.getCookie(key);}
if(dataString)
{if(typeof(dataString==='number'))
dataString=dataString.toString();var dataList=dataString.split(',');dataList.each(function(item)
{var nvp=item.split('.');var guid=nvp[0];var milliseconds=nvp[1]||0;var contentVersion=nvp[2]||0;var numAssets=nvp[3]||0;if(guid)
{var previousVisitDate=0;if(Gallery.badging.albumVisitInfo[guid])
previousVisitDate=Gallery.badging.albumVisitInfo[guid].previousVisitDate;Gallery.badging.albumVisitInfo[guid]={visitDate:parseInt(milliseconds,0),previousVisitDate:previousVisitDate,contentVersion:parseInt(contentVersion,0),numAssets:parseInt(numAssets,0)};var record=Gallery.Album.find(guid);if(record)
record.set('visitDate',milliseconds);}});}},saveAlbumVisitDate:function(albumGuid,milliseconds)
{if(!Gallery.enableBadging)return;if(!Gallery.albums)return;if(!Gallery.badging.isInitialized)Gallery.badging.initialize();if(!Gallery.badging.isInitialized)return;var record=Gallery.Album.find(albumGuid);if(record)
{var contentVersion=parseInt(record.get('versionInfo').content,0);if(isNaN(contentVersion))contentVersion=0;var numPhotos=parseInt(record.get('numPhotos'),0);if(isNaN(numPhotos))numPhotos=0;var numMovies=parseInt(record.get('numMovies'),0);if(isNaN(numMovies))numMovies=0;var numAssets=numPhotos+numMovies;Gallery.badging.albumVisitInfo[albumGuid]={visitDate:parseInt(milliseconds,0),contentVersion:parseInt(contentVersion,0),numAssets:parseInt(numAssets,0)};record.set('visitDate',milliseconds);}
var dataList=[];for(var guid in Gallery.badging.albumVisitInfo)
{var info=Gallery.badging.albumVisitInfo[guid];if(info.visitDate)
{var value=guid+'.'+info.visitDate;value+='.'+info.contentVersion;value+='.'+info.numAssets;dataList.push(value);}}
var dataString=dataList.join(',');var key=this.getAlbumStorageKey();var errorCode=null;if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.setLocalStorage)
errorCode=flash.setLocalStorage(key,dataString);}
else
{errorCode=this.setCookie(key,dataString);}},saveSiteVisitDate:function(milliseconds)
{if(!Gallery.enableBadging)return;var key=this.getSiteStorageKey();var errorCode=null;if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');var data=milliseconds.toString();if(flash&&flash.setLocalStorage)
errorCode=flash.setLocalStorage(key,data);}
else
{errorCode=this.setCookie(key,milliseconds);}},loadSiteVisitDate:function()
{if(!Gallery.enableBadging)return;var key=this.getSiteStorageKey();var data=new Date().getTime();if(Gallery.localStorageType=='flash')
{var flash=Gallery.workspace.uploader.get('movie');if(flash&&flash.getLocalStorage)
data=flash.getLocalStorage(key);}
else
{data=this.getCookie(key);}
Gallery.siteVisitDate=data;var albums=Gallery.Album.findAll({});var albumRecords=albums.records?albums.records():null;if(albumRecords)albumRecords.each(function(album)
{album.set('redraw',true);});return data;}};require('core');require('model/album');require('model/photo');Gallery.indexController=Mac.CollectionController.create({allowsMultipleSelection:false});Gallery.albumController=Mac.ObjectController.create({contentBinding:'Gallery.indexController.selection'});Gallery.photosController=Mac.CollectionController.create({pageSize:100,contentBinding:'Gallery.albumController.photos',allowsMultipleSelection:false,allowsEmptySelection:false});Gallery.allPhotosController=Mac.CollectionController.create({contentBinding:'Gallery.albumController.allPhotos'});Gallery.selectedPhotoController=Mac.ObjectController.create({contentBinding:'Gallery.photosController.selection'});Gallery.detailPhotoController=Mac.ObjectController.create();Object.extend(String.English,{"_VisitorExperience.AlbumOptions.FileUploader.WarningText":"Uploads in progress will be canceled if you continue.","_VisitorExperience.AlbumOptions.FileUploader.MaxUploadCount":"This album is full. It contains 500 items and cannot accept more.","_VisitorExperience.AlbumOptions.FileUploader.MaxSpace":"This album is full. You cant add to it because no more space is available.","_VisitorExperience.AlbumOptions.FileUploader.CancelConfirm":"Are you sure you want to stop uploading this file?","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button":"Clear","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button.Tooltip":"Remove completed and canceled uploads from this list","_VisitorExperience.IndexPage.GalleryEmpty":"This Web Gallery is empty.","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Link":"Learn more about MobileMe Gallery","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Href":"http://help.apple.com/mac/1/help/indexwgv.html","_VisitorExperience.IndexPage.Albums.Title":"Albums","_VisitorExperience.IndexPage.Movies.Title":"Movies","_VisitorExperience.IndexPage.Slides.Title":"Slideshows","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button":"Show Options","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip":"Show options for this album","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button":"Hide Options","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button.Tooltip":"Hide options for this album","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link":"Grid","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link.Tooltip":"Display this album in a grid view","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link":"Mosaic","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link.Tooltip":"Display this album in a mosaic view","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link":"Carousel","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link.Tooltip":"Display this album in a carousel view","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link":"Cover Flow","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link.Tooltip":"Display this album in a Cover Flow view","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link":"Slideshow","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip":"Play a slideshow of this album","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser":"Color:","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Black.Tooltip":"View this album with a black background","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Gray.Tooltip":"View this album with a light gray background","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.White.Tooltip":"View this album with a white background","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.DarkGray.Tooltip":"View this album with a dark gray background","_VisitorExperience.AlbumPage.HeaderFooter.BackToGallery.Button.Tooltip":"Back to Web Gallery","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin":"Owner Login","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLoggedInAs":"Logged in as: %@","_VisitorExperience.AlbumPage.HeaderFooter.Help":"Help","_VisitorExperience.IndexPage.HeaderFooter.Help.Href":"http://help.apple.com/mac/1/help/indexwgv.html","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button":"Upload","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button.Tooltip":"Upload photos or movies to this album","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button":"Send to Album","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button.Tooltip":"Find out how to send photos or movies by mobile phone or email","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button":"Tell a Friend","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button.Tooltip":"Email a friend a link to this album or movie","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button":"Web Widget","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button.Tooltip":"Get a web widget for displaying this album on a website","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button":"Download","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip":"Download a compressed file of this album","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button":"Subscribe","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button.Tooltip":"Subscribe to an RSS feed of this album","_VisitorExperience.AlbumOptions.AddToAlbum.Title":"Upload","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalText":"To upload photos or movies, enter the information requested below.","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalTextAperture":"To upload photos, enter the information requested below.","_VisitorExperience.AlbumOptions.AddToAlbum.Name.Label":"Your name:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.Label":"Your address:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.GhostText":"Email or URL","_VisitorExperience.AlbumOptions.CAPTCHAText":"Please enter the characters you see in the image above.","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link":"What is this?","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button":"Cancel","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button.Tooltip":"Cancel","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button":"Choose Files...","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button.Tooltip":"Choose files to upload","_VisitorExperience.AlbumOptions.MobilePosting.Title":"Send to Album","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalText":"To upload to this album by mobile phone or email, send photos or movies to:","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalTextAperture":"To upload to this album by mobile phone or email, send photos to:","_VisitorExperience.AlbumOptions.MobilePosting.AddtoAddressBook.Link":"Add to Address Book","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button":"OK","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.TellAFriend.Title":"Tell a Friend","_VisitorExperience.AlbumOptions.TellAFriend.InstructionalText":"To send an email with a link to this album or movie, enter the information requested below.","_VisitorExperience.AlbumOptions.TellAFriend.To.Label":"To:","_VisitorExperience.AlbumOptions.TellAFriend.To.GhostText":"Your Friends Email Address","_VisitorExperience.AlbumOptions.TellAFriend.To.InstructionalText":"Use commas to separate multiple email addresses.","_VisitorExperience.AlbumOptions.TellAFriend.From.Label":"From:","_VisitorExperience.AlbumOptions.TellAFriend.From.GhostText":"Your Email Address","_VisitorExperience.AlbumOptions.TellAFriend.Message.Label":"Message:","_VisitorExperience.AlbumOptions.TellAFriend.Message.GhostText":"Your Message","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button":"Cancel","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button.Tooltip":"Cancel","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button":"Send","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button.Tooltip":"Send message","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLine":"Check out this photo album!","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.NamePassword":"Access to this album or movie is restricted by its owner. Please contact %@ to view it.","_VisitorExperience.AlbumOptions.WebWidget.Title":"Display this album on a website","_VisitorExperience.AlbumOptions.WebWidget.InstructionalText":"To share this album on a Flash-enabled blog, profile, or website, click Copy this code.","_VisitorExperience.AlbumOptions.WebWidget.CopySnippet.Link":"Copy this code","_VisitorExperience.AlbumOptions.WebWidget.Done.Button":"Done","_VisitorExperience.AlbumOptions.WebWidget.Done.Button.Tooltip":"Done","_VisitorExperience.AlbumOptions.Download.Title":"Download","_VisitorExperience.AlbumOptions.Download.InstructionalText":"A compressed file is being created, which could take a few minutes. When its ready, click Download.","_VisitorExperience.AlbumOptions.Download.Download.Button":"Download","_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip":"Download album now","_VisitorExperience.AlbumOptions.Download.Cancel.Button":"Close","_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip":"Close this window","_VisitorExperience.AlbumPage.SlideshowView.TitleCaptionTruncated.Link":"Read more >","_VisitorExperience.AlbumPage.SplashVideoView.TitleCaptionTruncated.Link":"Read more >","_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip":"View a fullscreen version of this movie","_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip":"Exit fullscreen view","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link":"Download","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link.Tooltip":"Download this movie in the size currently being viewed","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link":"Tiny","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link.Tooltip":"View a tiny-sized version of this movie","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link":"Small","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link.Tooltip":"View a small-sized version of this movie","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link":"Medium","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link.Tooltip":"View a medium-sized version of this movie","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link":"Large","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link.Tooltip":"View a large-sized version of this movie","_VisitorExperience.DetailPage.Download.Button.Tooltip":"Download this photo","_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip":"Show more information about this photo","_VisitorExperience.DetailPage.Previous.Button.Tooltip":"Previous","_VisitorExperience.DetailPage.Next.Button.Tooltip":"Next","_VisitorExperience.DetailPage.TitleCaptionTruncated.Link":"Read more >","_VisitorExperience.DetailPageVideo.BackToAlbum.Button":"Back to Album","_VisitorExperience.DetailPageVideo.TitleCaptionTruncated.Link":"Read more >","_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText":"Uploaded by %@1 on %@2","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button":"Back to Photo","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button.Tooltip":"Go back to this photo","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button":"Back to Movie","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button.Tooltip":"Go back to this movie","_VisitorExperience.AlbumPage.SlideshowView.Previous.Tooltip":"Previous","_VisitorExperience.AlbumPage.SlideshowView.Next.Tooltip":"Next","_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip":"Play","_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip":"Pause","_VisitorExperience.AlbumPage.SlideshowView.Title":" (%@1 of %@2)","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMoviesText":"%@1 photos and %@2 movies","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMovieText":"%@ photos and 1 movie","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMoviesText":"1 photo and %@ movies","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMovieText":"1 photo and 1 movie","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button":"Add to iPhoto","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button.ToolTip":"Add this album to iPhoto","_VisitorExperience.AlbumOptions.TellAFriend.IncludeMobileAddress":"Include address for sending photos or movies to this album","Loading...":"Loading...","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hours":"hours","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hour":"hour","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minutes":"minutes","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minute":"minute","_VisitorExperience.IndexPage.Movies.AlbumDetails.Seconds":"seconds","_VisitorExperience.IndexPage.Movies.AlbumDetails.Second":"second","_VisitorExperience.AlbumOptions.Download.PreparingDownload":"Preparing download","_VisitorExperience.AlbumOptions.Download.DownloadReady":"Ready to download","_VisitorExperience.AlbumOptions.Download.UnableToDownload":"Unable to prepare download. Please try again.","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMovieText":"1 movie","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMoviesText":"%@ movies","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoNoMovieText":"1 photo","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosNoMovieText":"%@ photos","_VisitorExperience.DetailPage.MismatchCAPTCHA.Error":"The characters you entered do not match the characters in the image.","_VisitorExperience.DetailPage.InvalidURLOrEmail.Error":"%@ is not a valid email address or URL.","_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error":"There was a problem sending this message. Please try again.","_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error":"Please enter at least one email address in the To: field.","_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error":"%@ is not a valid email address.","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLineMovie":"Check out this movie!","_VisitorExperience.DetailPage.InfoDisplay.InfoTableImageTitle.Title":"Image","_VisitorExperience.DetailPage.InfoDisplay.InfoTableFileTitle.Title":"File","_VisitorExperience.DetailPage.InfoDisplay.InfoTableCameraTitle.Title":"Camera","_VisitorExperience.DetailPage.InfoDisplay.InfoTableExposureTitle.Title":"Exposure","_VisitorExperience.DetailPage.InfoDisplay.InfoWidthLabel.Label":"Width:","_VisitorExperience.DetailPage.InfoDisplay.InfoHeightLabel.Label":"Height:","_VisitorExperience.DetailPage.InfoDisplay.InfoOriginalDateLabel.Label":"Original Date:","_VisitorExperience.DetailPage.InfoDisplay.InfoDigitizedDateLabel.Label":"Digitized Date:","_VisitorExperience.DetailPage.InfoDisplay.InfoNameLabel.Label":"Name:","_VisitorExperience.DetailPage.InfoDisplay.InfoSizeLabel.Label":"Size:","_VisitorExperience.DetailPage.InfoDisplay.InfoModifiedLabel.Label":"Modified:","_VisitorExperience.DetailPage.InfoDisplay.InfoImportedLabel.Label":"Imported:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraMakeLabel.Label":"Make:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraModelLabel.Label":"Model:","_VisitorExperience.DetailPage.InfoDisplay.InfoSoftwareLabel.Label":"Software:","_VisitorExperience.DetailPage.InfoDisplay.InfoShutterLabel.Label":"Shutter:","_VisitorExperience.DetailPage.InfoDisplay.InfoApertureLabel.Label":"Aperture:","_VisitorExperience.DetailPage.InfoDisplay.InfoMaxApertureLabel.Label":"Max Aperture:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureBiasLabel.Label":"Exposure Bias:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureLabel.Label":"Exposure:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureIndexLabel.Label":"Exposure Index:","_VisitorExperience.DetailPage.InfoDisplay.InfoFocalLengthLabel.Label":"Focal Length:","_VisitorExperience.DetailPage.InfoDisplay.InfoDistanceLabel.Label":"Distance:","_VisitorExperience.DetailPage.InfoDisplay.InfoSensingLabel.Label":"Sensing:","_VisitorExperience.DetailPage.InfoDisplay.InfoLightSourceLabel.Label":"Light Source:","_VisitorExperience.DetailPage.InfoDisplay.InfoFlashLabel.Label":"Flash:","_VisitorExperience.DetailPage.InfoDisplay.InfoMeteringLabel.Label":"Metering:","_VisitorExperience.DetailPage.InfoDisplay.InfoBrightnessLabel.Label":"Brightness:","_VisitorExperience.DetailPage.InfoDisplay.InfoISOSpeedLabel.Label":"ISO Speed:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLatitudeLabel.Label":"GPS Latitude:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLongitudeLabel.Label":"GPS Longitude:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSAltitudeLabel.Label":"GPS Altitude:","_VisitorExperience.DetailPage.EmptyCAPTCHA.Error":"Please enter the characters you see in the image.","_VisitorExperience.AlbumPage.HeaderFooter.SliderSmallest.Tooltip":"View at smallest photo size","_VisitorExperience.AlbumPage.HeaderFooter.Slider.Tooltip":"Change size of photos","_VisitorExperience.AlbumPage.HeaderFooter.SliderLargest.Tooltip":"View at largest photo size","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href":"http://help.apple.com/mac2/1/help/other/pgs2/mem_fmset_gen23.html","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip":"Download this movie","_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip":"Show more information about this movie","_VisitorExperience.AlbumPage.AlbumOptions.DownloadUnavailable.Button.Tooltip":"This album is temporarily unavailable for download","_VisitorExperience.NoPasswordEntered.Back.Link":"Back to MobileMe Gallery","_VisitorExperience.AlbumUnavailable":"This album is unavailable.","_VisitorExperience.AlbumUnavailable.Back.Link":"Back to MobileMe Gallery","_VisitorExperience.QTError.UnableToPlay":"QuickTime is unable to play this movie. Please try again.","_VisitorExperience.QTError.GetQuickTime":"Get QuickTime","_VisitorExperience.QTError.QuickTimeRequired":"QuickTime 7.2 is required to play this movie.","_VisitorExperience.QTError.Href":"http://www.apple.com/quicktime/","_VisitorExperience.AlbumPage.SplashVideoView.Description.Label":"Description","_VisitorExperience.FlashError.UnableToView":"This feature requires Flash Player.","_VisitorExperience.FlashError.GetFlash Player":"Get the latest Flash Player","_VisitorExperience.FlashError.Href":"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.MobilePosting":"You can upload to this album by mobile phone or email. Just send your photos or movies to: %@","_VisitorExperience.AlbumOptions.TellAFriend.NoFromAddress.Error":"Please enter your email address in the From: field.","_VisitorExperience.AppleLogo.Href":"http://www.apple.com/mobileme/features/gallery.html","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin.Tooltip":"Log in as the owner of this Web Gallery","_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip":"View Help topics for MobileMe Gallery","_DotMacWebGallery":"MobileMe Gallery","_Gallery.DefaultTitle":"My Gallery","_VisitorExperience.GalleryBranding.Tooltip":"Learn more about MobileMe","_VisitorExperience.PaginationLabel":"Page %@1 of %@2","_VisitorExperience.Pagination.PrevButton.Tooltip":"Go to the previous page","_VisitorExperience.Pagination.NextButton.Tooltip":"Go to the next page","_VisitorExperience.Pagination.Dot.Tooltip":"Go to page %@","_VisitorExperience.AlbumOptions.Help.Button":"?","_VisitorExperience.AlbumOptions.Help.Button.Tooltip":"Learn more about adding photos or movies to this album","_VisitorExperience.AlbumOptions.Help.Button.MobilePosting.Href":"http://help.apple.com/mac/1/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17106.html","_VisitorExperience.AlbumOptions.Help.Button.AddtoAlbum.Href":"http://help.apple.com/mac/1/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17105.html","_VisitorExperience.IndexPage.errorGettingData":"There was a problem loading this page. Please try again.","_VisitorExperience.IndexPage.stillPublishing":"This page is currently being published. Please try again in a moment.","_TermsOfService":"Terms of Service","_TermsOfService.Href":"http://www.apple.com/legal/mobileme/en/terms.html","_TermsOfService.Tooltip":"View the .Mac Terms of Service","_PrivacyPolicy":"Privacy","_PrivacyPolicy.Href":"http://www.apple.com/legal/privacy/","_PrivacyPolicy.Tooltip":"View the Privacy Policy","_VisitorExperience.DetailPage.Anonymous":"Anonymous","_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip":"View a fullscreen version of this album","_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip":"Exit fullscreen view","_VisitorExperience.AlbumOptions.DownloadMovie.InstructionalText":"Choose the movie size to download:","_VisitorExperience.AlbumOptions.DownloadMovie.About":"about","_VisitorExperience.AlbumOptions.DownloadMovie.iPodOriPhone":"iPod or iPhone","_VisitorExperience.AlbumOptions.DownloadMovie.macPCOrAppleTV":"Mac, PC, or","_VisitorExperience.GalleryPage.Subscribe.Button":"Subscribe to Updates","_VisitorExperience.GalleryPage.Subscribe.Button.Tooltip":"Subscribe to this gallery","_VisitorExperience.AlbumOptions.Subscribe.Title":"Subscribe","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText":"Choose how to stay up-to-date with <strong>%@</strong>:","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText2":"Stay up-to-date with <strong>%@</strong>:","_VisitorExperience.AlbumOptions.Subscribe.Done.Button":"OK","_VisitorExperience.AlbumOptions.Subscribe.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button":"Copy","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button.Tooltip":"Copy link to clipboard","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button":"Cancel","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button.Tooltip":"Cancel","_VisitorExperience.AlbumOptions.Subscribe.ByEmail":"by Email","_VisitorExperience.AlbumOptions.Subscribe.ViaRSS":"via RSS","_VisitorExperience.AlbumOptions.Subscribe.IniPhoto":"in iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText1":"Open the feed for this album in your favorite RSS feed reader.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText2":"You can also copy and paste the link below:","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText1":"Open a photo feed for this album in iPhoto.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText2":"iPhoto will download the most recent photos and keep the album updated automatically.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText1":"Receive an email notification any day this album is updated.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText2":"A confirmation email  will be sent to your address. Follow the instructions to complete your subscription.","_VisitorExperience.AlbumOptions.Subscribe.EmailError.Error":"Please enter your email address.","_VisitorExperience.NoPasswordEntered":"Access to this album or movie is restricted. Please contact the album's owner for a password and username.","_VisitorExperience.Description.More":"More...","_VisitorExperience.Visited.LastUpdate":"Last Update:","_VisitorExperience.Visited.Calculating":"Calculating...","_VisitorExperience.Visited.Today":"Today","_VisitorExperience.Visited.Date":"%@1/%@2/%@3"});Object.extend(String.French,{"_VisitorExperience.AlbumOptions.FileUploader.WarningText":"Vos tlchargements en cours seront annuls si vous continuez.","_VisitorExperience.AlbumOptions.FileUploader.MaxUploadCount":"Cet album est satur. Il contient dj le nombre maximal de 500 objets.","_VisitorExperience.AlbumOptions.FileUploader.MaxSpace":"Cet album est satur. Vous ne pouvez rien y ajouter parce qu'il n'y a plus d'espace disponible.","_VisitorExperience.AlbumOptions.FileUploader.CancelConfirm":"Souhaitez-vous vraiment annuler le tlchargement de ce fichier?","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button":"Rinitialiser","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button.Tooltip":"Effacer de cette liste les tlchargements achevs ou interrompus","_VisitorExperience.IndexPage.GalleryEmpty":"Cette Galerie Web est vide.","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Link":"En savoir plus sur Galerie MobileMe","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Href":"http://help.apple.com/mac/3/help/indexwgv.html","_VisitorExperience.IndexPage.Albums.Title":"Albums","_VisitorExperience.IndexPage.Movies.Title":"Films","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button":"Afficher les options","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip":"Afficher les options pour cet album","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button":"Masquer les options","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button.Tooltip":"Masquer les options pour cet album","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link":"Grille","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link.Tooltip":"Afficher cet album en vue Grille","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link":"Mosaque","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link.Tooltip":"Afficher cet album en vue Mosaque","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link":"Mange","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link.Tooltip":"Afficher cet album en vue Mange","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link":"Flux","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link.Tooltip":"Afficher cet album en vue Flux","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link":"Diaporama","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip":"Lire un diaporama de cet album","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser":"Couleur:","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Black.Tooltip":"Visualiser cet album sur un fond noir","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Gray.Tooltip":"Visualiser cet album sur un fond gris clair","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.White.Tooltip":"Visualiser cet album sur un fond blanc","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.DarkGray.Tooltip":"Visualiser cet album sur un fond gris fonc","_VisitorExperience.AlbumPage.HeaderFooter.BackToGallery.Button.Tooltip":"Retour  la Galerie Web","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin":"Connexion du Propritaire","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLoggedInAs":"Connect comme: %@","_VisitorExperience.AlbumPage.HeaderFooter.Help":"Aide","_VisitorExperience.IndexPage.HeaderFooter.Help.Href":"http://help.apple.com/mac/3/help/indexwgv.html","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button":"Contribuer","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button.Tooltip":"Contribuer des photos et films  cet album","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button":"Envoyer  l'album","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button.Tooltip":"Dcouvrez comment contribuer  cet album par tlphone portable ou courrier lectronique.","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button":"Recommander","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button.Tooltip":"Envoyer un lien vers cet album ou film par courrier lectronique","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button":"Widget Web","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button.Tooltip":"Obtenir un Widget Web pour afficher cet album sur un site Web","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button":"Tlcharger","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip":"Tlcharger un fichier comprim de cet album","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button":"S'abonner","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button.Tooltip":"S'abonner  un flux RSS de cet album","_VisitorExperience.AlbumOptions.AddToAlbum.Title":"Contribuer","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalText":"Pour contribuer des photos ou des films, saisissez les informations ci-dessous.","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalTextAperture":"Pour contribuer des photos, veuillez saisir les informations requises ci-dessous.","_VisitorExperience.AlbumOptions.AddToAlbum.Name.Label":"Votre nom:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.Label":"Votre adresse:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.GhostText":"Adresse lectronique ou URL","_VisitorExperience.AlbumOptions.CAPTCHAText":"Veuillez saisir les caractres affichs dans l'image ci-dessus.","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link":"De quoi s'agit-il ?","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button":"Annuler","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button.Tooltip":"Annuler","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button":"Slectionner des fichiers...","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button.Tooltip":"Slectionnez les fichiers  ajouter","_VisitorExperience.AlbumOptions.MobilePosting.Title":"Envoyer  l'album","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalText":"Pour contribuer  cet album par tlphone portable ou courrier lectronique, envoyez vos photos et films  l'adresse: %@","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalTextAperture":"Pour contribuer des photos  cet album, veuillez les envoyer :","_VisitorExperience.AlbumOptions.MobilePosting.AddtoAddressBook.Link":"Ajouter au Carnet d'adresses","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button":"OK","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.TellAFriend.Title":"Recommander","_VisitorExperience.AlbumOptions.TellAFriend.InstructionalText":"Pour envoyer un courrier contenant un lien vers cet album ou ce film, saisissez les informations requises ci-dessous.","_VisitorExperience.AlbumOptions.TellAFriend.To.Label":":","_VisitorExperience.AlbumOptions.TellAFriend.To.GhostText":"L'adresse lectronique du destinataire","_VisitorExperience.AlbumOptions.TellAFriend.To.InstructionalText":"Sparez les adresses lectroniques par des virgules.","_VisitorExperience.AlbumOptions.TellAFriend.From.Label":"De:","_VisitorExperience.AlbumOptions.TellAFriend.From.GhostText":"Votre adresse lectronique","_VisitorExperience.AlbumOptions.TellAFriend.Message.Label":"Message:","_VisitorExperience.AlbumOptions.TellAFriend.Message.GhostText":"Votre message","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button":"Annuler","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button.Tooltip":"Annuler","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button":"Envoyer","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button.Tooltip":"Envoyer le message","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLine":"Voici un album intressant!","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.NamePassword":"L'accs  ce film est limit par son propritaire. Veuillez contacter %@ pour pouvoir le visionner.","_VisitorExperience.AlbumOptions.WebWidget.Title":"Afficher cet album sur un site Web","_VisitorExperience.AlbumOptions.WebWidget.InstructionalText":"Pour partager cet album sur un blog, profil ou site Web prenant en charge Flash, cliquez sur Copier cette code.","_VisitorExperience.AlbumOptions.WebWidget.CopySnippet.Link":"Copier cette code","_VisitorExperience.AlbumOptions.WebWidget.Done.Button":"OK","_VisitorExperience.AlbumOptions.WebWidget.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Download.Title":"Tlcharger","_VisitorExperience.AlbumOptions.Download.InstructionalText":"Un fichier compress est en train d'tre cr, ce qui peut prendre quelques instants. Lorsqu'il sera prt, cliquez sur Tlcharger.","_VisitorExperience.AlbumOptions.Download.Download.Button":"Tlcharger","_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip":"Tlcharger l'album maintenant","_VisitorExperience.AlbumOptions.Download.Cancel.Button":"Fermer","_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip":"Fermer cette fentre","_VisitorExperience.AlbumPage.SlideshowView.TitleCaptionTruncated.Link":"En savoir plus >","_VisitorExperience.AlbumPage.SplashVideoView.TitleCaptionTruncated.Link":"En savoir plus >","_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip":"Visionner ce film en taille plein cran","_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip":"Quitter le mode plein cran","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link":"Tlcharger","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link.Tooltip":"Tlcharger ce film dans la taille actuelle","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link":"Trs petit","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link.Tooltip":"Visionner une version trs-petite de ce film","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link":"Petit","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link.Tooltip":"Visionner une version petite de ce film","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link":"Moyenne","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link.Tooltip":"Visionner ce film en taille moyenne","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link":"Grand","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link.Tooltip":"Visionner ce film en taille grande","_VisitorExperience.DetailPage.Download.Button.Tooltip":"Tlcharger cette photo","_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip":"Afficher plus d'infos sur cette photo","_VisitorExperience.DetailPage.Previous.Button.Tooltip":"Prcdente","_VisitorExperience.DetailPage.Next.Button.Tooltip":"Suivante","_VisitorExperience.DetailPage.TitleCaptionTruncated.Link":"En savoir plus >","_VisitorExperience.DetailPageVideo.BackToAlbum.Button":"Retour  l'album","_VisitorExperience.DetailPageVideo.TitleCaptionTruncated.Link":"En savoir plus >","_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText":"Contribu par %@ le %@2","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button":"Retour  la photo","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button.Tooltip":"Retour  cette photo","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button":"Retour  Film","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button.Tooltip":"Retour  ce film","_VisitorExperience.AlbumPage.SlideshowView.Previous.Tooltip":"Prcdente","_VisitorExperience.AlbumPage.SlideshowView.Next.Tooltip":"Suivante","_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip":"Lire","_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip":"Pause","_VisitorExperience.AlbumPage.SlideshowView.Title":" (%@1 sur %@2)","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMoviesText":"%@1 photos and %@2 films","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMovieText":"%@ photos et 1 film","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMoviesText":"1 photo et %@ films","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMovieText":"1 photo et 1 film","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button":"Ajouter  iPhoto","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button.ToolTip":"Ajouter cet album  iPhoto","_VisitorExperience.AlbumOptions.TellAFriend.IncludeMobileAddress":"Inclure l'adresse  laquelle les contributions  cet album peuvent tre envoyes","Loading...":"Chargement...","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hours":"heures","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hour":"heure","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minutes":"minutes","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minute":"minute","_VisitorExperience.IndexPage.Movies.AlbumDetails.Seconds":"secondes","_VisitorExperience.IndexPage.Movies.AlbumDetails.Second":"seconde","_VisitorExperience.AlbumOptions.Download.PreparingDownload":"Prparation du tlchargement","_VisitorExperience.AlbumOptions.Download.DownloadReady":"Prt  tlcharger","_VisitorExperience.AlbumOptions.Download.UnableToDownload":"Impossible de prparer le tlchargement. Veuillez ressayer.","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMovieText":"1 film","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMoviesText":"%@ films","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoNoMovieText":"1 photo","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosNoMovieText":"%@ photos","_VisitorExperience.DetailPage.MismatchCAPTCHA.Error":"Les caractres que vous avez saisis ne correspondent pas  ceux de l'image.","_VisitorExperience.DetailPage.InvalidURLOrEmail.Error":"%@ n'est ni une adresse lectronique ni une adresse Internet valide.","_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error":"Un problme est survenu lors de l'envoi de ce message. Veuillez ressayer.","_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error":"Saisissez au moins une adresse lectronique dans le champ A:.","_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error":"%@ n'est pas une adresse lectronique valide.","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLineMovie":"Jetez un il  ce film!","_VisitorExperience.DetailPage.InfoDisplay.InfoTableImageTitle.Title":"Image","_VisitorExperience.DetailPage.InfoDisplay.InfoTableFileTitle.Title":"Fichier","_VisitorExperience.DetailPage.InfoDisplay.InfoTableCameraTitle.Title":"Appareil photo","_VisitorExperience.DetailPage.InfoDisplay.InfoTableExposureTitle.Title":"Exposition","_VisitorExperience.DetailPage.InfoDisplay.InfoWidthLabel.Label":"Largeur:","_VisitorExperience.DetailPage.InfoDisplay.InfoHeightLabel.Label":"Hauteur:","_VisitorExperience.DetailPage.InfoDisplay.InfoOriginalDateLabel.Label":"Date originale:","_VisitorExperience.DetailPage.InfoDisplay.InfoDigitizedDateLabel.Label":"Numris le:","_VisitorExperience.DetailPage.InfoDisplay.InfoNameLabel.Label":"Nom:","_VisitorExperience.DetailPage.InfoDisplay.InfoSizeLabel.Label":"Taille:","_VisitorExperience.DetailPage.InfoDisplay.InfoModifiedLabel.Label":"Modifi:","_VisitorExperience.DetailPage.InfoDisplay.InfoImportedLabel.Label":"Import:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraMakeLabel.Label":"Fabricant:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraModelLabel.Label":"Modle:","_VisitorExperience.DetailPage.InfoDisplay.InfoSoftwareLabel.Label":"Logiciel:","_VisitorExperience.DetailPage.InfoDisplay.InfoShutterLabel.Label":"Obturateur:","_VisitorExperience.DetailPage.InfoDisplay.InfoApertureLabel.Label":"Ouverture:","_VisitorExperience.DetailPage.InfoDisplay.InfoMaxApertureLabel.Label":"Ouverture max.:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureBiasLabel.Label":"Angle d'exposition:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureLabel.Label":"Exposition:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureIndexLabel.Label":"Index d'exposition:","_VisitorExperience.DetailPage.InfoDisplay.InfoFocalLengthLabel.Label":"Longueur focale:","_VisitorExperience.DetailPage.InfoDisplay.InfoDistanceLabel.Label":"Distance:","_VisitorExperience.DetailPage.InfoDisplay.InfoSensingLabel.Label":"Dtection:","_VisitorExperience.DetailPage.InfoDisplay.InfoLightSourceLabel.Label":"Source de lumire:","_VisitorExperience.DetailPage.InfoDisplay.InfoFlashLabel.Label":"Flash:","_VisitorExperience.DetailPage.InfoDisplay.InfoMeteringLabel.Label":"Mesure:","_VisitorExperience.DetailPage.InfoDisplay.InfoBrightnessLabel.Label":"Luminosit:","_VisitorExperience.DetailPage.InfoDisplay.InfoISOSpeedLabel.Label":"Vitesse ISO:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLatitudeLabel.Label":"Latitude GPS:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLongitudeLabel.Label":"Longitude GPS:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSAltitudeLabel.Label":"Altitude GPS:","_VisitorExperience.DetailPage.EmptyCAPTCHA.Error":"Veuillez saisir les caractres qui s'affichent dans l'image.","_VisitorExperience.AlbumPage.HeaderFooter.SliderSmallest.Tooltip":"Afficher la plus petite taille","_VisitorExperience.AlbumPage.HeaderFooter.Slider.Tooltip":"Modifier la taille des photos","_VisitorExperience.AlbumPage.HeaderFooter.SliderLargest.Tooltip":"Afficher la taille maximale","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href":"http://help.apple.com/mac2/3/help/other/pgs2/mem_fmset_gen23.html","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip":"Tlcharger ce film","_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip":"Afficher plus d'informations sur ce film.","_VisitorExperience.AlbumPage.AlbumOptions.DownloadUnavailable.Button.Tooltip":"Cet album est momentanment indisponible en tlchargement","_VisitorExperience.NoPasswordEntered.Back.Link":"Retour  Galerie MobileMe","_VisitorExperience.AlbumUnavailable":"Cet album n'est pas disponible.","_VisitorExperience.AlbumUnavailable.Back.Link":"Retour  Galerie MobileMe","_VisitorExperience.QTError.UnableToPlay":"QuickTime n'a pu lire ce film. Veuillez ressayer.","_VisitorExperience.QTError.GetQuickTime":"Obtenir QuickTime","_VisitorExperience.QTError.QuickTimeRequired":"QuickTime est requis pour lire ce film.","_VisitorExperience.QTError.Href":"http://www.apple.com/fr/quicktime/","_VisitorExperience.AlbumPage.SplashVideoView.Description.Label":"Description","_VisitorExperience.FlashError.UnableToView":"Cette disposition requiert Flash Player.","_VisitorExperience.FlashError.GetFlash Player":"Installer la version actuelle de Flash Player","_VisitorExperience.FlashError.Href":"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash&P5_Language=French","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.MobilePosting":"Vous pouvez contribuer  cet album par tlphone portable ou courrier lectronique. Envoyez vos photos et films  l'adresse: %@","_VisitorExperience.AlbumOptions.TellAFriend.NoFromAddress.Error":"Veuillez saisir votre adresse lectronique dans le champ De:.","_VisitorExperience.AppleLogo.Href":"http://www.apple.com/fr/mobileme/features/gallery.html","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin.Tooltip":"Se connecter comme propritaire de cette Galerie Web","_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip":"Voir les rubriques Aide pour Galerie MobileMe","_DotMacWebGallery":"Galerie MobileMe","_Gallery.DefaultTitle":"Ma Galerie","_VisitorExperience.GalleryBranding.Tooltip":"En savoir plus sur MobileMe","_VisitorExperience.PaginationLabel":"Page %@1 sur %@2","_VisitorExperience.Pagination.PrevButton.Tooltip":"Accder  la page prcdente","_VisitorExperience.Pagination.NextButton.Tooltip":"Accder  la page suivante","_VisitorExperience.Pagination.Dot.Tooltip":"Rendez-vous  la page %@","_VisitorExperience.AlbumOptions.Help.Button":"?","_VisitorExperience.AlbumOptions.Help.Button.Tooltip":"En savoir plus sur l'ajout de photos et films  cet album","_VisitorExperience.AlbumOptions.Help.Button.MobilePosting.Href":"http://help.apple.com/mac/3/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17106.html","_VisitorExperience.AlbumOptions.Help.Button.AddtoAlbum.Href":"http://help.apple.com/mac/3/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17105.html","_VisitorExperience.IndexPage.errorGettingData":"Un problme est survenu lors du chargement de la page. Veuillez ressayer.","_VisitorExperience.IndexPage.stillPublishing":"Cette page est en train d'tre publi. Veuillez ressayer dans quelques minutes.","_TermsOfService":"Conditions de service","_TermsOfService.Href":"http://www.apple.com/legal/mobileme/fr/terms.html","_TermsOfService.Tooltip":"Voir les Conditions de service MobileMe","_PrivacyPolicy":"Confidentialit","_PrivacyPolicy.Href":"http://www.apple.com/fr/legal/privacy/","_PrivacyPolicy.Tooltip":"Consulter l'engagement de confidentialit","_VisitorExperience.DetailPage.Anonymous":"Anonyme","_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip":"Visionner cet album en taille plein cran","_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip":"Quitter le mode plein cran","_VisitorExperience.AlbumOptions.DownloadMovie.InstructionalText":"Slectionnez la taille de film  tlcharger:","_VisitorExperience.AlbumOptions.DownloadMovie.About":"environ %@ Mo","_VisitorExperience.AlbumOptions.DownloadMovie.iPodOriPhone":"iPod ou iPhone","_VisitorExperience.AlbumOptions.DownloadMovie.macPCOrAppleTV":"Mac, PC ou ","_VisitorExperience.GalleryPage.Subscribe.Button":"S'abonner aux mises  jour","_VisitorExperience.GalleryPage.Subscribe.Button.Tooltip":"S'abonner  cette Galerie","_VisitorExperience.AlbumOptions.Subscribe.Title":"S'abonner","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText":"Slectionnez la faon dont vous souhaitez tre inform sur les mises  jour de <strong>%@</strong> : ","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText2":"tre inform sur les mises  jour de <strong>%@</strong>:","_VisitorExperience.AlbumOptions.Subscribe.Done.Button":"OK","_VisitorExperience.AlbumOptions.Subscribe.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button":"Copier","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button.Tooltip":"Copier lien dans presse-papiers","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button":"Annuler","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button.Tooltip":"Annuler","_VisitorExperience.AlbumOptions.Subscribe.ByEmail":"par courrier lectronique:","_VisitorExperience.AlbumOptions.Subscribe.ViaRSS":"via RSS","_VisitorExperience.AlbumOptions.Subscribe.IniPhoto":"dans iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText1":"Ouvrir le flux RSS pour cet album dans un lecteur flux RSS.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText2":"Vous pouvez galement copier et coller le lien ci-dessous:","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText1":"Ouvrir un flux de photo pour cet album dans iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText2":"iPhoto tlchargera les photos les plus rcentes et mettra  jour l'album automatiqeument.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText1":"Recevoir une notification par courrier lectronique quand cet album est mise  jour.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText2":"Un courrier lectronique de confirmation sera envoy  votre adresse. Suivez les instructions pour complter votre abonnement.","_VisitorExperience.AlbumOptions.Subscribe.EmailError.Error":"Veuillez fournir votre adresse lectronique.","_VisitorExperience.NoPasswordEntered":"L'accs  cet album est limit. Veuillez contacter le propritaire pour un nom d'usager et mot de passe.","_VisitorExperience.Description.More":"En savoir plus...","_VisitorExperience.Visited.LastUpdate":"Dernire mise  jour :","_VisitorExperience.Visited.Calculating":"Calcul...","_VisitorExperience.Visited.Today":"Aujourd'hui","_VisitorExperience.Visited.Date":"%@2/%@1/%@3"});Object.extend(String.German,{"_VisitorExperience.AlbumOptions.FileUploader.WarningText":"Aktuelle Ladevorgnge werden abgebrochen, wenn Sie fortfahren.","_VisitorExperience.AlbumOptions.FileUploader.MaxUploadCount":"Dieses Album ist voll. Es enthlt 500 Objekte und kann nicht mehr aufnehmen.","_VisitorExperience.AlbumOptions.FileUploader.MaxSpace":"Dieses Album ist voll. Sie knnen nichts hinzufgen, da kein Platz mehr verfgbar ist.","_VisitorExperience.AlbumOptions.FileUploader.CancelConfirm":"Mchten Sie den Ladevorgang dieser Datei wirklich abbrechen?","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button":"Lschen","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button.Tooltip":"Ausgefhrte und abgebrochene Uploads aus dieser Liste entfernen","_VisitorExperience.IndexPage.GalleryEmpty":"Diese Galerie ist leer.","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Link":"Erfahren Sie mehr ber MobileMe Galerie","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Href":"http://help.apple.com/mac/4/help/indexwgv.html","_VisitorExperience.IndexPage.Albums.Title":"Alben","_VisitorExperience.IndexPage.Movies.Title":"Filme","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button":"Optionen einblenden","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip":"Optionen fr dieses Album einblenden","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button":"Optionen ausblenden","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button.Tooltip":"Optionen fr dieses Album ausblenden","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link":"Raster","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link.Tooltip":"Dieses Album in einer Raster-Ansicht anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link":"Mosaik","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link.Tooltip":"Dieses Album in einer Mosaik-Ansicht anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link":"Karussell","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link.Tooltip":"Dieses Album in einer Karussell-Ansicht anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link":"Coverflow","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link.Tooltip":"Dieses Album in einer Coverflow-Ansicht anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link":"Diashow","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip":"Eine Diashow dieses Albums wiedergeben","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser":"Farbe:","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Black.Tooltip":"Dieses Album auf einem schwarzen Hintergrund anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Gray.Tooltip":"Dieses Album auf einem hellgrauen Hintergrund anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.White.Tooltip":"Dieses Album auf einem weien Hintergrund anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.DarkGray.Tooltip":"Dieses Album auf einem dunkelgrauen Hintergrund anzeigen","_VisitorExperience.AlbumPage.HeaderFooter.BackToGallery.Button.Tooltip":"Zurck zur Galerie","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin":"Eigentmer-Anmeldung","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLoggedInAs":"Angemeldet als: %@","_VisitorExperience.AlbumPage.HeaderFooter.Help":"Hilfe","_VisitorExperience.IndexPage.HeaderFooter.Help.Href":"http://help.apple.com/mac/4/help/indexwgv.html","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button":"Upload","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button.Tooltip":"In dieses Album Fotos oder Filme hochladen","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button":"Zum Album senden","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button.Tooltip":"Erfahren Sie, wie Sie Fotos oder Filme mit einem Mobiltelefon oder per E-Mail senden knnen.","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button":"An Freunde","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button.Tooltip":"Freunden einen Link zu diesem Album, bzw. Film per E-Mail senden","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button":"Web-Widget","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button.Tooltip":"Ein Web-Widget abrufen, um dieses Album auf einer Website anzuzeigen","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button":"Herunterladen","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip":"Eine komprimierte Datei dieses Albums laden","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button":"Abonnieren","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button.Tooltip":"Ein RSS-Feed fr dieses Album abonnieren","_VisitorExperience.AlbumOptions.AddToAlbum.Title":"Upload","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalText":"Wenn Sie Fotos oder Filme hochladen mchten, geben Sie die erforderlichen Informationen unten ein.","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalTextAperture":"Geben Sie die angeforderte Informationen unten ein, um Fotos hochladen zu knnen.","_VisitorExperience.AlbumOptions.AddToAlbum.Name.Label":"Ihr Name:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.Label":"Ihre Adresse:","_VisitorExperience.AlbumOptions.AddToAlbum.Address.GhostText":"E-Mail oder URL","_VisitorExperience.AlbumOptions.CAPTCHAText":"Bitte geben Sie die im Bild oben angezeigten Zeichen ein.","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link":"Was ist das?","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button":"Abbrechen","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button.Tooltip":"Abbrechen","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button":"Dateien whlen...","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button.Tooltip":"Whlen Sie die hochzuladenden Dateien","_VisitorExperience.AlbumOptions.MobilePosting.Title":"Zum Album senden","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalText":"Wenn Sie diesem Album Fotos oder Filme hinzufgen und per Mobiltelefon oder E-Mail-Anhang hochladen mchten, senden Sie sie an:","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalTextAperture":"Wenn Sie Fotos per Mobiltelefon oder E-Mail in dieses Album hochladen mchten, senden Sie sie an:","_VisitorExperience.AlbumOptions.MobilePosting.AddtoAddressBook.Link":"Zum Adressbuch hinzufgen","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button":"OK","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.TellAFriend.Title":"An Freunde","_VisitorExperience.AlbumOptions.TellAFriend.InstructionalText":"Wenn Sie eine E-Mail mit einem Link zu diesem Album. bzw. Film senden mchten, geben Sie die erforderlichen Informationen unten ein.","_VisitorExperience.AlbumOptions.TellAFriend.To.Label":"An:","_VisitorExperience.AlbumOptions.TellAFriend.To.GhostText":"E-Mail-Adresse des Empngers","_VisitorExperience.AlbumOptions.TellAFriend.To.InstructionalText":"Trennen Sie mehrere E-Mail-Adressen durch Kommas.","_VisitorExperience.AlbumOptions.TellAFriend.From.Label":"Von:","_VisitorExperience.AlbumOptions.TellAFriend.From.GhostText":"Ihre E-Mail-Adresse","_VisitorExperience.AlbumOptions.TellAFriend.Message.Label":"Nachricht:","_VisitorExperience.AlbumOptions.TellAFriend.Message.GhostText":"Ihre Nachricht","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button":"Abbrechen","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button.Tooltip":"Abbrechen","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button":"Senden","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button.Tooltip":"Nachricht senden","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLine":"Seht euch dieses Fotoalbum an!","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.NamePassword":"Zugriff auf dieses Album, bzw. diesen Film wurde vom Eigentmer eingeschrnkt.  Bitte wenden Sie sich an %@, um ihn anzusehen.","_VisitorExperience.AlbumOptions.WebWidget.Title":"Anzeigen des Albums auf einer Website","_VisitorExperience.AlbumOptions.WebWidget.InstructionalText":"Wenn Sie dieses Album auf einem Flash-aktivierten Blog, Profil oder einer Website anzeigen mchten, klicken Sie auf Diesen Code kopieren.","_VisitorExperience.AlbumOptions.WebWidget.CopySnippet.Link":"Diesen Code kopieren","_VisitorExperience.AlbumOptions.WebWidget.Done.Button":"OK","_VisitorExperience.AlbumOptions.WebWidget.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Download.Title":"Herunterladen","_VisitorExperience.AlbumOptions.Download.InstructionalText":"Eine komprimierte Datei dieses Albums wird erstellt, was einige Momente dauern kann. Nachdem der Vorgang abgeschlossen ist, klicken Sie auf Herunterladen.","_VisitorExperience.AlbumOptions.Download.Download.Button":"Herunterladen","_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip":"Album jetzt herunterladen","_VisitorExperience.AlbumOptions.Download.Cancel.Button":"Schlieen","_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip":"Dieses Fenster schlieen","_VisitorExperience.AlbumPage.SlideshowView.TitleCaptionTruncated.Link":"Weitere Informationen >","_VisitorExperience.AlbumPage.SplashVideoView.TitleCaptionTruncated.Link":"Weitere Informationen >","_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip":"Eine Vollbild-Version dieses Films anzeigen","_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip":"Vollbild-Modus beenden","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link":"Herunterladen","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link.Tooltip":"Diesen Film in der aktuell angezeigten Gre laden","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link":"Sehr klein","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link.Tooltip":"Eine sehr kleine Version dieses Films anzeigen","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link":"Klein","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link.Tooltip":"Eine kleine Version dieses Films anzeigen","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link":"Mittel","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link.Tooltip":"Eine mittlere Version dieses Films anzeigen","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link":"Gro","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link.Tooltip":"Eine groe Version dieses Films anzeigen","_VisitorExperience.DetailPage.Download.Button.Tooltip":"Dieses Foto herunterladen","_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip":"Weitere Informationen zu diesem Foto anzeigen","_VisitorExperience.DetailPage.Previous.Button.Tooltip":"Zurck","_VisitorExperience.DetailPage.Next.Button.Tooltip":"Weiter","_VisitorExperience.DetailPage.TitleCaptionTruncated.Link":"Weitere Informationen >","_VisitorExperience.DetailPageVideo.BackToAlbum.Button":"Zurck zum Album","_VisitorExperience.DetailPageVideo.TitleCaptionTruncated.Link":"Weitere Informationen >","_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText":"Hochgeladen von %@1 am %@2","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button":"Zurck zum Foto","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button.Tooltip":"Zu diesem Foto wechseln","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button":"Zurck zum Film","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button.Tooltip":"Zu diesem Film wechseln","_VisitorExperience.AlbumPage.SlideshowView.Previous.Tooltip":"Zurck","_VisitorExperience.AlbumPage.SlideshowView.Next.Tooltip":"Weiter","_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip":"Wiedergeben","_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip":"Pause","_VisitorExperience.AlbumPage.SlideshowView.Title":" (%@1 von %@2)","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMoviesText":"%@1 Fotos and %@2 Filme","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMovieText":"%@ Fotos und 1 Film","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMoviesText":"1 Foto und %@ Flime","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMovieText":"1 Foto und 1 Film","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button":"Zu iPhoto hinzufgen","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button.ToolTip":"Dieses Album zu iPhoto hinzufgen","_VisitorExperience.AlbumOptions.TellAFriend.IncludeMobileAddress":"Adresse zum Senden von Fotos and Filmen an dieses Album hinzufgen","Loading...":"Laden...","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hours":"Stunden","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hour":"Stunde","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minutes":"Minuten","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minute":"Minute","_VisitorExperience.IndexPage.Movies.AlbumDetails.Seconds":"Sekunden","_VisitorExperience.IndexPage.Movies.AlbumDetails.Second":"zweiten","_VisitorExperience.AlbumOptions.Download.PreparingDownload":"Download wird vorbereitet","_VisitorExperience.AlbumOptions.Download.DownloadReady":"Bereit zum Herunterladen","_VisitorExperience.AlbumOptions.Download.UnableToDownload":"Vorbereitung des Downloads z. Z. nicht mglich. Bitte versuchen Sie es erneut.","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMovieText":"1 Film","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMoviesText":"%@ Filme","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoNoMovieText":"1 Foto","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosNoMovieText":"%@ Fotos","_VisitorExperience.DetailPage.MismatchCAPTCHA.Error":"Die eingegebenen Zeichen stimmen nicht mit der Abbildung berein.","_VisitorExperience.DetailPage.InvalidURLOrEmail.Error":"%@ ist keine gltige E-Mail-Adresse oder URL.","_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error":"Beim Senden dieser Nachricht ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.","_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error":"Bitte geben Sie wenigstens eine E-Mail-Adresse ins Feld An: ein.","_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error":"%@ ist keine gltige E-Mail-Adresse.","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLineMovie":"Seht euch diesen Film an!","_VisitorExperience.DetailPage.InfoDisplay.InfoTableImageTitle.Title":"Bild","_VisitorExperience.DetailPage.InfoDisplay.InfoTableFileTitle.Title":"Ablage","_VisitorExperience.DetailPage.InfoDisplay.InfoTableCameraTitle.Title":"Kamera","_VisitorExperience.DetailPage.InfoDisplay.InfoTableExposureTitle.Title":"Belichtung","_VisitorExperience.DetailPage.InfoDisplay.InfoWidthLabel.Label":"Breite:","_VisitorExperience.DetailPage.InfoDisplay.InfoHeightLabel.Label":"Hhe:","_VisitorExperience.DetailPage.InfoDisplay.InfoOriginalDateLabel.Label":"Aufgenommen am:","_VisitorExperience.DetailPage.InfoDisplay.InfoDigitizedDateLabel.Label":"Digitalisiert am:","_VisitorExperience.DetailPage.InfoDisplay.InfoNameLabel.Label":"Name:","_VisitorExperience.DetailPage.InfoDisplay.InfoSizeLabel.Label":"Gre:","_VisitorExperience.DetailPage.InfoDisplay.InfoModifiedLabel.Label":"Gendert:","_VisitorExperience.DetailPage.InfoDisplay.InfoImportedLabel.Label":"Importiert:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraMakeLabel.Label":"Hersteller:","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraModelLabel.Label":"Modell:","_VisitorExperience.DetailPage.InfoDisplay.InfoSoftwareLabel.Label":"Software:","_VisitorExperience.DetailPage.InfoDisplay.InfoShutterLabel.Label":"Verschlusszeit:","_VisitorExperience.DetailPage.InfoDisplay.InfoApertureLabel.Label":"Blende:","_VisitorExperience.DetailPage.InfoDisplay.InfoMaxApertureLabel.Label":"Max. Blende:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureBiasLabel.Label":"Belichtungskorrektur:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureLabel.Label":"Belichtung:","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureIndexLabel.Label":"Belichtungsindex:","_VisitorExperience.DetailPage.InfoDisplay.InfoFocalLengthLabel.Label":"Brennweite:","_VisitorExperience.DetailPage.InfoDisplay.InfoDistanceLabel.Label":"Entfernung:","_VisitorExperience.DetailPage.InfoDisplay.InfoSensingLabel.Label":"Abtastung:","_VisitorExperience.DetailPage.InfoDisplay.InfoLightSourceLabel.Label":"Lichtquelle:","_VisitorExperience.DetailPage.InfoDisplay.InfoFlashLabel.Label":"Blitz:","_VisitorExperience.DetailPage.InfoDisplay.InfoMeteringLabel.Label":"Messung:","_VisitorExperience.DetailPage.InfoDisplay.InfoBrightnessLabel.Label":"Helligkeit:","_VisitorExperience.DetailPage.InfoDisplay.InfoISOSpeedLabel.Label":"ISO-Einstellung:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLatitudeLabel.Label":"GPS-Breitengrad:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLongitudeLabel.Label":"GPS-Lngengrad:","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSAltitudeLabel.Label":"GPS-Hhe:","_VisitorExperience.DetailPage.EmptyCAPTCHA.Error":"Bitte geben Sie die im Bild angezeigten Zeichen ein.","_VisitorExperience.AlbumPage.HeaderFooter.SliderSmallest.Tooltip":"Kleinste Darstellung der Fotos","_VisitorExperience.AlbumPage.HeaderFooter.Slider.Tooltip":"Gre der Fotos ndern","_VisitorExperience.AlbumPage.HeaderFooter.SliderLargest.Tooltip":"Grte Darstellung der Fotos","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href":"http://help.apple.com/mac2/4/help/other/pgs2/mem_fmset_gen23.html","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip":"Diesen Film herunterladen","_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip":"Weitere Informationen zu diesem Film anzeigen","_VisitorExperience.AlbumPage.AlbumOptions.DownloadUnavailable.Button.Tooltip":"Dieses Album ist momentan nicht zum Herunterladen verfgbar","_VisitorExperience.NoPasswordEntered.Back.Link":"Zurck zur MobileMe Galerie","_VisitorExperience.AlbumUnavailable":"Das Album ist nicht zugnglich.","_VisitorExperience.AlbumUnavailable.Back.Link":"Zurck zur MobileMe Galerie","_VisitorExperience.QTError.UnableToPlay":"QuickTime kann diesen Film nicht abspielen. Bitte versuchen Sie es erneut.","_VisitorExperience.QTError.GetQuickTime":"QuickTime installieren","_VisitorExperience.QTError.QuickTimeRequired":"Sie bentigen QuickTime 7.2 , um diesen Film ansehen zu knnen.","_VisitorExperience.QTError.Href":"http://www.apple.com/de/quicktime/","_VisitorExperience.AlbumPage.SplashVideoView.Description.Label":"Beschreibung","_VisitorExperience.FlashError.UnableToView":"Diese Funktion bentigt Flash Player.","_VisitorExperience.FlashError.GetFlash Player":"Installieren Sie die neuste Version von Flash Player","_VisitorExperience.FlashError.Href":"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash&P5_Language=German","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.MobilePosting":"Sie knnen auch ber Mobiltelefon oder E-Mail an diesem Album mitwirken. Senden Sie einfach Ihre Fotos oder Filme an: %@","_VisitorExperience.AlbumOptions.TellAFriend.NoFromAddress.Error":"Bitte geben Sie Ihre E-Mail-Adresse in das Feld Von: ein.","_VisitorExperience.AppleLogo.Href":"http://www.apple.com/de/mobileme/features/gallery.html","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin.Tooltip":"Sich als Eigentmer dieser Web Gallerie anmelden","_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip":"Hilfe-Artikel fr MobileMe Galerie ansehen","_DotMacWebGallery":"MobileMe Galerie","_Gallery.DefaultTitle":"Meine Galerie","_VisitorExperience.GalleryBranding.Tooltip":"Erfahren Sie mehr ber MobileMe","_VisitorExperience.PaginationLabel":"Seite %@1 von %@2","_VisitorExperience.Pagination.PrevButton.Tooltip":"Zur vorigen Seite","_VisitorExperience.Pagination.NextButton.Tooltip":"Zur nchsten Seite","_VisitorExperience.Pagination.Dot.Tooltip":"Gehe zu Seite %@","_VisitorExperience.AlbumOptions.Help.Button":"?","_VisitorExperience.AlbumOptions.Help.Button.Tooltip":"Weitere Informationen zum Hinzufgen von Fotos und Filmen zu diesem Album","_VisitorExperience.AlbumOptions.Help.Button.MobilePosting.Href":"http://help.apple.com/mac/4/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17106.html","_VisitorExperience.AlbumOptions.Help.Button.AddtoAlbum.Href":"http://help.apple.com/mac/4/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17105.html","_VisitorExperience.IndexPage.errorGettingData":"Beim Laden dieser Seite ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.","_VisitorExperience.IndexPage.stillPublishing":"Diese Seite wird gerade verffentlicht. Bitte versuchen Sie es spter erneut.","_TermsOfService":"Servicebedingungen","_TermsOfService.Href":"http://www.apple.com/legal/mobileme/de/terms.html","_TermsOfService.Tooltip":"MoibleMe Servicebedingungen ansehen","_PrivacyPolicy":"Datenschutz","_PrivacyPolicy.Href":"http://www.apple.com/de/legal/privacy","_PrivacyPolicy.Tooltip":"Datenschutzrichtlinien anzeigen","_VisitorExperience.DetailPage.Anonymous":"Anonymer Besucher","_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip":"Eine Vollbild-Version dieses Albums anzeigen","_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip":"Vollbild-Modus beenden","_VisitorExperience.AlbumOptions.DownloadMovie.InstructionalText":"Whlen Sie die Film-Gre, die Sie herunterladen mchten:","_VisitorExperience.AlbumOptions.DownloadMovie.About":"ungefhr %@ MB","_VisitorExperience.AlbumOptions.DownloadMovie.iPodOriPhone":"iPod oder iPhone","_VisitorExperience.AlbumOptions.DownloadMovie.macPCOrAppleTV":"Mac, PC oder","_VisitorExperience.GalleryPage.Subscribe.Button":"Aktualisierungen abonnieren","_VisitorExperience.GalleryPage.Subscribe.Button.Tooltip":"Diese Galerie abonnieren","_VisitorExperience.AlbumOptions.Subscribe.Title":"Abonnieren","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText":"Bestimmen Sie, wie wir Sie ber Aktualisierungen von <strong>%@</strong> informieren sollen:","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText2":"Mich ber Aktualisierungen von <strong>%@</strong> informieren:","_VisitorExperience.AlbumOptions.Subscribe.Done.Button":"OK","_VisitorExperience.AlbumOptions.Subscribe.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button":"Kopieren","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button.Tooltip":"Link in die Zwischenablage kopieren","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button":"Abbrechen","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button.Tooltip":"Abbrechen","_VisitorExperience.AlbumOptions.Subscribe.ByEmail":"per E-Mail","_VisitorExperience.AlbumOptions.Subscribe.ViaRSS":"per RSS","_VisitorExperience.AlbumOptions.Subscribe.IniPhoto":"in iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText1":"Den RSS-Feed fr dieses Album ffnen.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText2":"Sie knnen auch den Link unten kopieren und einsetzen:","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText1":"Einen Foto-Feed fr dieses Album in iPhoto ffnen.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText2":"iPhoto ldt die aktuellsten Fotos herunter und aktualisiert das Album automatisch.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText1":"Eine Benachrichtigung per E-Mail bekommen, wenn dieses Album aktualisiert wird.","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText2":"Eine Besttigung wird an Ihre E-Mail-Adresse gesendet. Befolgen Sie die Anweisungen, um Ihr Abonnement fertigzustellen.","_VisitorExperience.AlbumOptions.Subscribe.EmailError.Error":"Geben Sie Ihre E-Mail-Adresse bitte erneut ein.","_VisitorExperience.NoPasswordEntered":"Der Zugriff auf dieses Album ist eingeschrnkt. Bitte wenden Sie sich zwecks Kennwort und Benutzername an den Eigentmer des Albums","_VisitorExperience.Description.More":"Mehr","_VisitorExperience.Visited.LastUpdate":"Aktualisiert:","_VisitorExperience.Visited.Calculating":"Berechnung...","_VisitorExperience.Visited.Today":"Heute","_VisitorExperience.Visited.Date":"%@3/%@1/%@2"});Object.extend(String.Japanese,{"_VisitorExperience.AlbumOptions.FileUploader.WarningText":"","_VisitorExperience.AlbumOptions.FileUploader.MaxUploadCount":"500","_VisitorExperience.AlbumOptions.FileUploader.MaxSpace":"","_VisitorExperience.AlbumOptions.FileUploader.CancelConfirm":"","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button":"","_VisitorExperience.AlbumOptions.FileUploader.Clear.Button.Tooltip":"","_VisitorExperience.IndexPage.GalleryEmpty":"","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Link":"MobileMe","_VisitorExperience.IndexPage.GalleryEmpty.LearnMore.Href":"http://help.apple.com/mac/2/help/indexwgv.html","_VisitorExperience.IndexPage.Albums.Title":"","_VisitorExperience.IndexPage.Movies.Title":"","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button":"","_VisitorExperience.AlbumPage.HeaderFooter.ShowOptions.Button.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button":"","_VisitorExperience.AlbumPage.HeaderFooter.HideOptions.Button.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link":"","_VisitorExperience.AlbumPage.HeaderFooter.GridView.Link.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link":"","_VisitorExperience.AlbumPage.HeaderFooter.MosaicView.Link.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link":"","_VisitorExperience.AlbumPage.HeaderFooter.CarouselView.Link.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link":"Cover Flow","_VisitorExperience.AlbumPage.HeaderFooter.CoverFlowView.Link.Tooltip":"Cover Flow","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link":"","_VisitorExperience.AlbumPage.HeaderFooter.Slideshow.Link.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser":"","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Black.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.Gray.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.White.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.ColorChooser.DarkGray.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.BackToGallery.Button.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin":"","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLoggedInAs":": %@","_VisitorExperience.AlbumPage.HeaderFooter.Help":"","_VisitorExperience.IndexPage.HeaderFooter.Help.Href":"http://help.apple.com/mac/2/help/indexwgv.html","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.AddToAlbum.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.MobilePosting.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.TellAFriend.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.WebWidget.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.Download.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button":"","_VisitorExperience.AlbumPage.AlbumOptions.Subscribe.Button.Tooltip":"RSS","_VisitorExperience.AlbumOptions.AddToAlbum.Title":"","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalText":"","_VisitorExperience.AlbumOptions.AddToAlbum.InstructionalTextAperture":"","_VisitorExperience.AlbumOptions.AddToAlbum.Name.Label":"","_VisitorExperience.AlbumOptions.AddToAlbum.Address.Label":"","_VisitorExperience.AlbumOptions.AddToAlbum.Address.GhostText":"URL","_VisitorExperience.AlbumOptions.CAPTCHAText":"","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link":"","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button":"","_VisitorExperience.AlbumOptions.AddToAlbum.Cancel.Button.Tooltip":"","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button":"...","_VisitorExperience.AlbumOptions.AddToAlbum.ChooseFiles.Button.Tooltip":"","_VisitorExperience.AlbumOptions.MobilePosting.Title":"","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalText":"","_VisitorExperience.AlbumOptions.MobilePosting.InstructionalTextAperture":"","_VisitorExperience.AlbumOptions.MobilePosting.AddtoAddressBook.Link":"","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button":"OK","_VisitorExperience.AlbumOptions.MobilePosting.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.TellAFriend.Title":"","_VisitorExperience.AlbumOptions.TellAFriend.InstructionalText":"","_VisitorExperience.AlbumOptions.TellAFriend.To.Label":"","_VisitorExperience.AlbumOptions.TellAFriend.To.GhostText":"","_VisitorExperience.AlbumOptions.TellAFriend.To.InstructionalText":"","_VisitorExperience.AlbumOptions.TellAFriend.From.Label":"","_VisitorExperience.AlbumOptions.TellAFriend.From.GhostText":"","_VisitorExperience.AlbumOptions.TellAFriend.Message.Label":"","_VisitorExperience.AlbumOptions.TellAFriend.Message.GhostText":"","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button":"","_VisitorExperience.AlbumOptions.TellAFriend.Cancel.Button.Tooltip":"","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button":"","_VisitorExperience.AlbumOptions.TellAFriend.Send.Button.Tooltip":"","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLine":"","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.NamePassword":"%@","_VisitorExperience.AlbumOptions.WebWidget.Title":"","_VisitorExperience.AlbumOptions.WebWidget.InstructionalText":"Flash","_VisitorExperience.AlbumOptions.WebWidget.CopySnippet.Link":"","_VisitorExperience.AlbumOptions.WebWidget.Done.Button":"","_VisitorExperience.AlbumOptions.WebWidget.Done.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Download.Title":"","_VisitorExperience.AlbumOptions.Download.InstructionalText":"","_VisitorExperience.AlbumOptions.Download.Download.Button":"","_VisitorExperience.AlbumOptions.Download.Download.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Download.Cancel.Button":"","_VisitorExperience.AlbumOptions.Download.Cancel.Button.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.TitleCaptionTruncated.Link":" >","_VisitorExperience.AlbumPage.SplashVideoView.TitleCaptionTruncated.Link":" >","_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link":"","_VisitorExperience.AlbumPage.SplashVideoView.Download.Link.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link":"Tiny ()","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMobile.Link.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link":"Small (","_VisitorExperience.AlbumPage.SplashVideoView.DownloadSmall.Link.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link":"Medium ()","_VisitorExperience.AlbumPage.SplashVideoView.DownloadMedium.Link.Tooltip":"","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link":"Large ()","_VisitorExperience.AlbumPage.SplashVideoView.DownloadLarge.Link.Tooltip":"","_VisitorExperience.DetailPage.Download.Button.Tooltip":"","_VisitorExperience.DetailPage.ShowInfo.Button.Tooltip":"","_VisitorExperience.DetailPage.Previous.Button.Tooltip":"","_VisitorExperience.DetailPage.Next.Button.Tooltip":"","_VisitorExperience.DetailPage.TitleCaptionTruncated.Link":" >","_VisitorExperience.DetailPageVideo.BackToAlbum.Button":"","_VisitorExperience.DetailPageVideo.TitleCaptionTruncated.Link":" >","_VisitorExperience.DetailPage.InfoDisplay.ContributorInfoText":"%@2%@1","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button":"","_VisitorExperience.DetailPage.InfoDisplay.BackToPhoto.Button.Tooltip":"","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button":"","_VisitorExperience.DetailPage.InfoDisplay.BackToMovie.Button.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.Previous.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.Next.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.Play.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.Pause.Tooltip":"","_VisitorExperience.AlbumPage.SlideshowView.Title":" (%@1%@2)","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMoviesText":"%@1%@2","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosMovieText":"%@1","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMoviesText":"%@","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoMovieText":"11","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button":"iPhoto","_VisitorExperience.AlbumPage.AlbumOptions.AddToIPhoto.Button.ToolTip":"iPhoto","_VisitorExperience.AlbumOptions.TellAFriend.IncludeMobileAddress":"","Loading...":"...","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hours":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.Hour":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minutes":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.Minute":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.Seconds":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.Second":"","_VisitorExperience.AlbumOptions.Download.PreparingDownload":"","_VisitorExperience.AlbumOptions.Download.DownloadReady":"","_VisitorExperience.AlbumOptions.Download.UnableToDownload":"","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMovieText":"1","_VisitorExperience.IndexPage.Movies.AlbumDetails.NoPhotoMoviesText":"%@","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotoNoMovieText":"1","_VisitorExperience.IndexPage.Movies.AlbumDetails.PhotosNoMovieText":"%@ ","_VisitorExperience.DetailPage.MismatchCAPTCHA.Error":"","_VisitorExperience.DetailPage.InvalidURLOrEmail.Error":"%@URL","_VisitorExperience.AlbumOptions.TellAFriend.EmailSending.Error":"","_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error":"","_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error":"%@","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.SubjectLineMovie":"","_VisitorExperience.DetailPage.InfoDisplay.InfoTableImageTitle.Title":"","_VisitorExperience.DetailPage.InfoDisplay.InfoTableFileTitle.Title":"","_VisitorExperience.DetailPage.InfoDisplay.InfoTableCameraTitle.Title":"","_VisitorExperience.DetailPage.InfoDisplay.InfoTableExposureTitle.Title":"","_VisitorExperience.DetailPage.InfoDisplay.InfoWidthLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoHeightLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoOriginalDateLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoDigitizedDateLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoNameLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoSizeLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoModifiedLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoImportedLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraMakeLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoCameraModelLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoSoftwareLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoShutterLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoApertureLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoMaxApertureLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureBiasLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoExposureIndexLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoFocalLengthLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoDistanceLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoSensingLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoLightSourceLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoFlashLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoMeteringLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoBrightnessLabel.Label":"","_VisitorExperience.DetailPage.InfoDisplay.InfoISOSpeedLabel.Label":"ISO","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLatitudeLabel.Label":"GPS","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSLongitudeLabel.Label":"GPS","_VisitorExperience.DetailPage.InfoDisplay.InfoGPSAltitudeLabel.Label":"GPS","_VisitorExperience.DetailPage.EmptyCAPTCHA.Error":"","_VisitorExperience.AlbumPage.HeaderFooter.SliderSmallest.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.Slider.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.SliderLargest.Tooltip":"","_VisitorExperience.AlbumOptions.CAPTCHAHelp.Link.Href":"http://help.apple.com/mac2/2/help/other/pgs2/mem_fmset_gen23.html","_VisitorExperience.DetailPage.DownloadMovie.Button.Tooltip":"","_VisitorExperience.DetailPage.ShowInfoMovie.Button.Tooltip":"","_VisitorExperience.AlbumPage.AlbumOptions.DownloadUnavailable.Button.Tooltip":"","_VisitorExperience.NoPasswordEntered.Back.Link":"MobileMe","_VisitorExperience.AlbumUnavailable":"","_VisitorExperience.AlbumUnavailable.Back.Link":"MobileMe","_VisitorExperience.QTError.UnableToPlay":"QuickTime","_VisitorExperience.QTError.GetQuickTime":"QuickTime","_VisitorExperience.QTError.QuickTimeRequired":"QuickTime 7.2","_VisitorExperience.QTError.Href":"http://www.apple.com/jp/quicktime/","_VisitorExperience.AlbumPage.SplashVideoView.Description.Label":"","_VisitorExperience.FlashError.UnableToView":"Flash Player","_VisitorExperience.FlashError.GetFlash Player":"Flash Player","_VisitorExperience.FlashError.Href":"http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash&P5_Language=Japanese","_VisitorExperience.AlbumOptions.TellAFriend.EmailTemplate.MobilePosting":" : %@","_VisitorExperience.AlbumOptions.TellAFriend.NoFromAddress.Error":"","_VisitorExperience.AppleLogo.Href":"http://www.apple.com/jp/mobileme/features/gallery.html","_VisitorExperience.AlbumPage.HeaderFooter.OwnerLogin.Tooltip":"","_VisitorExperience.AlbumPage.HeaderFooter.Help.Tooltip":"MobileMe","_DotMacWebGallery":"MobileMe","_Gallery.DefaultTitle":"","_VisitorExperience.GalleryBranding.Tooltip":"MobileMe","_VisitorExperience.PaginationLabel":" %@2%@1","_VisitorExperience.Pagination.PrevButton.Tooltip":"","_VisitorExperience.Pagination.NextButton.Tooltip":"","_VisitorExperience.Pagination.Dot.Tooltip":" %@","_VisitorExperience.AlbumOptions.Help.Button":"?","_VisitorExperience.AlbumOptions.Help.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Help.Button.MobilePosting.Href":"http://help.apple.com/mac/2/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17106.html","_VisitorExperience.AlbumOptions.Help.Button.AddtoAlbum.Href":"http://help.apple.com/mac/2/help/indexwgv.html?nav=pgs/wgv_1100.html&content=pgs/wgv17105.html","_VisitorExperience.IndexPage.errorGettingData":"","_VisitorExperience.IndexPage.stillPublishing":"","_TermsOfService":"","_TermsOfService.Href":"http://www.apple.com/legal/mobileme/ja/terms.html","_TermsOfService.Tooltip":".Mac","_PrivacyPolicy":"","_PrivacyPolicy.Href":"http://www.apple.com/jp/legal/privacy/","_PrivacyPolicy.Tooltip":"","_VisitorExperience.DetailPage.Anonymous":"","_VisitorExperience.AlbumPage.CarouselView.EnterFullscreen.Tooltip":"","_VisitorExperience.AlbumPage.CarouselView.ExitFullscreen.Tooltip":"","_VisitorExperience.AlbumOptions.DownloadMovie.InstructionalText":"","_VisitorExperience.AlbumOptions.DownloadMovie.About":"","_VisitorExperience.AlbumOptions.DownloadMovie.iPodOriPhone":"iPodiPhone","_VisitorExperience.AlbumOptions.DownloadMovie.macPCOrAppleTV":"MacPC","_VisitorExperience.GalleryPage.Subscribe.Button":"","_VisitorExperience.GalleryPage.Subscribe.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Subscribe.Title":"","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText":"%@","_VisitorExperience.AlbumOptions.Subscribe.InstructionalText2":"%@","_VisitorExperience.AlbumOptions.Subscribe.Done.Button":"OK","_VisitorExperience.AlbumOptions.Subscribe.Done.Button.Tooltip":"OK","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button":"","_VisitorExperience.AlbumOptions.Subscribe.Copy.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button":"","_VisitorExperience.AlbumOptions.Subscribe.Cancel.Button.Tooltip":"","_VisitorExperience.AlbumOptions.Subscribe.ByEmail":"","_VisitorExperience.AlbumOptions.Subscribe.ViaRSS":"RSS","_VisitorExperience.AlbumOptions.Subscribe.IniPhoto":"iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText1":"RSS","_VisitorExperience.AlbumOptions.Subscribe.SyndicationRSS.InstructionalText2":"","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText1":"iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationiPhoto.InstructionalText2":"iPhoto","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText1":"","_VisitorExperience.AlbumOptions.Subscribe.SyndicationEmail.InstructionalText2":"","_VisitorExperience.AlbumOptions.Subscribe.EmailError.Error":"","_VisitorExperience.NoPasswordEntered":"","_VisitorExperience.Description.More":"...","_VisitorExperience.Visited.LastUpdate":":","_VisitorExperience.Visited.Calculating":"...","_VisitorExperience.Visited.Today":"","_VisitorExperience.Visited.Date":"%@3/%@1/%@2"});SC.Validator.EmailOrUrl=SC.Validator.extend({validate:function(form,field){return(field.get('fieldValue').match(/.+@.+\...+/)||field.get('fieldValue').match(/[^.]+\.[^.]+/));},validateError:function(form,field){return"_VisitorExperience.DetailPage.InvalidURLOrEmail.Error".loc(field.get('fieldValue'));}});SC.Validator.EmailOrUrlOrEmpty=SC.Validator.EmailOrUrl.extend({validate:function(form,field){var value=field.get('fieldValue');return(value&&value.length>0)?(value.match(/.+@.+\...+/)||value.match(/[^.]+\.[^.]+/)):true;}});SC.Validator.Email=SC.Validator.extend({validate:function(form,field){return field.get('fieldValue').match(/.+@.+\...+/);},validateError:function(form,field){value=field.get('fieldValue');if(value.length==0)
{if(Gallery.workspace.get("showingSyndicationPanel")==true)
return"_VisitorExperience.AlbumOptions.Subscribe.EmailError.Error".loc();else
return"_VisitorExperience.AlbumOptions.TellAFriend.NoFromAddress.Error".loc();}
return"_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error".loc(value);}});SC.Validator.EmailOrEmpty=SC.Validator.Email.extend({validate:function(form,field){var value=field.get('fieldValue');return(value&&value.length>0)?value.match(/.+@.+\...+/):true;}});SC.Validator.EmailList=SC.Validator.extend({validate:function(form,field)
{var value=field.get('fieldValue');if(value&&value.length==0||value=="")return false;var emails=value.split(',');for(var i=0;i<emails.length;i++)
{if(!emails[i].match(/.+@.+\...+/))
{return false;}}
return true;},validateError:function(form,field)
{var value=field.get('fieldValue');if(value&&value.length==0||value=="")return"_VisitorExperience.AlbumOptions.TellAFriend.NoAddress.Error".loc();var emails=value.split(',');for(var i=0;i<emails.length;i++)
{if(!emails[i].match(/.+@.+\...+/))
{return"_VisitorExperience.AlbumOptions.TellAFriend.InvalidEmail.Error".loc(emails[i]);}}}});SC.Validator.NotEmptyCaptcha=SC.Validator.extend({validate:function(form,field){var value=field.get('fieldValue');var ret=!!(value||value.length>0);return ret;},validateError:function(form,field){return"_VisitorExperience.DetailPage.EmptyCAPTCHA.Error".loc();}});if(typeof(AC)=="undefined"){AC={};}
AC.Quicktime={controllers:[],packageMovie:function(name,fileUrl,options){function addParameter(parent,name,value){if(!parent){return;}
var param=document.createElement('param');param.setAttribute('value',value);param.setAttribute('name',name);parent.appendChild(param);}
function createOuterObject(name,fileUrl,options){var outerObject=document.createElement('object');if(AC.Detector.isiPhone()&&options.posterFrame){addParameter(outerObject,'src',options.posterFrame);addParameter(outerObject,'href',fileUrl);addParameter(outerObject,'target','myself');}else{addParameter(outerObject,'src',fileUrl);}
outerObject.setAttribute('id',name);var activexVersion='6,0,2,0';if(null!=options&&''!=options.codebase&&typeof(options.codebase)!='undefined'){activexVersion=options.codeBase;}
outerObject.setAttribute('codebase','http://www.apple.com/qtactivex/qtplugin.cab#version='+activexVersion);return outerObject;}
function createInnerObject(name,fileUrl,options){var innerObject=document.createElement('object');innerObject.setAttribute('type','video/quicktime');innerObject.setAttribute('data',fileUrl);innerObject.setAttribute('id',name+"Inner");return innerObject;}
function configureMovieOptions(){if(null==options||typeof(options)=='undefined'){return false;}
for(var property in options){var attributeName=property.toLowerCase();switch(attributeName){case('type'):case('src'):case('data'):case('classid'):case('name'):case('id'):break;case('class'):Element.addClassName(outerObject,options[property]);break;case('innerId'):if(innerObject){innerObject.setAttribute('id',options[property]);}
break;case('width'):case('height'):outerObject.setAttribute(attributeName,options[property]);if(innerObject){innerObject.setAttribute(attributeName,options[property]);}
break;default:addParameter(outerObject,attributeName,options[property]);addParameter(innerObject,attributeName,options[property]);break;}}}
if(name==null||fileUrl==null){throw new TypeError('Valid Name and File URL are required arguments.');}
var outerObject=createOuterObject(name,fileUrl,options);if(!AC.Detector.isIEStrict()){var innerObject=createInnerObject(name,fileUrl,options);try{outerObject.appendChild(innerObject);outerObject.inner=innerObject;}catch(e){}}else{Event.observe(window,'unload',function(){try{outerObject.Stop();}catch(e){;}
outerObject.style.display='none';outerObject=null;});}
configureMovieOptions();addParameter(outerObject,'saveembedtags',true);addParameter(innerObject,'saveembedtags',true);outerObject.setAttribute('classid','clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B');outerObject.toMarkup=function(){if(!outerObject.outerHTML){return;}
var markup="";markup=outerObject.outerHTML.replace('</OBJECT>','');for(var i=0;i<outerObject.childNodes.length;i++){markup+=outerObject.childNodes[i].outerHTML;}
markup+='</OBJECT>';return markup;};return outerObject;},swapMovie:function(container,oldMovie,newMovie){var isIE=AC.Detector.isIEStrict();if(isIE&&oldMovie){oldMovie.style.display='none';}
Element.removeAllChildNodes(container);var movieReference=null;if(!isIE){container.appendChild(newMovie);movieReference=newMovie;}else{container.innerHTML=newMovie.toMarkup();movieReference=container.firstChild;movieReference.style.display='block';}
return movieReference;},render:function(movie,element,options){var target=$(element);var placeholderContent=target.innerHTML;if(!AC.Detector.isQTInstalled()){Element.addClassName(target,'static');return;}
target.innerHTML='';Element.addClassName(target,'loading');Element.removeClassName(target,'loaded');target.appendChild(movie);var showContent=function(element,content){return(function(){Element.removeClassName(element,"loading");element.innerHTML='';element.innerHTML=content;});};var options=options?options:{};var delay=6000;if("delay"in options){delay=options.delay;}
if(!AC.Detector.isOpera()){var qtSuccessCheck=setTimeout(showContent(target,placeholderContent),delay);}
var movieLoaded=function(){checkController.monitorMovie();Element.removeClassName(element,"loading");Element.addClassName(element,"loaded");clearTimeout(qtSuccessCheck);};var movieFinished=function(){return;};if("finishedState"in options){var showFinishedState=function(target,content){return(function(){checkController.detachFromMovie();movie.style.display='none';movie=null;target.innerHTML='';if(typeof(content)=='string'){target.innerHTML=content;}else{target.appendChild(content);}});};movieFinished=showFinishedState(target,options.finishedState);}
var checkController=new AC.QuicktimeController(movie,{onMoviePlayable:movieLoaded,onMovieFinished:movieFinished});}};AC.QuicktimeController=Class.create();AC.QuicktimeController.prototype={movie:null,options:null,movieAttacher:null,attachDelay:10,movieWatcher:null,monitorDelay:400,currentTime:0,percentLoaded:0,movieSize:0,allowAttach:true,controllerPanel:null,currentControl:null,playControl:null,pauseControl:null,slider:null,track:null,playHead:null,loadedProgress:null,volumeSlider:null,volumeTrack:null,volumeHead:null,volume:255,isJogging:false,hardPaused:false,duration:0,finished:false,playing:false,initialize:function(movie,options){if(typeof(movie)!='undefined'){this.attachToMovie(movie,options);}
Event.observe(window,'unload',function(){this.detachFromMovie();this.movie=null;}.bind(this));},attachToMovie:function(movie,options){this.options=options||{};Event.observe(window,'unload',function(){this.detachFromMovie();}.bind(this));var attach=function(onMoviePlayable,onMovieError,startTime){if(!this.allowAttach){return;}
var status="";try{this.movie=movie;status=this.movie.GetPluginStatus();}catch(e){try{this.movie=movie.inner;status=this.movie.GetPluginStatus();}catch(e){this.movie=null;}}
var duration=new Date().getTime()-startTime;if(status=='Playable'||status=='Complete'||(SC.isFireFox()&&status=='Loading')){clearInterval(this.movieAttacher);if(!this.alreadyRecorded){AC.Quicktime.controllers.push(this);this.alreadyRecorded=true;}
if(typeof(onMoviePlayable)=='function'){if(SC.isSafari()&&Gallery.albumController.get('isProtected'))
{var qtUrl=this.GetURL();var truthUrl=Gallery.albumController.get('url');if(qtUrl.indexOf(truthUrl)!=0)return;}
onMoviePlayable();}}else if(status&&status.match(/error/i)||duration>1000000){if(SC.isSafari()&&Gallery.albumController.get('isProtected'))return;clearInterval(this.movieAttacher);if(typeof(onMovieError)=='function'){onMovieError();}}};clearInterval(this.movieAttacher);if(null==document.getElementById(movie.id)){throw new ReferenceError('Movie has to be appended to document prior to initializing controller.');}
this.movieAttacher=setInterval(attach.bind(this,this.options.onMoviePlayable,this.options.onMovieError,new Date().getTime()),this.attachDelay);},detachFromMovie:function(){this.allowAttach=false;clearInterval(this.movieAttacher);clearTimeout(this.movieWatcher);AC.Quicktime.controllers=AC.Quicktime.controllers.without(this);this.movie=null;this.reset();this.allowAttach=true;},reset:function(){this.duration=0;this.movieSize=0;this.percentLoaded=0;if(this.slider){this.slider.setValue(0);this.slider.trackLength=this.slider.maximumOffset()-this.slider.minimumOffset();}
if(this.volumeSlider){this.slider.setValue(this.volume);}},render:function(containerId){this.controllerPanel=document.createElement('div');this.controllerPanel.id="detailMovieControls";this.playControl=document.createElement('div');Element.addClassName(this.playControl,'control');Element.addClassName(this.playControl,'play');this.playControl.innerHTML='';this.playControl.onclick=this.Play.bind(this);this.pauseControl=document.createElement('div');Element.addClassName(this.pauseControl,'control');Element.addClassName(this.pauseControl,'pause');this.pauseControl.innerHTML='';this.pauseControl.onclick=this.Stop.bind(this);var playing=false;if(null!=this.movie){playing=this.GetAutoPlay();}
this.currentControl=(playing)?this.pauseControl:this.playControl;this.controllerPanel.appendChild(this.currentControl);this.volumeSlider=document.createElement('div');this.volumeSlider.id="volumeSlider";this.trackVolume=document.createElement('div');this.trackVolume.id="trackVolume";this.handleVolume=document.createElement('div');this.handleVolume.id="handleVolume";this.trackVolume.appendChild(this.handleVolume);this.volumeSlider.appendChild(this.trackVolume);if(Gallery.workspace.detailView.get("atiMovieMovieView"))
{this.fullscreenButton=document.createElement('button');this.fullscreenButton.id="fullscreenMovieButton";this.fullscreenButton.onclick=Gallery.workspace.detailView.movieView.toggleFullscreen;if(SC.isIE6())
{this.fullscreenButton.onmouseover=function(){Element.addClassName($('fullscreenMovieButton'),"hover");};this.fullscreenButton.onmouseout=function(){Element.removeClassName($('fullscreenMovieButton'),"hover");};}
if(Gallery.fullscreen)
{this.fullscreenButton.title="_VisitorExperience.AlbumPage.SplashVideoView.ExitFullscreen.Tooltip".loc();Element.addClassName(this.fullscreenButton,"closeFullscreen");}
else
{this.fullscreenButton.title="_VisitorExperience.AlbumPage.SplashVideoView.EnterFullscreen.Tooltip".loc();Element.addClassName(this.fullscreenButton,"openFullscreen");}
this.controllerPanel.appendChild(this.fullscreenButton);}
this.controllerPanel.appendChild(this.volumeSlider);this.timelineSlider=document.createElement('div');this.timelineSlider.id="timelineSlider";this.timelineSliderCapLeft=document.createElement('div');this.timelineSliderCapLeft.id="timelineSliderCapLeft";this.timelineSlider.appendChild(this.timelineSliderCapLeft);this.timeLabel=document.createElement('div');this.timeLabel.id="timeLabel";this.timeLabel.innerHTML="00:00:00";this.timelineSlider.appendChild(this.timeLabel);this.loadingDiv=document.createElement('div');this.loadingDiv.id="loadingDiv";this.loading=document.createElement('div');this.loading.id="loading";this.loadingDiv.appendChild(this.loading);this.timelineSlider.appendChild(this.loadingDiv);this.trackBG=document.createElement('div');this.trackBG.id="trackBG";this.timelineSlider.appendChild(this.trackBG);this.trackTime=document.createElement('div');this.trackTime.id="trackTime";this.handleTime=document.createElement('div');this.handleTime.id="handleTime";this.trackTime.appendChild(this.handleTime);this.timelineSlider.appendChild(this.trackTime);this.controllerPanel.appendChild(this.timelineSlider);if(Gallery.fullscreen)
{this.controllerPanel.style.position="relative";this.controllerPanel.style.top=Gallery.workspace.detailView.movieView.fsLetterBoxHeight;}
if(containerId){$(containerId).appendChild(this.controllerPanel);if(this.movie){this.monitorMovie();}}
return this.controllerPanel;},setControllerWidth:function(width)
{if(Gallery.workspace.detailView.get("atiMovieMovieView"))
{var fsGlyphWidth=30;var difference=(width>320)?width-320:0;if(Gallery.fullscreen)
{var newDiff=Math.round(width/2);this.controllerPanel.style.width=newDiff+"px";this.timelineSlider.style.width=newDiff-82-fsGlyphWidth+"px";this.trackBG.style.width=newDiff-150-fsGlyphWidth+"px";this.trackTime.style.width=newDiff-136+"px";this.loading.style.width=newDiff-142-fsGlyphWidth+"px";this.loadingDiv.style.width=newDiff-142-(SC.isIE()?26:0)-fsGlyphWidth+"px";this.slider.trackLength=newDiff-136-fsGlyphWidth;if(SC.isIE6()&&!window._haveResetIE6WindowSize){setTimeout("window.resizeTo(screen.width+10, screen.availHeight+20); window.moveTo(0,0);",5);window._haveResetIE6WindowSize=true;}}else{this.controllerPanel.style.width=320+difference+"px";this.timelineSlider.style.width=238+difference-fsGlyphWidth+"px";this.trackBG.style.width=170+difference-fsGlyphWidth+"px";this.trackTime.style.width=184+difference+"px";this.loading.style.width=178+difference-fsGlyphWidth+"px";this.loadingDiv.style.width=178+difference-(SC.isIE()?26:0)-fsGlyphWidth+"px";this.slider.trackLength=184+difference-fsGlyphWidth;}
if(SC.isIE()){this.handleTime.style.marginLeft=-174-difference+"px";}
if(SC.isIE()&&Gallery.fullscreen){this.handleTime.style.marginLeft=(178+difference)/-2+74+"px";}}
else
{var difference=(width>320)?width-320:0;this.controllerPanel.style.width=320+difference+"px";this.timelineSlider.style.width=238+difference+"px";this.trackBG.style.width=170+difference+"px";this.trackTime.style.width=184+difference+"px";this.loading.style.width=178+difference+"px";this.loadingDiv.style.width=178+difference-(SC.isIE()?26:0)+"px";this.slider.trackLength=184+difference;if(SC.isIE()){this.handleTime.style.marginLeft=-174-difference+"px";}
if(SC.isIE()&&Gallery.fullscreen){this.handleTime.style.marginLeft=(178+difference)/-2+74+"px";}}},monitorMovie:function(){function monitor(controller){this.timeScale=controller.GetTimeScale();return(function(){if(controller.controllerPanel!==null){var shouldBePauseable=controller.isPlaying()&&(controller.currentControl==controller.playControl);var shouldBePlayable=!controller.isPlaying()&&(controller.currentControl==controller.pauseControl);if(!controller.isJogging&&shouldBePauseable){controller.controllerPanel.replaceChild(controller.pauseControl,controller.currentControl);controller.currentControl=controller.pauseControl;}else if(!controller.isJogging&&shouldBePlayable){controller.controllerPanel.replaceChild(controller.playControl,controller.currentControl);controller.currentControl=controller.playControl;}
if(controller.percentLoaded<=1){var trackWidth=Element.getDimensions(controller.trackBG).width;var loaded=controller.GetMaxBytesLoaded()/controller.GetMovieSize();if(!isNaN(loaded)&&0!==loaded){controller.percentLoaded=loaded;}
if(loaded!=1)
{Element.removeClassName($('controller'),"loaded");Element.addClassName($('controller'),"loading");}
else
{Element.removeClassName($('controller'),"loading");Element.addClassName($('controller'),"loaded");}
var progressWidth=trackWidth*controller.percentLoaded;Element.setStyle(controller.loading,{width:progressWidth+8+'px'});}
if(controller.isPlaying()){controller.slider.setValue(controller.GetTime()/controller.GetDuration());var time=controller.GetTime();var sec=isNaN(time/this.timeScale)?0:Math.floor(time/this.timeScale);var min=Math.floor(sec/60);var hr=Math.floor(min/60);time=((hr%24>9)?"":"0")+hr+":";time+=((min%60>9)?"":"0")+(min-(hr*60))+":";time+=((sec%60>9)?"":"0")+(sec-(min*60));controller.timeLabel.innerHTML=time;}
else if(controller.isFinished())
{controller.slider.setValue(1);}}
if(controller.isPlaying()){if(!controller.playing){controller.playing=true;if(typeof(controller.options.onMovieStart)=='function'){controller.options.onMovieStart();}}}else{if(controller.playing){controller.playing=false;if(typeof(controller.options.onMovieStop)=='function'){controller.options.onMovieStop();}}}
if(controller.isFinished()){if(!controller.finished){if(typeof(controller.options.onMovieFinished)=='function'){controller.options.onMovieFinished();}
controller.finished=true;}}else{controller.finished=false;}
if(controller.movie!==null){controller.movieWatcher=setTimeout(monitorCallback,controller.monitorDelay);}});}
var monitorCallback=monitor(this);if(this.controllerPanel!==null){var sliderVolumeChange=function(value){var newValue=Math.floor(value*255);try
{this.SetVolume(newValue);}catch(e){}}.bind(this);this.volumeSlider=new Control.Slider(this.handleVolume,this.trackVolume,{onSlide:sliderVolumeChange,onChange:sliderVolumeChange,axis:'horizontal',minimum:0,maximum:255,increment:1,sliderValue:parseFloat(Gallery.workspace.detailView.movieView.volume/255)});var endTime=this.GetEndTime();this.slider=new Control.Slider(this.handleTime,this.trackTime,{onSlide:function(value){if(isNaN(value)){return;}
this.slider.translateToPx(value);try{this.isJogging=true;this.SetTime(value*this.GetDuration());if(!this.isPlaying())
{this.movie.Stop();}}catch(e){}}.bind(this),onChange:function(value){if(isNaN(value)){return;}
this.slider.translateToPx(value);if(!this.isPlaying()&&!this.hardPaused&&!this.isFinished()){try{}catch(e){}}
this.isJogging=false;}.bind(this),axis:'horizontal',minimum:0,maximum:endTime,increment:1,sliderValue:0.0});}
this.movieWatcher=setTimeout(monitorCallback,this.monitorDelay);},Play:function(){if(null!=this.movie){this.hardPaused=false;this.movie.Play();}},Stop:function(){this.hardPaused=true;this.movie.Stop();},Rewind:function(){if(null!=this.movie){this.movie.Stop();this.movie.Rewind();}},Step:function(count){this.movie.Step(count);},ShowDefaultView:function(){this.movie.ShowDefaultView();},GoPreviousNode:function(){this.movie.GoPreviousNode();},GetQuicktimeVersion:function(){return this.movie.GetQuickTimeVersion();},GetQuicktimeLanguage:function(){return this.movie.GetQuicktimeLanguage();},GetQuicktimeConnectionSpeed:function(){return this.movie.GetQuicktimeConnectionSpeed();},GetIsQuickTimeRegistered:function(){return this.movie.GetIsQuickTimeRegistered();},GetComponentVersion:function(){return this.movie.GetComponentVersion();},GetPluginVersion:function(){return this.movie.GetPluginVersion();},ResetPropertiesOnReload:function(){this.movie.ResetPropertiesOnReload();},GetPluginStatus:function(){return this.movie.GetPluginStatus();},GetAutoPlay:function(){return this.movie.GetAutoPlay();},SetAutoPlay:function(autoPlay){this.movie.SetAutoPlay(autoPlay);},GetControllerVisible:function(){return this.movie.GetControllerVisible();},SetControllerVisible:function(visible){this.movie.SetControllerVisible(visible);},GetRate:function(){return this.movie.GetRate();},SetRate:function(rate){this.movie.SetRate();},GetTime:function(){var actualTime=0;try{actualTime=this.movie.GetTime();}
catch(e){}
if(0===actualTime){actualTime=this.currentTime+this.monitorDelay;}else{this.currentTime=actualTime;}
return actualTime;},SetTime:function(time){this.movie.SetTime(time);},GetVolume:function(){return this.movie.GetVolume();},SetVolume:function(volume){Gallery.workspace.detailView.movieView.volume=volume;this.movie.SetVolume(volume);},GetMute:function(){return this.movie.GetMute();},SetMute:function(mute){this.movie.SetMute();},GetMovieName:function(){return this.movie.GetMovieName();},SetMovieName:function(movieName){this.movie.SetMovieName(movieName);},GetMovieID:function(){return this.movie.GetMovieID();},SetMovieID:function(movieID){this.movie.SetMovieID(movieID);},GetStartTime:function(){return this.movie.GetStartTime();},SetStartTime:function(time){this.movie.SetStartTime(time);},GetEndTime:function(){return this.movie.GetEndTime();},SetEndTime:function(time){this.movie.SetEndTime(time);},GetBgColor:function(){return this.movie.GetBgColor();},SetBgColor:function(color){this.movie.SetBgColor(color);},GetIsLooping:function(){return this.movie.GetIsLooping();},SetIsLooping:function(loop){this.movie.SetIsLooping(loop);},GetLoopIsPalindrome:function(){return this.movie.GetLoopIsPalindrome();},SetLoopIsPalindrome:function(loop){this.movie.SetLoopIsPalindrome(loop);},GetPlayEveryFrame:function(){return this.movie.GetPlayEveryFrame();},SetPlayEveryFrame:function(playAll){this.movie.SetPlayEveryFrame(playAll);},GetHREF:function(){return this.movie.GetHREF();},SetHREF:function(url){this.movie.SetHREF(url);},GetTarget:function(){return this.movie.GetTarget();},SetTarget:function(target){this.movie.SetTarget(target);},GetQTNEXTUrl:function(){return this.movie.GetQTNEXTUrl();},SetQTNEXTUrl:function(index,url){this.movie.SetQTNEXTUrl(index,url);},GetURL:function(){return this.movie.GetURL();},SetURL:function(url){this.movie.SetURL(url);this.reset();},GetKioskMode:function(){return this.movie.GetKioskMode();},SetKioskMode:function(kioskMode){this.movie.SetKioskMode(kioskMode);},GetDuration:function(){if(null==this.duration||0===this.duration){try{this.duration=this.movie.GetDuration();}catch(e){this.duration=null;}}
return this.duration;},GetMaxTimeLoaded:function(){return this.movie.GetMaxTimeLoaded();},GetTimeScale:function(){return this.movie.GetTimeScale();},GetMovieSize:function(){if(0===this.movieSize){this.movieSize=this.movie.GetMovieSize();}
return this.movieSize;},GetMaxBytesLoaded:function(){return this.movie.GetMaxBytesLoaded();},GetTrackCount:function(){return this.movie.GetTrackCount();},GetMatrix:function(){return this.movie.GetMatrix();},SetMatrix:function(matrix){this.movie.SetMatrix(matrix);},GetRectangle:function(){return this.movie.GetRectangle();},SetRectangle:function(rect){this.movie.SetRectangle(rect);},GetLanguage:function(){return this.movie.GetLanguage();},SetLanguage:function(language){this.movie.SetLanguage(language);},GetMIMEType:function(){return this.movie.GetMIMEType();},GetUserData:function(type){return this.movie.GetUserData(type);},GetIsVRMovie:function(){return this.movie.GetIsVRMovie();},GetHotspotUrl:function(hotspotID){return this.movie.GetHotspotUrl(hotspotID);},SetHotspotUrl:function(hotspotID,url){this.movie.SetHotspotUrl(hotspotID,url);},GetHotspotTarget:function(hotspotID){return this.movie.GetHotspotTarget(hotspotID);},SetHotspotTarget:function(hotspotID,target){this.movie.SetHotspotTarget(hotspotID,target);},GetPanAngle:function(){return this.movie.GetPanAngle();},SetPanAngle:function(angle){this.movie.SetPanAngle(angle);},GetTiltAngle:function(){return this.movie.GetTiltAngle();},SetTiltAngle:function(angle){this.movie.SetTiltAngle(angle);},GetFieldOfView:function(){return this.movie.GetFieldOfView();},SetFieldOfView:function(fov){this.movie.SetFieldOfView(fov);},GetNodeCount:function(){return this.movie.GetNodeCount();},SetNodeID:function(id){this.movie.SetNodeID(id);},GetTrackName:function(index){return this.movie.GetTrackName(index);},GetTrackType:function(index){return this.movie.GetTrackType(index);},GetTrackEnabled:function(index){return this.movie.GetTrackEnabled(index);},SetTrackEnabled:function(index,enabled){this.movie.SetTrackEnabled(index,enabled);},GetSpriteTrackVariable:function(trackIndex,variableIndex){return this.movie.GetSpriteTrackVariable(trackIndex,variableIndex);},SetSpriteTrackVariable:function(variableIndex,value){this.movie.SetSpriteTrackVariable(variableIndex,value);},isPlaying:function(){var playing=false;try{playing=this.movie.GetRate()!==0;}catch(e){}
return playing;},isFinished:function(){var isStopped=true;var isAtEnd=false;try{isStopped=this.movie.GetRate()===0;isAtEnd=this.movie.GetTime()==this.GetDuration();}catch(e){return false;}
return isStopped&&isAtEnd;},toggle:function(){if(this.isPlaying()){this.Stop();}else{this.Play();}}};var commentsActivated=true;var locationpathname='';var commentsAppURL='http://'+HOST+'/WebObjects/Comments.woa/wa/inlineComment';var commentsURL=locationpathname+'?wsc=entry.js&ts='+new Date().getTime();function data(o)
{comments.read=true;comments.update(o);}
function initComments(url,canComment)
{locationpathname=url;commentsActivated=canComment;setLocale();if($('commentSeperator')){$('commentSeperator').style.display='none';}
if($('commentWelcome')){$('commentWelcome').style.display='none';}
if($('commentsEntryFrame')){$('commentsEntryFrame').style.display='none';$('commentsEntryFrame').src="";}
if($('commentsListView')){$('commentsListView').innerHTML='';}
if($('comment_detail')){$('comment_detail').innerHTML='';}
if($('count_0')){$('count_0').innerHTML='';}
decorations.init();decorations.hide('addCommentButton');if(commentsActivated){comments.fetch();}}
var comments={read:false,count:0,canComment:false,hasComments:false,itemOrder:['separatortop','commenttext','separatorbottom','authorblock','dateblock'],view:0,fetch:function()
{var c=comments;var JSONScript=document.getElementById('view_'+c.view);var head=document.getElementsByTagName('head')[0];if(JSONScript!==null){head.removeChild(JSONScript);c.view=c.view+1;}
JSONScript=document.createElement('script');JSONScript.setAttribute('id','view_'+c.view);JSONScript.setAttribute('src',locationpathname+'?wsc=entry.js&ts='+new Date().getTime());JSONScript.setAttribute('type','text/javascript');JSONScript.setAttribute('charset','utf-8');head.appendChild(JSONScript);},update:function(JSONResult)
{var c=comments;c.canComment=(JSONResult.commentsEnabled=='true')?true:false;c.hasComments=(JSONResult.items!==null&&JSONResult.items.length>0)?true:false;c.count=(JSONResult.items!==null)?JSONResult.items.length:0;c.load(JSONResult.items);if(!c.canComment){decorations.hide('addCommentButton');}else{decorations.show('addCommentButton');}
$('comment_detail').innerHTML=c.count;decorations.update_count();decorations.update_post_link();},load:function(items)
{var c=comments;var commentlist;commentlist=document.getElementById('commentsListView');if(commentlist===null){return;}
var comment;var id;commentlist.innerHTML='';for(var i=0;i<items.length;i++){id='comment_'+items[i].commentID.replace(/\-/g,'_');if(document.getElementById(id)===null){comment=document.createElement('div');comment.className='commentblock';var anchor=document.createElement('a');if(anchor!=null){anchor.setAttribute('name',id);anchor.setAttribute('id',id);comment.appendChild(anchor);}
for(var j=0;j<c.itemOrder.length;j++){if(render[c.itemOrder[j]]!==undefined){render[c.itemOrder[j]](comment,items[i]);}}
commentlist.appendChild(comment);comment=null;}}}}
var decorations={list:['count','post_link','commentView','addCommentButton','commentCount','infocommentCount'],init:function()
{var d=decorations;for(var i=0;i<d.list.length;i++){d[d.list[i]]=d.collect(d.list[i]);}},collect:function(name)
{var collection=[];var e,i=0;e=document.getElementById(name);if(e!==null){collection.push(e);}
e=document.getElementById(name+'_'+i);while(e!==null){collection.push(e);i++;e=document.getElementById(name+'_'+i);}
return collection;},update_count:function()
{var d=decorations;for(var i=0;i<d.count.length;i++){d.show('commentCount');d.show('infocommentCount');var s=document.createTextNode(commentCountString(comments.count));var r=d.count[i].firstChild;if(d.count[i].hasChildNodes&&r!=null){d.count[i].replaceChild(s,r);}
else{d.count[i].appendChild(s);}}
$('commentWelcome').innerHTML=commentWelcomeString(comments.count);},update_post_link:function()
{var d=decorations;for(var i=0;i<d.post_link.length;i++){var r=d.post_link[i].firstChild;if(comments.canComment&&r==null){var commentlink=document.createElement('a');var s=document.createElement("img");s.src="/g/images/gallery/comments/btn_addacomment.png";s.style.border='0px';commentlink.appendChild(s);commentlink.onclick=function()
{var name;var path=locationpathname.split('/');if(path.length>0){name=path[path.length-1];}
else{name='entry.html';}
name=name.replace('.html','');name='comment_'+name.replace(/\-/g,'_');blogpath='/'+path[path.length-3]+'/_share/'+path[path.length-2]+'/'+path[path.length-1];$('commentsEntryFrame').src=commentsAppURL+'?url='+encodeURIComponent(decodeURIComponent(blogpath));$('commentsEntryFrame').style.display='block';if(comments.count>0){$('commentSeperator').style.display='block';}
$('commentWelcome').style.display='block';return false;}
commentlink.title=localeStringForKey('addcommentcaption');d.post_link[i].appendChild(commentlink);commentlink=null;}}},hide:function(name)
{var d=decorations;var set=d[name];for(var i=0;i<set.length;i++){if(set[i]!==null){set[i].style.display='none';}}},show:function(name)
{var d=decorations;var set=d[name];for(var i=0;i<set.length;i++){if(set[i]!==null){set[i].style.display='block';}}}};var render={commenttext:function(comment,data)
{var body=document.createElement('div');body.className='commenttext';body.style.overflow='auto';body.innerHTML=data.body.replace(/\r\n/g,'<br />');body.innerHTML='<div style="padding: 5px 10px 0px 15px;">'+body.innerHTML+'</div>';comment.appendChild(body);body=null;},authorblock:function(comment,data)
{if(data.authorID!==''){var author=document.createElement('div');var authorID=document.createTextNode(data.authorID+',');var fn=null;author.className='authorblock';var url=this.authorurl(data);if(url!=null){url.appendChild(authorID);author.appendChild(url);}
else{fn=document.createElement('span');fn.className='fn';fn.appendChild(authorID);author.appendChild(fn);}
comment.appendChild(author);author=null;}
else{return;}},authorurl:function(data)
{var author=null;if(data.authorURL!==undefined&&data.authorURL!==''){author=document.createElement('a');author.setAttribute('href',data.authorURL);}
else{return null;}
return author;},dateblock:function(comment,data)
{var date=document.createElement('div');date.className='dateblock';date.innerHTML='&nbsp;'+data.createDate;comment.appendChild(date);date=null;},separatortop:function(comment)
{var separator=document.createElement('div');separator.className='separatortop';comment.appendChild(separator);separator=null;},separatorbottom:function(comment)
{var separator=document.createElement('div');separator.className='separatorbottom';comment.appendChild(separator);separator=null;}};function listenForChildWindow(status)
{switch(status){case 0:if($('commentWelcome')){$('commentWelcome').style.display='none';}
return;case 1:setTimeout("comments.fetch()",5000);if($('commentSeperator')){$('commentSeperator').style.display='none';}
if($('commentWelcome')){$('commentWelcome').style.display='none';}
if($('commentsEntryFrame')){$('commentsEntryFrame').style.display='none';}
return;default:return;}}
var locale='en';var strings={'en':{'nocomments':'No Comments','onecomment':'1 Comment','manycomments':'%@ Comments','firstcomment':'Be the first to add a comment!','morecomment':'Add your comment','addcomment':'Add a Comment','addcommentcaption':'Opens new window to add a comment'},'fr':{'nocomments':'0 commentaire','onecomment':'1 commentaire','manycomments':'%@ commentaires','firstcomment':'Be the first to add a comment!','morecomment':'Add your comment','addcomment':'Ajouter un commentaire','addcommentcaption':'Ouvre une nouvelle fentre pour le commentaire'},'de':{'nocomments':'0 Kommentare','onecomment':'1 Kommentar','manycomments':'%@ Kommentare','firstcomment':'Be the first to add a comment!','morecomment':'Add your comment','addcomment':'Kommentar hinzufgen','addcommentcaption':'ffnet ein neues Fenster fr den Kommentar'},'ja':{'nocomments':'0','onecomment':'1','manycomments':'%@','firstcomment':'Be the first to add a comment!','morecomment':'Add your comment','addcomment':'','addcommentcaption':''}};function localeStringForKey()
{var key=arguments[0];var lang=strings[locale];if(lang[key]!==null){return stringReplace(lang[key],arguments);}}
function stringReplace(string,values)
{var newString=string;for(var i=1;i<values.length;i++){newString=string.replace('%@',values[i]);string=newString;}
return string;}
function commentCountString(count)
{switch(count){case 0:return localeStringForKey('nocomments');case 1:return localeStringForKey('onecomment');default:return localeStringForKey('manycomments',count);}}
function commentWelcomeString(count)
{switch(count){case 0:return localeStringForKey('firstcomment');default:return localeStringForKey('morecomment');}}
function setLocale()
{var docroot=document.getElementsByTagName('html')[0];switch(docroot.getAttribute('xml:lang')){case'fr':locale='fr';break;case'de':locale='de';break;case'ja':locale='ja';break;case'en':locale='en';break;default:locale='en';}}
if(typeof(AC)=="undefined"){AC={};}
AC.Detector={getAgent:function(){return navigator.userAgent.toLowerCase();},isMac:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/mac/i);},isWin:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/win/i);},isWin2k:function(userAgent){var agent=userAgent||this.getAgent();return this.isWin(agent)&&(agent.match(/nt\s*5/i));},isWinVista:function(userAgent){var agent=userAgent||this.getAgent();return this.isWin(agent)&&(agent.match(/nt\s*6/i));},isWebKit:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/AppleWebKit/i);},isOpera:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/opera/i);},isIE:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/msie/i);},isIEStrict:function(userAgent){var agent=userAgent||this.getAgent();return agent.match(/msie/i)&&!this.isOpera(agent);},isFirefox:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/firefox/i);},isiPhone:function(userAgent){var agent=userAgent||this.getAgent();return!!agent.match(/iPhone/i);},isiTunesOK:function(userAgent){var agent=userAgent||this.getAgent();return this.isMac(agent)||this.isWin2k(agent);},isQTInstalled:function(){var qtInstalled=false;if(navigator.plugins&&navigator.plugins.length){for(var i=0;i<navigator.plugins.length;i++){var plugin=navigator.plugins[i];if(plugin.name.indexOf("QuickTime")>-1){qtInstalled=true;}}}else{qtObj=false;execScript('on error resume next: qtObj = IsObject(CreateObject("QuickTimeCheckObject.QuickTimeCheck.1"))','VBScript');qtInstalled=qtObj;}
return qtInstalled;},getQTVersion:function(){var version="0";if(navigator.plugins&&navigator.plugins.length){for(var i=0;i<navigator.plugins.length;i++){var plugin=navigator.plugins[i];var match=plugin.name.match(/quicktime\D*([\.\d]*)/i);if(match&&match[1]){version=match[1];}}}else{ieQTVersion=null;execScript('on error resume next: ieQTVersion = (Hex(CreateObject("QuickTimeCheckObject.QuickTimeCheck.1").QuickTimeVersion)/1000000)','VBScript');if(ieQTVersion){version=(ieQTVersion+"").split(/\./)[0];}}
return version;},isQTCompatible:function(required,actual){function areCompatible(required,actual){var requiredValue=parseInt(required[0])
if(isNaN(requiredValue)){requiredValue=0;}
var actualValue=parseInt(actual[0])
if(isNaN(actualValue)){actualValue=0;}
if(requiredValue==actualValue){if(required.length>1){return areCompatible(required.slice(1),actual.slice(1));}else{return true;}}else if(requiredValue<actualValue){return true;}else{return false;}}
var expectedVersion=required.split(/\./);var actualVersion=actual?actual.split(/\./):this.getQTVersion().split(/\./);if(this.isIE())
{return areCompatible(expectedVersion[0],actualVersion);}
else
{return areCompatible(expectedVersion,actualVersion);}},isValidQTAvailable:function(required){return this.isQTInstalled()&&this.isQTCompatible(required)}};